 \documentclass[fancy,blue,11pt]{elegantbook}

\title{Practical Fermionic Gaussian States}
\subtitle{Fermionic Gaussian States: practical numerical simulations}

\author{Jacopo Surace}
\institute{Strathclyde, ICFO}
\date{\today}
\version{1.00}

\extrainfo{Julia's code on Github}

\logo{logo.png}
\cover{cover.jpg}



%%%%Inizio Miei
%\usepackage{amsthm}

\newcommand{\expv}[1]{\left\langle #1 \right\rangle}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\id}{\mathbb{I}}
\newcommand{\im}{{i\mkern1mu}}
\newcommand{\da}{^{\dag}}
\newcommand{\sx}{\sigma^x}
\newcommand{\sy}{\sigma^y}
\newcommand{\sz}{\sigma^z}
\newcommand{\ket}[1] {| #1 \rangle}
 \newcommand{\bra}[1] {\langle #1 |}
  \newcommand{\Tr}[1] {\mbox{Tr}\left[ #1 \right]}
  \DeclareMathOperator{\sech}{sech}


\newcount\colveccount
\newcommand*\colvec[1]{
        \global\colveccount#1
        \begin{pmatrix}
        \colvecnext
}
\def\colvecnext#1{
        #1
        \global\advance\colveccount-1
        \ifnum\colveccount>0
                \\
                \expandafter\colvecnext
        \else
                \end{pmatrix}
        \fi
}
\def\code#1{\texttt{#1}}
\usepackage{colortbl}
\definecolor{blue}{cmyk}{0.897, 0.393, 0, 0.0118}
\definecolor{green}{cmyk}{0.835, 0, 0.395, 0.0275}
\definecolor{red}{rgb}{0.992,0.498,0.486}



\usepackage{CJKutf8}

\usepackage{algorithm}
\usepackage{algpseudocode}



\usepackage{systeme}
%\usepackage{demonstration}
\usepackage{mathtools}
%\let\openbox\relax



%\theoremstyle{definition}
%\newtheorem{defn}[thm]{Definition} % definition numbers are dependent on theorem numbers
%\newtheorem{exmp}[thm]{Example}
%\newtheorem{observation}[thm]{Observation}

%%%%Fine Miei






\begin{document}

\maketitle
\tableofcontents
\clearpage
\thispagestyle{empty}
\mainmatter
\hypersetup{pageanchor=true}

\chapter{The canonical anticommutation relations}
\section{The Hilbert space characterised by the canonical anticommutation relations}
Consider a set of operators $\{a_i\}_{i=1}^{N}$ acting on a Hilbert space $\mathcal{H}$. We say that these operators satisfy the \textit{canonical anticommutation relation} (CAR) when they satisfy
\begin{equation}
\label{eq:CAR}
\{a_i,a\da_j\}=\id \delta_{i,j} ;  \qquad \{a_i,a_j\}=0,
\end{equation}
with $\{a,b\}\coloneqq ab+ba$ the notation for the anticommutator. \\
As shown in \cite{nielsen} a number of properties of the set of operators $\{a_i\}_{i=1}^{N}$  and of the Hilbert space $\mathcal{H}$ can be inferred just by the fact that such operators exist and obey the CAR.\\
The  $a\da_i a_i$ are a set of \textit{commuting, hermitian,  positive operators} with eigenvalues $\{0,1\}$.
We denote with $\vec{x}\in\{0,1\}^N$ a binary string of length $N$ with the $i$-th elements $x_i$. With $|\vec{x}\rangle$ we identify one of the $2^N$ states that is the simultaneous eigenstate of $a\da_i a_i$ for all $i=1,\dots,N$ with eigenvalues respectively $x_i$. The operator $a_i$ acts as a \textit{lowering operator} for $a\da_i a_i$ and $a\da_i$ acts as a \textit{raising operator} for $a\da_i a_i$ in the sense that
\begin{enumerate}
\item If $a\da_i a_i |\vec{x}\rangle = |\vec{x}\rangle$, that is, it has the $i$-th eigenvalue equal to $1$. Then the action of $a_i$ on $|\vec{x}\rangle$ lower the corresponding eigenvalue, meaning that $a\da_i a_i (a_i |\vec{x}\rangle) = 0 (a_i |\vec{x}\rangle)$.
\item If $a\da_i a_i |\vec{x}\rangle = 0 |\vec{x}\rangle$, that is, it has the $i$-th eigenvalue equal to $0$. Then the action of $a\da_i$ on $|\vec{x}\rangle$ raise the corresponding eigenvalue, meaning that $a\da_i a_i (a\da_i |\vec{x}\rangle) = 1 (a\da_i |\vec{x}\rangle)$.
\end{enumerate}
We define an \textit{ordering} by explicitly defining $|\vec{x}\rangle \coloneqq (a\da_1)^{x_1}(a\da_2)^{x_2}\dots(a\da_N)^{x_N}|\vec{0}\rangle$, where $\vec{0}$ is the string of $N$ zeros. The set $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ form an orthonormal basis. If the dimension of the Hilbert space $\mathcal{H}$ is $2^N$, then $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ is an orthonormal basis of $\mathcal{H}$.\\
The action of the raising and lowering operators on $|\vec{x}\rangle$ is then
\begin{align}
a_i |\vec{x}\rangle & =
\begin{cases}
	-(-1)^{S^i_{\vec{x}}}|\vec{x'}\rangle  \mbox{ with } x'_i=0 \mbox{ and } x'_{j\neq i} = x_{j \neq i},  & \text{if } x_i=1 \\
	0 & \text{if } x_i=0
\end{cases},
\\
a\da_i |\vec{x}\rangle  & =
\begin{cases}
	0 & \text{if } x_i=1 \\
	-(-1)^{S^i_{\vec{x}}}|\vec{x'}\rangle \mbox{ with } x'_i=1 \mbox{ and } x'_{j\neq i} = x_{j \neq i},  & \text{if } x_i=0
\end{cases},
\end{align}
with $S^i_{\vec{x}}=\sum_{k=1}^{i-1}x_k$.
\\
In appendix \ref{appendix:fermionic_operators}  we report some useful equalities valid for operators satisfying the CAR.
\section{Dirac and Majorana representations}
The raising and lowering operators $a\da_i$,$a_i$ are called \textit{Dirac operators} and \textcolor{red}{they represent the action of adding and removing the $i$-th fermionic mode.}\\
Both $a_i$ and its adjoint $a\da_i$ are not hermitian. The hermitian combinations of the raising and lowering operators
\begin{equation}
\label{eq:Majorana=Dirac}
\begin{array}{ccc}
x_{i}=\frac{a_{i}+a_{i}^{\dagger}}{\sqrt{2}}, & \mbox{  } & p_{i}=\frac{a_{i}-a_{i}^{\dagger}}{i\sqrt{2}},\end{array}
\end{equation}
are called \textit{Majorana operators}.
\\
The inverse transformations are:
\begin{equation}
\label{eq:Dirac=Majorana}
\begin{array}{ccc}
a_{i}=\frac{x_{i}+ip_{i}}{\sqrt{2}}, & \mbox{  } & a_{i}^{\dagger}=\frac{x_{i}-ip_{i}}{\sqrt{2}}.\end{array}
\end{equation}
\\
In terms of Majorana operators the CARs read as
\begin{equation}
\label{eq:MCAR}
\begin{array}{ccc}
\{ x_{i},x_{j}\} =\{ p_{i},p_{j}\} =\delta_{i,j}, & \mbox{  } & \{ x_{i},p_{j}\} =0.\end{array}
\end{equation}
\\

\begin{remark} Majorana operators labelled by $i$ correspond Dirac operators labelled by $i$. Moving between Majorana and Dirac operators does not mix modes.
\end{remark}


\subsection{Vector notation}
We can collect the Dirac operators of \textcolor{red}{a system with $N$ modes} in the vector $\vec{\alpha}$ of length $2N$ defined as
\begin{equation}
\label{eq:Vector-Alpha}
\begin{array}{ccc}
\vec{\alpha}=\left(\begin{array}{c}
a_{0}^{\dagger}\\
\vdots\\
a_{N-1}^{\dagger}\\
a_{0}\\
\vdots\\
a_{N-1}
\end{array}\right) & \mbox{ , } & \vec{\alpha}^{\dagger}=\left(\begin{array}{cccccc}
a_{0} & \dots & a_{N-1} & a_{0}^{\dagger} & \dots & a_{N-1}^{\dagger}\end{array}\right).\end{array}
\end{equation}
Analogously we can collect the Majorana operators in the vector $\vec{r}$ defined as
\begin{equation}
\label{eq:Majorana-r}
\vec{r}=\left(\begin{array}{c}
x_{0}\\
\vdots\\
x_{N-1}\\
p_{0}\\
\vdots\\
p_{N-1}
\end{array}\right),
\end{equation}
in terms of $\vec{r}$ the CAR are conveniently written as
\begin{equation}
\label{eq:MCAR}
\left\{ r_{i},r_{j}\right\} =\delta_{i,j}.
\end{equation}
We define the unitary matrix $\Omega$ as
\begin{equation}
\label{eq:Omega}
\begin{array}{ccc}
\Omega=\frac{1}{\sqrt{2}}\left(\begin{array}{cc}
\mathbb{I} & \mathbb{I}\\
i\mathbb{I} & -i\mathbb{I}
\end{array}\right) & \mbox{ , } & \Omega^{\dagger}=\Omega^{-1}=\frac{1}{\sqrt{2}}\left(\begin{array}{cc}
\mathbb{I} & -i\mathbb{I}\\
\mathbb{I} & i\mathbb{I}
\end{array}\right)\end{array}.
\end{equation}
Such a matrix, applied to the vector of the Dirac operators $\vec{\alpha}$, returns the vector of Majorana operators $\vec{r}=\Omega\vec{\alpha}$.

%\begin{remark}
%In the Dirac operators representation one associate to each mode $i$ the $2$ operators $a\da_i$ and $a_i$. Moving to the Majorana representation one can maintain the information about the Dirac mode with the notation in $x_i$ and $p_i$. Switching to the vector notation $\vec{r}$ one lose this information, dealing with $2N$ \textcolor{red}{modes}
%\end{remark}

\begin{remark}
The $\{r_i\}_{i=1,\dots,2N}$ are hermitian, traceless and form a Clifford algebra $\mathcal{C}_{2N}$ characterised by the MCAR \eqref{eq:MCAR}.
\end{remark}

\subsection{Fermionic transformation}
A transformation $O$ is said to respect the CAR in the Majorana representation if maps a vector of Majorana operators $\vec{r}$ to a new one $\vec{s}=O\vec{r}$. That is for all $i,j=1,2,\dots,N$ it must hold
\begin{equation}
\delta_{i,j} = \{s_i,s_j\} =\sum_{k,l}O_{i,k}O_{j,l}\{r_k,r_l\}=(OO^{T})_{i,j},
\end{equation}
that corresponds to the request for $O$ to be an orthogonal matrix.\\
A transformation $U$ of a vector of Dirac operators $\vec{\alpha}$ to a new one $\vec{\beta}=U\vec{\alpha}$ that respects the CAR, we call it a \textit{fermionic transformation}, has the form of $U=\Omega\da O \Omega$ with $O$ an orthogonal matrix.







\chapter{Fermionic Quadratic Hamiltonians}
\label{ch:1}
\section{Dirac Representation}
The general \textit{fermionic quadratic hamiltonians} on a finite lattice of $N$ sites in the Dirac operators representation  can be written as

\begin{equation}
	\label{eq:Dirac-QFH}
	\hat{H}=\frac{1}{2}\sum_{i,j=1}^{N-1}\left(A_{i,j}a_{i}^{\dagger}a_{j}-\bar{A}_{i,j}a_{i}a_{j}^{\dagger}+B_{i,j}a_{i}a_{j}-\bar{B}_{i,j}a_{i}^{\dagger}a_{j}^{\dagger}\right),
\end{equation}
%
where $A$ is an \textit{hermitian}, $A^{\dagger}=A$,  and $B$ is a \textit{skew-symmetric}, $B^{T}=-B$, complex matrix. \\
Defining the matrix
\begin{equation}
H=\left(\begin{array}{cc}
-\bar{A} & B\\
-\bar{B} & A
\end{array}\right),
\end{equation}
\\
the compact form of equation \eqref{eq:Dirac-QFH} reads
\begin{equation}
\label{eq:Dirac-QFH-h}
\hat{H}=\frac{1}{2}\vec{\alpha}^{\dagger}H\vec{\alpha}.
\end{equation}
%

%%%%Majorana Representation
\section{Majorana Representation}
The Majorana representation of the generic fermionic quadratic hamiltonian reads as
\begin{equation}
\label{eq:Majorana-QFH}
\hat{H}=\frac{i}{2}\vec{r}^{\dagger}h\vec{r},%= \frac{1}{2}\left(\vec{\alpha}^{\dagger}\Omega^{\dagger}\right)\Omega H_{a}\Omega^{\dagger}\left(\Omega\vec{\alpha}\right)
\end{equation}
%
where
\begin{equation}
\label{eq:Majorana-QFH-ih}
i h=\Omega H\Omega^{\dagger}=i\left(\begin{array}{cc}
\Im\{A+B\} & \Re\{A+B\}\\
\Re\{B-A\} & \Im\{A-B\}
\end{array}\right).
\end{equation}
Where $\Im\{ \cdot \}$ and $\Re\{ \cdot \}$ are respectively the imaginary and the real part of their argument.\\
Using the properties of matrices $A$ and $B$, it is easy to see that matrix $\Omega H\Omega^{\dagger}$ is purely imaginary and hermitian, therefore matrix $h$ is real and skew-symmetric.\\
%


%%Diagonalisation
\section{Diagonalisation}
\subsection{Hamiltonian diagonal form with Dirac operators}
Given a particular fermionic quadratic hamiltonian $H$ in the general form \eqref{eq:Dirac-QFH} it is always possible to find a new set of Dirac operators $\{b_k\}_{k=1}^N$ such that $H$ in terms of $\{b_k\}_{k=1}^N$  reads as
\begin{equation}
\label{eq:Dirac-QFH-FreeFree}
\hat{H} = \frac{1}{2}\sum_{k=1}^{N} \epsilon_{k} (b\da_k b_k -b_k b\da_k),
\end{equation}
with $\epsilon_k \in \mathbb{R}$ for all  $k=1,2,\dots,N$ \cite{lieb1961}.
\\
We call hamiltonians in this form free-free fermion hamiltonians.
\\
In compact form
\begin{equation}
\hat{H} = \frac{1}{2} \vec{\beta}\da H_D \vec{\beta}
\end{equation}
with
\begin{equation}
H_{D}=U\da H U =
\left(\begin{array}{cccccc}
-\epsilon_{1} & 0 & \dots &  & \dots & 0\\
0 & \ddots & \ddots &  &  & \vdots\\
\vdots & \ddots & -\epsilon_{N}\\
 &  &  & \epsilon_{1} & \ddots & \vdots\\
\vdots &  &  & \ddots & \ddots & 0\\
0 & \dots &  &  & \dots0 & \epsilon_{N}
\end{array}\right),
\end{equation}
where $U$ is a fermionic tranformation.\\
We will always order the eigenvalues in descending order ($\epsilon_1 \geq \epsilon_2 \geq \dots \geq \epsilon_N$).
\subsection{Hamiltonian diagonal form with Majorana operators}
In terms of Majorana operators the diagonal form of a generic fermionic quadratic hamiltonian reads as
\begin{equation}
\label{eq:Majorana-QFH-FreeFree}
\hat{H}=\frac{i}{2}\sum_{i=1}^{N}\lambda_i(\tilde{x}_{i}\tilde{p}_{i}-\tilde{p}_{i}\tilde{x}_{i}).
\end{equation}
for a set of Majorana operators $\{\tilde{x}_i\}_i$, $\{\tilde{p}_i\}_i$.
In compact form
\begin{equation}
\hat{H} = \frac{i}{2} \vec{s}\da h_d \vec{s}
\end{equation}
with
\begin{equation}
\label{eq:diagonal-Majorana-h}
 h_d =O^{T} h O =  \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix}
\end{equation}
a block diagonal matrix and $O$ an orthogonal transformation .\\
%
\section{Numerical diagonalisation}
We want to find the orthogonal transformation $O$ that diagonalise a fermionic quadratic hamiltonian in Majorana representation as in \eqref{eq:diagonal-Majorana-h}.
For a more physical approach we refer to \cite{lieb1961}, here we focus on the numerical approach.
\\
The following theorem is a standard result in matrix theory \cite{zumino1962,horn1985}
%%Theorem 1
\begin{theorem}{Block diagonal form of real, skew-symmetric matrices}{Block-Matrix}
Let $h$ be $2N\times2N$ a real, skew-symmetric matrix. There exist an orthogonal matrix $O$ such that
\begin{equation}
\label{eq:Schur-Decomposition}
h=O\Sigma h_D O^{T},
\end{equation}
with $h_D$ a block diagonal matrix of the form
\begin{equation}
h_D = \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix}
\end{equation}
for real, positive definite $\left\{\lambda_i\right\}_{i=1,\dots,N}$.
The non-zero eigenvalues of matrix $h$ are the imaginary numbers $\{\pm \im \lambda_i\}_{i=1,\dots,N}$.
\end{theorem}

Matrix $h$ in \eqref{eq:Majorana-QFH} is real, skew-symmetric, thus, using theorem \ref{eq:Schur-Decomposition} we find the orthogonal transformation $O$ that diagonalise the matrix
\begin{align}
\hat{H} &= \frac{i}{2}\vec{r}^{\dagger}h\vec{r} = \frac{i}{2}\bigg( \vec{r}^{\dagger}O\da \bigg) \left( O \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix} O\da \right)\bigg( O \vec{r} \bigg) =\\
& =  \frac{i}{2}\vec{s}^{\dagger} \left( O \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix} O\da \right) \vec{s} = \frac{i}{2}\sum_{i=0}^{N-1}\lambda_{i}(\tilde{x}_{i}\tilde{p}_{i}-\tilde{p}_{i}\tilde{x}_{i})
\end{align}
%
We defined the new collection of Majorana operators $\vec{s}=O\vec{r}$
\begin{equation}
\label{eq:Majorana-s}
\vec{s}=\left(\begin{array}{c}
\tilde{x}_{0}\\
\tilde{p}_{0}\\
\tilde{x}_{1}\\
\tilde{p}_{1}\\
\vdots\\
\tilde{x}_{N-1}\\
\tilde{p}_{N-1}
\end{array}\right).
\end{equation}
%


%



%%%%Block-diagonal form of real skew-symmetric matrices
\subsection{Block-diagonal form of real skew-symmetric matrices}
\label{Diag_Real_Skew}

The matrix decomposition \eqref{eq:Schur-Decomposition}  of theorem \ref{thm:Block-Matrix} is numerically obtained in $3$ steps

\begin{enumerate}

\item Compute numerically a Schur decomposition (Schur triangularisation as in  \cite{horn1985}) of the skew-symmetric matrix $h$ such that: $h=\tilde{O}\tilde{h}_D\tilde{O}^{T}$. The matrix $\tilde{h}_D$ should be a block-diagonal matrix with each block in the anti-diagonal form
\begin{equation}
\left(\begin{array}{cc}
0 & \tilde{\lambda_{i}}\\
-\tilde{\lambda_{i}} & 0
\end{array}\right),
\end{equation}
it is not guaranteed that $\tilde{\lambda_{i}}$ is positive for each $i$. It is necessary to reorder it.

\item Build the ortogonal matrix $S=\bigoplus_{i=1}^{\lfloor N/2\rfloor}{s}_{i}$ with
\begin{equation}
s_{i}=\left(\begin{array}{cc}
0 & 1\\
1 & 0
\end{array}\right)
\end{equation}
if $\tilde{\lambda_{i}}<0$ or
\begin{equation}
s_{i}=\left(\begin{array}{cc}
1 & 0\\
0 & 1
\end{array}\right),
\end{equation}
if $\tilde{\lambda_{i}}>0$.

\item The final orthogonal transformation is $O=\tilde{O}S$ such that $h=Oh_D O^{T}$.

\end{enumerate}

\begin{proposition}{\code{Diag\_Real\_Skew(h) $\rightarrow h_D,O$}}{}
This function implements the algorithm for the block diagonalisation of $h$ a generic skew-symmetric real matrix. $h_D$ is the block-diagonal matrix of \eqref{eq:Schur-Decomposition} and has the following property: it is in the block diagonal form, each $2\times2$ block is skew-symmetric with the upper-right element positive and real and $h_D$ is in ascending order for the upper diagonal. $O$ is an orthogonal matrix such that: $h=O h_D O^{T}$.
\end{proposition}



%%%%Dirac representation
\subsection{Diagonalisation with Dirac operators}
\label{Dirac-Diagonalisation}
Considering the Dirac representation one is interested in a transformation from Dirac modes $\vec{\alpha}$ in Dirac modes $\vec{\beta}$ such that the generic quadratic Hamiltonian \eqref{eq:Dirac-QFH} is mapped to the free-free fermions Hamiltonian $ \hat{H}=\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right) $.\\
To do so it is sufficient to map the Majoranas $\vec{s}$ back to Fermions to obtain \eqref{eq:Dirac-QFH-FreeFree}.
The values $\tilde{h}_i$ of  \eqref{eq:Majorana-QFH-FreeFree} and $\epsilon_k$ of  \eqref{eq:Dirac-QFH-FreeFree} are related by
\begin{equation}
\epsilon_{k}=\lambda_{k}.
\end{equation}

In order to obtain the diagonal form of $H$ one can use the following algorithm:

\begin{enumerate}
\item Obtain matrix $h$ from $H$ as $h=-\im \Omega H \Omega\da$.

\item Apply the Majorana diagonalisation of section \ref{Diag_Real_Skew} to $h$ to obtain its block diagonal form and the orthogonal transformation $O$ such that $\vec{s}=O\vec{r}$.

\item  In order to move back to the Dirac representation one has to pay attention to how the Majorana operators are ordered in $\vec{s}$. In fact, in $\vec{s}$ the order is $xp$ (see \eqref{eq:Majorana-s}), so we cannot transform back to the Dirac representation simply applying $\Omega$ again. To reorder $\vec{s}$ to order $xx$ (see \eqref{eq:Majorana-r}) we define the $2N\times2N$ matrix
\begin{equation}
\label{eq:FxxTxp}
F_{xp\rightarrow xx}=\begin{array}{c}
i=0\\
i=1\\
\vdots\\
\vdots\\
i=N\\
i=N+1\\
\vdots\\
i=2N+1
\end{array}\left(\begin{array}{cccccccc}
1 & 0 & 0 & 0 & \dots & \dots & 0 & 0\\
0 & \vdots & 1 & \vdots &  &  & \vdots & \vdots\\
\vdots & \vdots & \vdots & \vdots &  &  & 0 & \vdots\\
\vdots & 0 & 0 & 0 &  &  & 1 & \vdots\\
\vdots & 1 & 0 & 0 &  &  & 0 & \vdots\\
\vdots & 0 & \vdots & 1 &  &  & \vdots & \vdots\\
\vdots & \vdots & \vdots & 0 &  &  & \vdots & 0\\
0 & 0 & 0 & \vdots & \dots & \dots & 0 & 1
\end{array}\right)
\end{equation}
so that $F_{xp\rightarrow xx}\vec{s}$ has the order $xx$ as $\vec{r}$ and we get
\begin{equation}
\tilde{h}_D=F_{xp\rightarrow xx}h_D F_{xp\rightarrow xx}^{T}=\left(\begin{array}{cccccc}
0 & \dots & 0 & \lambda_{0} & 0 & 0\\
\vdots & \ddots & \vdots & 0 & \ddots & 0\\
0 & \dots & 0 & 0 & 0 & \lambda_{\lfloor N/2\rfloor}\\
-\lambda_{0} & 0 & 0 & 0 & \dots & 0\\
0 & \ddots & 0 & \vdots & \ddots & \vdots\\
0 & 0 & -\lambda_{\lfloor N/2\rfloor} & 0 & \dots & 0
\end{array}\right)
\end{equation}

\item. Move from Majoranas to Dirac representation
\begin{equation}
H_D=\im \Omega^{\dagger}\tilde{h}_D\Omega=\left(\begin{array}{cccccc}
\lambda_{0}\\
 & \ddots\\
 &  & \lambda_{\lfloor N/2\rfloor}\\
 &  &  & -\lambda_{0}\\
 &  &  &  & \ddots\\
 &  &  &  &  & -\lambda_{\lfloor N/2\rfloor}
\end{array}\right)
\end{equation}

\item. The final unitary transformation $\vec{\alpha}=U\vec{\beta}$ read as
\begin{equation}
U=\Omega^{\dagger}\cdot O\cdot F_{xp\rightarrow xx}^{\dagger}\cdot\Omega
\end{equation}

\item. Finally we have $H=U H_{D} U^{\dagger}$.
%that is
%
%\begin{equation}
%\hat{H}=\frac{1}{2}\vec{\beta}^{\dagger}H_{D}\vec{\beta}=\frac{1}{2}\vec{\beta}^{\dagger}\left(\begin{array}{cccccc}
%\epsilon_{1} & 0 & \dots &  & \dots & 0\\
%0 & \ddots & \ddots &  &  & \vdots\\
%\vdots & \ddots & \epsilon_{N}\\
% &  &  & -\epsilon_{1} & \ddots & \vdots\\
%\vdots &  &  & \ddots & \ddots & 0\\
%0 & \dots &  &  & \dots0 & -\epsilon_{N}
%\end{array}\right)\vec{\beta}\
%\end{equation}

\end{enumerate}

\begin{proposition}{\code{Diag\_ferm($H$)$\rightarrow  H_{D},U$}}{}
This function diagonalise $H$ with the fermionic algorithm of  section \ref{Dirac-Diagonalisation}. $H_D$ is the diagonal form with the first half diagonal negative and the second one positive. $U$ is the fermionic transformation such that: $M=U_{f}M_{f}U_{f}^{\dagger}$. \\
\end{proposition}
%
%%%%%Fermionic gaussian states
%\chapter{Fermionic gaussian states}
%Fermionic gaussian states are represented by density operators that are exponentials of a quadratic form in the creation and annihilation fermionic operators \cite{kraus2009}.\\
%%
%A general Fermionic gaussian state can be written as
%\begin{equation}
%\label{eq:Fermionic-Gaussian-State}
%\rho = \frac{e^{-\beta H}}{Z},
%\end{equation}
%where $H$ is a fermionic quadratic hamiltonian as \eqref{eq:Dirac-QFH}, $Z=\Tr{e^{-\beta H}}$ and $\beta \in [0,+\infty]$ where both extremum values are reached with a single sided limit procedure in the definition of $\rho$.\\
%%
%All the information about the state is encoded in the inverse temperature $\beta$ and in the choice of the fermionic quadratic hamiltonian to be exponentiated.\\
%	\section{Representations of fermionic density matrix}
%	Let us start with a trivial remark on the definition of fermionic gaussian state just given.\\
%	%
%	\begin{remark}Gaussian states are ground state and thermal Gibbs state of a fermionic quadratic hamiltonian.
%	\end{remark}
%	%
%From section \ref{ch:1} we know that the fermionic quadratic hamiltonians can be diagonalised as \eqref{eq:Dirac-QFH-FreeFree}, thus a gaussian states have a normal-mode decomposition in terms of $N$ single-mode thermal states of the form $\sim e^{-\beta_{i}b_{i}^{\dagger}b_{i}}$.\\
%%
%One can thus refine the previous remark as\\
%%
%	\begin{remark}Gaussian states are ground state and thermal Gibbs state of free-free fermionic quadratic hamiltonian.
%	\end{remark}
%From this observation, one can show that the state is fully determined by the expectation values of quadratic operators \cite{kraus2009,peschel2003}. We will see how to further develop this intuition in the correlation matrix representation in the following sections.\\
%%
%\subsection{Standard form of fermionic gaussian states}
%Switching to the Majorana operator representation of the exponentiated Hamiltonian in \eqref{eq:Fermionic-Gaussian-State}, diagonalising it as explained in the previous chapter, expanding the exponential in series and applying the MCAR one obtain the so called \textit{standard form}  of $\rho$
%\begin{equation}
%\label{eq:stnd-form-rho}
%\rho = \prod_{k=1}^{N}\chi_k,
%\end{equation}
%where $\chi_k = \frac{\mathbb{I}}{2}+i \lambda_k s_{2k-1} s_{2k}$, and coefficients $\lambda_k\in[-1,1]$ , and $s_i$ are the Majorana operators that diagonalise exponentiated matrix of the state \cite{demelo2013}.
%
%
%%%%%Correlation Matrix
%\section{Correlation Matrix}
%\subsection{Dirac representation}
%Because of Wick's theorem (we will see it in subsection \ref{subsec:Wick}), a fermionic gaussian state is completely characterised by the $2N\times2N$ correlation matrix
%\begin{equation}
%\Gamma_{i,j}\equiv Tr\left[\rho\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}\right]=\left(\begin{array}{cc}
%\Gamma^{UL} & \Gamma^{UR}\\
%\Gamma^{BL} & \Gamma^{BR}
%\end{array}\right).
%\end{equation}
%Where $\Gamma$ is Hermitian, matrices $\Gamma^{BL}$ and $\Gamma^{UR}$ are skew-symmetric, $\Gamma^{BL}=-\overline{\Gamma^{UR}}$ and $\Gamma^{UL}$ and $\Gamma^{BR}$ are Hermitian. \\
%The four quadrants of $\Gamma$ corresponds to the two points correlators of the couples of fermionic creation and annihilation operators:
%\begin{equation}
%\left(\begin{array}{cc}
%\Gamma^{UL} & \Gamma^{UR}\\
%\Gamma^{BL} & \Gamma^{BR}
%\end{array}\right) \leftrightarrow \left(\begin{array}{cc}
%a^{\dagger}a & a^{\dagger}a^{\dagger}\\
%aa & aa^{\dagger}
%\end{array}\right).
%\end{equation}
%
%	\begin{remark}Gaussian states are the states	that maximise	the von Neumann entropy	given the expectation values collected in the correlation matrix \cite{gluza2016}. This can be easily seen remembering the definition of the Gibbs ensemble as the state that maximise the entropy for a given energy.
%	\end{remark}
%%
%
%\subsection{Majorana representation}
%Using the Majorana operators representation we define the Majorana correlation matrix as
%\begin{equation}
%\Gamma_{i,j}^{Maj}=Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=\left(\Omega\Gamma\Omega^{\dagger}\right)_{i,j},
%\end{equation}
%this matrix is imaginary, skew-symmetrix if we subtract the diagonal always equal to $\frac{1}{2}\mathbb{I}$. \\
%The four quadrants of $\Gamma^{Maj}$ corresponds to the two points correlators of the couple of Majorana operators:
%\begin{equation}
% \left(\begin{array}{cc}
%xx & xp\\
%px & pp
%\end{array}\right).
%\end{equation}
%\subsubsection{Covariance matrix}
%The covariance matrix of a fermionic gaussian state is defined in terms of Majorana operators as
%\begin{equation}
%\gamma = \im Tr\left[\rho\left[\vec{r}_{i},\vec{r}_{j}\right]\right],
%\end{equation}
%with $\left[\vec{r}_{i},\vec{r}_{j}\right]$ the commutator of the two Majorana operators.\\
%The covariance matrix completely describe the fermionic gaussian state and has the advantage of being a skew-symmetric matrix, thus a matrix of the same form of the hamiltonian matrix $h$ in \ref{eq:Majorana-QFH}.\\
%The covariance matrix is derived from the Dirac and Majorana correlation matrix as follows:
%\begin{equation}
%\gamma	=-\im \Omega\left(2\Gamma -\mathbb{I}\right)\Omega^\dag=-\im\left(2\Gamma^{maj}-\mathbb{I}\right).
%\end{equation}
%
%
%%If we consider the Dirac representation of the correlation matrix $\tilde{\Gamma}=\Gamma-\frac{1}{2}\mathbb{I}$, moving to the Majorana representation we obtain the skew-symmetric matrix (analogous of $ih$)
%%\begin{equation}
%%i\gamma\equiv\Omega\tilde{\Gamma}\Omega^{\dagger}=\Gamma^{maj}-\frac{1}{2}\mathbb{I}=\frac{1}{2}Tr\left[\rho\left[\vec{r}_{i},\vec{r}_{j}\right]\right]
%%\end{equation}
%%
%%
%%where in the last equality we just used the fact that $ Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=Tr\left[\rho\vec{r}_{j}\vec{r}_{i}\right]$ if $i\neq j$, and $Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=\frac{1}{2}$ if $i=j$ thus taking the anticommutator and dividing by $2$ just removes the constant diagonal.
%%
%%At any time we can change representation with this transformations
%%
%%
%%Someone refers to $\gamma$ as skew-symmetrised correlation matrix, someone else as covariance matrix. I will call it $\gamma$ or skew-symmetrised correlation matrix.
%
%
%
%
%%%%%Diagonalisation of the correlation matrix
%\subsection{Diagonal form of the correlation matrix}
%
%It is possible to find the fermionic transformation $V$ that brings the correlation matrix $\Gamma$ in the diagonal form $\Gamma^{D} = V\da \Gamma V$ where
%\begin{equation}
%\Gamma^D =
%\left(\begin{array}{cccccc}
%\nu_{1} & 0 & \dots &  & \dots & 0\\
%0 & \ddots & \ddots &  &  & \vdots\\
%\vdots & \ddots & \nu_{N}\\
% &  &  & 1-\nu_{1} & \ddots & \vdots\\
%\vdots &  &  & \ddots & \ddots & 0\\
%0 & \dots &  &  & \dots0 & 1-\nu_{N}
%\end{array}\right),
%\end{equation}
%with $\nu_{i}\text{\ensuremath{\in\left[0,1\right]}}$ the occupation of the $i$-esim mode of the diagonal form of the Hamiltonian at the exponent in the density matrix representation of the Gaussian state.\\
%
%\subsubsection{Method for diagonalisation}
%The matrix $\tilde{\Gamma}=2\Gamma-\mathbb{I}$ has the same form of $H$ in \eqref{eq:Dirac-QFH-h}. In order to diagonalise $\Gamma$, we firstly diagonalise $\tilde{\Gamma}$ and then add again $\mathbb{I}$ and divide by $2$ to obtain the diagonal form of $\Gamma^{D}$ with $\nu_{i}\text{\ensuremath{\in\left[0,1\right]}}$.
%
%\begin{proposition}{\code{Diag\_Gamma($\Gamma$)$\rightarrow \Gamma^D, U$}}{}
%This function returns $\Gamma^D$, the the diagonal form \eqref{eq:Gamma-Dirac-Diagonal} of the Dirac correlation matrix $\Gamma$ and $U$ the fermionic transformation such that $\Gamma=U \Gamma^D U\dag $.
%\end{proposition}
%
%By means of theorem \eqref{eq:Schur-Decomposition} we obtain the block diagonal form of the covariance matrix $\gamma$. We call the anti-diagonal elements of each block $\pm \eta_i$ for $i=1,\dots,N$
%\begin{equation}
%\label{eq:Gamma-Majorana-Diagonal}
%\gamma^{D}=\left(\begin{array}{ccccccc}
%0 		& \eta_1 	& 0 		& 0 		& 		& \dots 	& 0 \\
%-\eta_1 	&0   		& 0 		& 0 		&		&  		& \vdots\\
%0 		& 0 		& 0 		& \eta_2 	& 		&		& \\
% 0		& 0 		& -\eta_2 & 0 		&  		& 		&  \\
% 0 		& 0 		& 0 		& 0  		& \ddots 	& 		&   \\
%\vdots 	&  		&  		&  		&		&  0		& \eta_N	 \\
%0 		& \dots 	&  		& 		&  		&-\eta_N 	& 0\\
%\end{array}\right).
%\end{equation}\\
%%
%The different eigenvalues lie in the following intervals
%%
%\begin{itemize}
%\item $\Gamma\rightarrow\Gamma^{D}$ with eigenvalues $\nu_{i}\in\left[0,1\right]$.
%
%\item  $\tilde{\Gamma}\rightarrow\tilde{\Gamma}^{D}$ with eigenvalues $\tilde{\nu}_{i}\in\left[-1,1\right]$, with $\tilde{\nu_i}=2\nu_i-1$.
%
%\item $\gamma\rightarrow\gamma^{D}$ with eigenvalues $\eta_{i}\in\left[-1,1\right]$.
%\end{itemize}
%
%
%
%%%%%Wick's Theorem
%		\subsection{Wick's Theorem}
%		\label{subsec:Wick}
%		A general operator is a linear combination of operators $c(\vec{x})$ defined as
%		\begin{equation}
%			c(\vec{x})=r_{1}^{x_{1}}r_{2}^{x_{2}}\dots r_{2N}^{x_{2N}},
%		\end{equation}
%where $r_{i}$ are the Majorana operators, and $\vec{x}\in\left\{ 0,1\right\} ^{2N}$ \cite{bravyi2004,greplova2013}.
%
%Then for every Gaussian state $\rho$ and even binary string $\vec{x}\in\left\{ 0,1\right\} ^{2N}$ with weight $|x|=2l$ one has
%\begin{equation}
%Tr\left[\rho c(\vec{x})\right]=-i^{l}\mbox{Pf}\left(\left. \gamma\right|_{\vec{x}}\right),
%\end{equation}
%where $\mbox{Pf}()$ is the Pfaffian and $\left. \gamma\right|_{\vec{x}}$ is the restriction of the correlation matrix to all the the elements $\gamma_{i,j}$ such that $x_{i}=x_{j}=1$ (both equal one simultaneously) %(In \cite{greplova2013} the sign is different because different is the sign of $\gamma$).
%
%If the binary string has an odd weight then $Tr\left[\rho c(\vec{x}_{odd})\right]=0$.
%
%%%%%Reduced density matrix
%\subsubsection{Reduced density matrix}
%Trying to define a partial trace over fermionic modes subspaces one soon faces the what is often called the "partial trace ambiguity" \cite{friis2013}.\\
%%
%In the case of fermionic gaussian states, though, this is a much simpler task. Any reduced state formalism has to satisfy the simple criterion that the reduced density operator contains all the information about the subsystem that can be obtained from the global state when measurements are performed only on the respective subsystem alone \cite{friis2013}.\\
%%
%With Wick's theorem in mind it is easy to see that the correlation matrix of the reduced state on the modes ${i_1,\dots,i_m}$ is just the correlation matrix  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$.\\
%To obtain the reduced correlation matrix of the contiguous sites $\{i_1,\dots,i_m\}$ with \code{F-utilities.jl} from $\Gamma$ one should use the function \code{Reduce\_Gamma($\Gamma$,m,i\_1)}.
%
%\begin{proposition}{ \code{Reduce\_Gamma($\Gamma$,m,i\_1)}$\rightarrow  \left.\Gamma \right|_{\{i_1,\dots,i_m\}}$}{}
%This function takes a Dirac correlation matrix $\Gamma$, a dimensione of the partition $m$ and the initial site of the partition $i_1$ and return  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$, the reduced correlation matrix on the contiguous modes $\{i_1,\dots,i_m\}$.
%\end{proposition}
%
%
%%%%%Eigenvalues of rho and gamma
%\section{Eigenvalues of $\rho$ and eigenvalues of $\Gamma$}
%Consider the fermionic gaussian state $\rho=\frac{e^{-\frac{1}{2}\vec{\alpha}^{\dagger}M_{\rho}\vec{\alpha}}}{Z}$ and its correlation matrix $\Gamma$. We call $\{\nu_i\}_{i=1,\dots,N}$ the eigenvalues of $\Gamma$ and $\{\epsilon_i\}_{i=1,\dots,N}$ the eigenvalues of $H_{\alpha}$.
%Then we have
%\begin{equation}
%\nu_{i}=\frac{1}{1+e^{\epsilon_{i}}},
%\end{equation}
%
%\begin{equation}
%\epsilon_{i}=ln\left(\frac{1-\nu_{i}}{\nu_{i}}\right),
%\end{equation}
%
%\begin{equation}
%\epsilon_{i}=ln\left(\frac{\frac{1}{2}-\eta_{i}}{\frac{1}{2}+\eta_{i}}\right),
%\end{equation}
%
%\begin{equation}
%\eta_{i}=\frac{1}{2}\tanh\left(\frac{\epsilon_{i}}{2}\right).
%\end{equation}
%For details and a more detailed treatment of the topic see most relevant reference \cite{peschel2003} or see the appendix \ref{appendix:Eigenvalues-Relations}.\\
%%
%The correlation matrix $\Gamma^{D}$ tells us that a basis exists in which the density matrix $\rho$ of the state can be written as the tensor product of $N$ density matrices, one for each site. If $\nu_{i\in\left[1,N\right]}$ are the positive eigenvalues of $\Gamma$ then there exists a basis such that:
%\begin{equation}
%\label{eq:Rho_Gaussian_State}
%\rho=\bigotimes_{i=1}^{N}\left(\begin{array}{cc}
%\nu_{i} & 0\\
%0 & 1-\nu_{i}
%\end{array}\right)
%\end{equation}
%%
%Thus the if we denote each of the $2^{N}$ eigenvalues $\pi_{\vec{x}}$ of $\rho$ with a binary string $\vec{x}\in\left\{ 0,1\right\} ^{N}$ we have that: $\pi_{\vec{x}}=\prod_{i=1}^{N}\left(\vec{x}_{i}\nu_{i}+(1-\vec{x}_{i})(1-\nu_{i})\right)$.\\
%%
%\begin{proposition}{\code{Eigenvalues\_of\_rho($\Gamma$)}$\rightarrow\vec{\nu}$}{}
%This function return $N$ eigenvalues of the correlation matrix $\rho$ associated to the fermionic gaussian state with Dirac correlation matrix $\Gamma$. The first eigenvalue is always the biggest,  then he tries return the others $N-1$ smallest eigenvalues, but it is not guaranteed.
%\end{proposition}
%
%%%%%Information measures
%\section{Information measures}
%%%%%Von Neumann Entropies
%\subsection{Von Neumann Entropies}
%The Von Neumann entropy of a quantum state described by the density matrix $\rho$ is
%\begin{equation}
%\label{eq:General_VonNeumann_Entropy}
%S(\rho) = -\Tr{\rho\ln(\rho)}.
%\end{equation}
%In terms of the eigenvalues $\lambda$ of $\rho$, the Von Neumann entropy read as
%\begin{equation}
%S(\rho) = -\sum_{\lambda} \lambda \ln(\lambda)
%\end{equation}
%If $\rho$ is a Fermionic Gaussian state of a system with $N$ sites , substituting in \eqref{eq:General_VonNeumann_Entropy} the product form \eqref{eq:Rho_Gaussian_State}, the Von Neumann entropy becomes a function of the eigenvalues $\nu_i$ of the correlation matrix $\Gamma$ and it is the sum of just $2N$ terms
%\begin{equation}
%S(\Gamma) \equiv S(\rho) = -\sum_{i=1}^{N} \left(\nu_i \ln(\nu_i)+(1-\nu_i) \ln(1-\nu_i) \right).
%\end{equation}
%
%In \code{F-utilities.jl} this is implemented with the function \code{VN\_Entropy($\Gamma$)}.
%
%\begin{proposition}{\code{VN\_Entropy($\Gamma$)}$\rightarrow S$}{}
%This function return $S$, the \code{Float64} value of the Von Neumann Entropy of the state described by the Dirac correlation matrix $\Gamma$.
%\end{proposition}
%
%%%%%Purity
%\subsection{Purity}
%The purity of a state $\rho$ is defined as
%\begin{equation}
%\mbox{Purity}\equiv Tr\left[\rho^{2}\right].
%\end{equation}
%We have that:
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}\frac{1}{\sech(\epsilon_{i})+1},
%\end{equation}
%
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}(2\left(\nu_{i}-1\right)\nu_{i}+1),
%\end{equation}
%
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}\left(2\eta_{i}^{2}+\frac{1}{2}\right).
%\end{equation}
%
%For more details see appendix \ref{appendix:Purity}.
%
%In \code{F-utilities.jl} this is implemented with the function \code{Purity($\Gamma$)}.
%
%\begin{proposition}{\code{Purity($\Gamma$)$\rightarrow  p$}}{}
%This function return $p$ the purity of the fermionic gaussian state with Dirac correlation matrix $\Gamma$.
%\end{proposition}
%
%%%%%Entanglement Contour
%\subsection{Entanglement Contour}
%In 2014 Chen andVidal \cite{chen2014} introduced entanglement contour "a tool to identify which real-space degrees of freedom contribute, and how much, to the entanglement of a region A with the rest of the system B".\\
%We restrict to pure states.\\
%Consider an Hilbert space $\mathcal{H}$ arbitrarily divided in two partitions $\mathcal{H}= \mathcal{H}_A\otimes \mathcal{H}_B$. The Schmidt decomposition of a pure state $|\psi^{A,B}\rangle$ in $\mathcal{H}$ is
%\begin{equation}
%\label{eq:Schmidt-Decomposition}
%|\psi^{A,B}\rangle = \sum_{i} \sqrt{p_i}|\psi^{A}_i\rangle \otimes |\psi^B_i\rangle,
%\end{equation}
%with $p_i\geq0$, $\sum_{i} p_i = 1$ and
%\begin{equation}
%\rho^{A}\equiv Tr_{B}\left[ |\psi^{A,B}\rangle \langle \psi^{A,B}|\right] = \sum_{i} p_i |\psi^{A}_i \rangle \langle \psi^{A}_i|.
%\end{equation}
%Factorising Hilbert space $\mathcal{H}_A$ in its tensor product structure $\mathcal{H}_A=\bigotimes_{j\in A}\mathcal{H}_j$, we can individuate in each local Hilbert space $\mathcal{H}_j$ a site of partition $A$.
%Genarelly $\rho^A$ cannot be expressed as a product state over this factorisation of $\mathcal{H}_A$.\\
%Chen and Vidal entanglement contour $c_A$ is a function of the sites $j$ of partition $A$ ($c_A:A\rightarrow \mathbb{R}$) that attempts to express the contribution of each site to the total von Neumann entropy $S(\rho^A)$ of partition $A$.\\
%The definition of entanglement contour is based on five constraints (see \cite{chen2014} for the complete definition) that any possible entanglement contour function must satisfy. These constraints are not tight, thus there exist many possible functions that can be regarded as entanglement contour.\\
%We consider an entanglement contour specifically defined for Fermionic Gaussian states (for other entanglement contours see i.e. \cite{coser2017,tonni2018} ).\\
%
%
%
%
%
%\chapter{Hopping Hamiltonian}
%
%\chapter{Transverse Field Ising Hamiltonian}
%
%\chapter{Time evolutions}
%	\section{Real-time evolution}
%	\section{Imaginary-time evolution}
%In order to find the ground state of a non-degenerate Hamiltonian $H$ one can use the following equality
%\begin{equation}
%|GS\rangle = \lim_{\tau\rightarrow\infty} \frac{e^{-H\tau}|\psi\rangle}{||e^{-H\tau}|\psi\rangle||}
%\label{eq:Pure_state-ITE}
%\end{equation}
%starting from a generic state $|\psi\rangle$ with $\langle GS | \psi \rangle \neq 0$.\\
%To see this, let's consider the orthononormal basis $\{|E_i\rangle\}_{i}$ generated by the collection of the eigenvectors of $H$, with eigenvalues $\{E_i\}_i$ such that $E_0\lneqq E_1 \leq E_2 \leq \dots \leq E_{dim(\mathcal{H})}$, where $\mathcal{H}$ is the Hilbert space on which $H$ act.\\
%Expanding $|\psi\rangle$ on this basis one obtains $|\psi\rangle = \sum_i c_i |E_i\rangle$, with $c_0\neq 0$ from the fact that $\langle GS | \psi \rangle \neq 0$.
%One can thus see that eq \eqref{eq:Pure_state-ITE} is just a projection to the ground state:
%\begin{align}
% \lim_{\tau\rightarrow\infty} &  \frac{e^{-H\tau}|\psi\rangle}{||e^{-H\tau}|\psi\rangle||}  = \lim_{\tau\rightarrow\infty} \sum_i \frac{e^{-E_i \tau}c_i}{\sqrt{\sum_i e^{-2E_i \tau}|c_i|^2}}|E_i\rangle = \\
% & = \lim_{\tau\rightarrow\infty} \sum_i \frac{e^{-\frac{E_i}{E_0} \tau}c_i}{\sqrt{\sum_i e^{-2\frac{E_i}{E_0} \tau}|c_i|^2}}|E_i\rangle = |E_0\rangle,
%\end{align}
%and thus that $\lim_{\tau\rightarrow \infty}\frac{e^{-H\tau}}{||e^{-H\tau}||}$ is the projector on the ground state:
%\begin{align}
%\lim_{\tau\rightarrow \infty} & \frac{e^{-H\tau}}{||e^{-H\tau}||} = \lim_{t\rightarrow \infty}\frac{\sum_{i} e^{-E_i \tau}|E_i\rangle \langle E_i |}{\sqrt{\sum_i e^{-2E_i \tau}}} = \\
%&= \lim_{\tau\rightarrow \infty}\frac{\sum_{i} e^{-\frac{E_i}{E_0} \tau}|E_i\rangle \langle E_i |}{\sqrt{\sum_i e^{-2\frac{E_i}{E_0} \tau}}} = |E_0\rangle \langle E_0 |.
%\end{align}
%Applying the same method to the density matrix one can obtain the ground state $\rho_{GS}$  of a non degenerate Hamiltonian $H$ from a general density matrix $\rho$ such that $Tr[\rho\rho_{GS}]\neq0$ as
%\begin{equation}
%\rho_{GS} = \lim_{\tau \rightarrow \infty} \frac{e^{-H\tau}\rho e^{-H\tau}}{Tr\left[ e^{-2H\tau}\right]}.
%\label{eq:Corr_matr-ITE}
%\end{equation}
%We refer to the method for obtaining the ground state using \eqref{eq:Pure_state-ITE} as performing an \emph{imaginary time evolution}. \\
%This is the case because, if for the time evolution operator $U(t)=e^{-iHt}$ for the Hamiltonian $H$,  we select $t=-i \tau$ we obtain the operator $e^{-H \tau }$ that is the one of eq \eqref{eq:Pure_state-ITE}. One can thus write in a non-formal way $|GS\rangle = \lim_{t \rightarrow -i \infty} \frac{|\psi(t)\rangle}{||\psi(t)\rangle||}$.\\
%It's important to keep in mind, though, that this is \emph{not} a time evolution.\\
%In fact the time evolution operator $U(t)$ is defined just for $t\in \mathbb{R}$, and the operator $e^{-H\tau}$ is not even unitary (for this reason it doesn't preserve the norm of the state and we have to renormalise it).\\
%%Nevertheless in the rest of these notes we will always refer to this method as a time evolution ;-).
%%textdej{ ðŸ˜‰}.
%
%
%\section{Numerical Imaginary time evolution}
%In the numerical approach to imaginary time evolution one faces some difficulties.\\
%Almost in all cases one is forced to evolve the state step by step renormalising every time, performing a discrete imaginary time evolution.\\
%This procedure doesn't allow to reach infinite time in a finite amount of time steps, thus one has to find a criterion to stop the evolution when the convergence is accurate up to some confidence parameter. To check if the reached state is the expected state is tricky and theoretically impossible in most of the cases.\\
%A method to check the convergence is to check the energy difference between two steps of the discrete imaginary time evolution. Once the difference in energy between two steps is lower than an acceptable value, one decides that the algorithm converged.\\
%It is not always the case though. Most of the time one is not acting with the exact imaginary time evolution, but instead with an approximation of it. This approximation is usually dependent from the size of the time step, and for badly chosen sizes of the time step it can even make the energy of the state growing instead of diminishing. It is also possible that the approximate imaginary time evolution stops to some plateau and thus trick the algorithm in believing in a false convergence to the ground state. \\
%%It seems the best way to deal with this is learning the art.
%
%\section{Numerical Imaginary time evolution for Fermionic Gaussian states}
%The imaginary time evolution of Fermionic Gaussian state is one of the many cases for which it is not possible to compute an exact imaginary time evolution but one has to use an approximate one.\\
%The reasons for which it is not possible to compute an exact imaginary time evolution for Fermionic Gaussian systems are mainly two.\\
%Given a Gaussian Fermionic Hamiltonian $H$ one expects for its ground state $\rho_{GS}$ to be a Gaussian state characterised by the correlation matrix $\Gamma_{GS}$. Thus, starting with a Fermionic Gaussian states $\Lambda_0$, one evolve it for the imaginary time step $\delta t$ until the algorithm converges. \\
%The first main problem is that the evolution of expression \eqref{eq:Corr_matr-ITE} does not preserve the Guassianity of the state \cite{kraus2009}, thus, in the  standard framework for Fermionic Gaussian state, that is the one of correlation matrices, finding the imaginary-time evolved form $\Gamma(t)$ of the initial state $\Gamma_0$ corresponds first evolve the initial state $\rho_{GS}$ and then projecting it again in the space of Gaussian states. This procedure introduces an approximation in the algorithm which makes the questions about convergence to the real ground state even harder.
%
%%%%%FIGURE 1
%\begin{figure}
%	\centering
%	\includegraphics[width=0.8\linewidth]{figure/Gaussian-Projection.pdf}
%	\caption{Imaginary time evolution of the Guassian state $\rho_{0}$ with Hamiltonian $H$. In green is represented the exact imaginary time evolution. The red dotted lines represent projections into the the space of Gaussian states. If we compute the exact imaginary time evolution until the point of convergence we can reach the ground state $\rho_{GS}$ of $H$ within machine precision. With the numerical algorithm one has to project at each step the evolved state into the space of Gaussian states, possibly leading to a wrong approximation of the ground state $\tilde{\rho}_{GS}$.
%	}
%	\label{fig:Sectors_Fourier}
%\end{figure}
%%%%%
%
%The second main problem is that, as we will soon see, in the framework of Gaussian states it seems not even possible to compute the exact time evolution for each time step. We are thus forced to consider an approximate imaginary dynamic for each time step.\\
%\subsection{Imaginary time evolution of symbol matrices}
%The imaginary time evolution of the correlation matrix is defined as
%\begin{align}
%\Lambda_{i,j}(\tau) & = Tr\left[\rho(\tau) \vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}\right] = \\
%& = \frac{Tr \left[\rho e^{-\hat{H}\tau}\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger} e^{-\hat{H}\tau}  \right]}{Tr\left[e^{-2\hat{H}\tau}\right]}.
%\label{eq:rho(tau)}
%\end{align}
%\subsubsection{Heisenberg imaginary time evolution}
%One can compute the imaginary time evolution in Heisenberg picture with $e^{-\hat{H}\tau}$ of  the operator $\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}$. Using \emph{BCH2} (i.e. $e^{A}Be^{A}=\sum_{n=0}^{\infty}\frac{1}{n!}\underbrace{\{A,...\{A}_{n},B\underbrace{\}...\}}_{n}$) and moving in the diagonal basis with Dirac operators  $\vec{\beta}$ one can write the Hamiltonian as $\hat{H}=\frac{1}{2}\sum_k \epsilon(k) \left(b_k^{\dagger}b_k-b_kb_k^{\dagger}\right)$.\\
%Thus one has
%\begin{align}
%e^{-\hat{H}\tau}&\vec{\beta}_{l}\vec{\beta}_{j}^{\dagger}e^{-\hat{H}\tau} = \sum_{n=0}^{\infty} \frac{\tau^n}{n!} \underbrace{\{\hat{H},...\{\hat{H}}_{n},\vec{\beta}_{l}\vec{\beta}_{j}^{\dagger}\underbrace{\}...\}}_{n}.
%\end{align}
%Computing the anticommutators in the expansion of the imaginary time evolution of the couple $b_{i}^{\dag}b_{j}$ we obtain
%\begin{align}
%e^{-\hat{H} \tau} b_{i}^{\dag}b_{j} e^{-\hat{H} \tau} = \left[ \sum_{n=0}^{\infty}  \frac{\tau^n}{n!} \sum_{k=0}^{n}  \binom{n}{k}\Delta_{i,j}^{n-k} \hat{H}^{k} \right]b_{i}^{\dag}b_{j},
%\end{align}
%with $\Delta_{i,j} = (\epsilon(j)-\epsilon(i))$ and $\binom{n}{k}=\frac{n!}{k!(n-k)!}$ the binomial coefficient.
%%The expansion of the anticommutators for each value of $n$ is not trivial. We computed the first terms in the expansion of the imaginary time evolution of the couple $b_{i}^{\dagger}b_j$:\\
%%\resizebox{\textwidth}{!}{%
%%$
%%\begin{array}{ccccccc}
%%	n & anticommutator & b_{i}^{\dagger}b_{j} & Hb_{i}^{\dagger}b_{j} & H^{2}b_{i}^{\dagger}b_{j} & H^{3}b_{i}^{\dagger}b_{j} & H^{4}b_{i}^{\dagger}b_{j}\\
%%	0 & \mathbb{I}& 1&0  &0 &0 &0 \\
%%	1 & \left\{ H,b_{i}^{\dagger}b_{j}\right\}  & \left(\epsilon_{j}-\epsilon_{i} \right)-\sigma & 1 & 0 & 0 & 0\\
%%	 2 &\left\{ H,\left\{ H,b_{i}^{\dagger}b_{j}\right\} \right\}  & \left((\epsilon_{j}-\epsilon_{i})-\sigma\right)^{2} & \left(2(\epsilon_{j}-\epsilon_{i})-\sigma\right) & 2 & 0 & 0\\
%%	3 &\left\{ H,\left\{ H,\left\{ H,b_{i}^{\dagger}b_{j}\right\} \right\} \right\}  & \left((\epsilon_{j}-\epsilon_{i})-\sigma \right)^{3} & \left((\epsilon_{j}-\epsilon_{i})-\sigma\right)^2+(\epsilon_{j}-\epsilon_{i})\left(2(\epsilon_{j}-\epsilon_{i})-\sigma\right) & \left(6(\epsilon_{j}-\epsilon_{i})-2\sigma \right) & 4 & 0 \\
%%	\vdots&\vdots & \vdots & \vdots & \vdots & \vdots & \ddots
%%\end{array}.
%%$
%%}\\
%%
%%We associate to each line $n\in[0,\infty)$ of the table a vector $\vec{X}^n$ of coefficients $\{X_i^n\}_{i\in[0,\infty)}$ defining $\Delta_{l,j} = (\epsilon_{j}-\epsilon_{l})$ and $\sigma=\sum \frac{\epsilon_k}{2}$, we can write  $\vec{X}^n(l,j)$ as:
%%\begin{align}
%%\vec{X}^n(l,j)  = [&(\Delta_{l,j}-\sigma)^n, X_0^{n-1}(l,j)+\Delta_{l,j} X_1^{n-1}(l,j),2X_1^{n-1}(l,j)+\Delta_{l,j} X_2^{n-1}(l,j), \nonumber \\
%%& \dots,\underbrace{2X_{i,1}^{n-1}+\Delta X_{i}^{n-1}}_{i},\dots ]
%%\label{eq:coefficients}
%%\end{align}
%%with
%%\begin{equation}
%%X^{n}_i(l,j) =
%%\begin{cases*}
%%0  & if $ i<n$ \\
%%2^{(n-1)}        & if $i=n$\\
%%1 & if $i=n=0$
%%\end{cases*}.
%%\end{equation}
%%Using this we rewrite the imaginary time evolution as
%%\begin{equation}
%%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} = \sum_{n=0}^{\infty}\sum_{i=0}^{n}\frac{\tau^n X^n_i(l,j)}{n!}H^i b_{l}^{\dagger}b_j.
%%\label{eq:Heisenberg-evolution-bibj}
%%\end{equation}
%%%This is complex to compute. (Is it like a cellular automata?).
%%Changing the order of these sums %(can I? it seems the sum it doesn't converge if I exchange)
%% as
%%\begin{equation}
%%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} = \sum_{i=0}^{\infty}\sum_{n=i}^{\infty}\frac{\tau^n X^n_i(l,j)}{n!}H^i b_{l}^{\dagger}b_j,
%%\end{equation}
%%we can rewrite the imaginary time evolution of the operators $b_{l}^{\dagger}b_j$ in terms of the weighted Pascal's triangle terms $D^{n}_i$
%%\begin{align}
%%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} &= \sum_{i=0}^{\infty}\sum_{n=i}^{\infty}\frac{\tau^{n+1} D^n_i(l,j)}{(n+1)!}H^{i+1} b_{l}^{\dagger}b_j+\nonumber \\
%%&+\sum_{i=0}^{\infty}\frac{\left(\tau(\Delta-\sigma)\right)^n}{n!}b_{l}^{\dagger}b_j.
%%\end{align}
%%
%%%%%%FIGURE 2
%%\begin{figure}
%%	\centering
%%	\includegraphics[width=0.80\linewidth]{figure/Weighted-Pascal.pdf}
%%	\caption{The table of the coefficients \eqref{eq:coefficients} has this structure. The coefficients of $b_{i}^{\dagger}b_j$ are simple incremental power of $(\Delta-\sigma)$. From the second column on it has the structure of a weighted Pascal's triangle with $2$  as weight on the diagonal direction and $\Delta$ as weight on the vertical direction, thus for example we have $D^{2}_2=2D^{2}_{1}+\Delta D^{1}_{2}$.
%%	}
%%	\label{fig:Sectors_Fourier}
%%\end{figure}
%%%%%%
%%
%%It is possible to find a non-recursive form of the terms $D^{n}_{i}$, that is
%%\begin{equation}
%%D^{n}_{i}(l,j)=2^i \sum_{x=0}^{n}\Delta^{x}_{l,j}A_{l,j}(n-x)\binom{i-1+x}{i-1}.
%%\end{equation}
%%This form refers just to the fixed boundary terms.
%%Inserting the expansion of the boundary terms we obtain
%%\begin{align}
%%D^{n}_{i}(l,j)& =\frac{2^i \Delta^{n+1}_{l,j}}{\sigma}\binom{i+n}{i}+ \nonumber \\& -\frac{2^{i}(\Delta_{l,j}-\sigma)}{\sigma}\sum_{x=0}^{n}\binom{i-1+x}{i-1}\Delta^{x}_{l,j}(\Delta_{l,j}-\sigma)^{n-x}
%%\end{align}
%%%\begin{remark}Some observations on the expansion \eqref{eq:Heisenberg-evolution-bibj}
%%%	\begin{itemize}
%%%		%\item Since the Hamiltonian is Fermionic we have that the sum over $i$ in \eqref{eq:Heisenberg-evolution-bibj} run from $0$ to $N$, where $N$ is the number of considered Fermionic sites. In fact, if $i>N$ we would have $H^i=0$ because necessarily some fermionic operator would be doubled.
%%%		\item If we exchange the summation in \eqref{eq:Heisenberg-evolution-bibj} (can we?) we obtain an approximation of $\langle b_i^{\dagger}b_j\rangle(t)$in terms of  $\langle H^ib_i^{\dagger}b_j\rangle$, thus in terms of $i-$points correlations. What does it mean to cut to some $i$?
%%%	\end{itemize}
%%%\end{remark}
%
%
%
%\subsubsection{Expansion of the imaginary time evolution with $\delta t$}
%This method has been showed in \cite{kraus2010} to be equivalent to other variational methods and to be  usually an effective method.
%
%
%In order to compute the expansion of the imaginary evolution in terms of $\delta t$ we start from the exact time derivative of eq \eqref{eq:rho(tau)}
%\begin{equation}
%\frac{d}{d\tau} \rho(\tau) = -\left\{ \hat{H},\rho(\tau) \right\}+2\rho(\tau)\langle \hat{H} \rangle.
%\end{equation}
%Using the last equation and exploiting the linearity of the trace, we can easily compute the time derivative of the evolution of a term of the correlation matrix
%\begin{equation}
%\frac{d}{dt}\Gamma^{[1]}_{i,j}(\tau)= -Tr\left[ \left\{ \hat{H},\rho(\tau)\right\}b_{i}^{\dagger}b_j\right]+2\langle \hat{H}\rangle \Gamma^{[1]}_{i,j}.
%\label{eq:ddtau-Lambda_1}
%\end{equation}
%Considering the first term in the LHS we can proceed as follows.
%\begin{align}
%Tr\left[ \left\{ \hat{H},\rho(\tau)\right\}b_{i}^{\dagger}b_j\right] &=\Tr{\left\{ \hat{H},b_{i}^{\dagger}b_j\right\}\rho(\tau)}= \nonumber\\
%& =\langle \hat{H} b_{i}^{\dagger}b_{j}\rangle + \langle b_{i}^{\dagger}b_{j} \hat{H} \rangle,
%\label{eq:Term-1_LHS_ddt-Lambda}
%\end{align}
%using the Fermionic Wick Theorem (i.e. $\expv{abcd}=\expv{ab}\expv{cd}-\expv{ac}\expv{bd}+\expv{ad}\expv{bc}$)
%\begin{align*}
%\langle \hat{H} & b_{i}^{\dagger}b_{j}\rangle  =\sum_{k=0}^{N-1}\frac{\epsilon_k}{2}\left(\expv{b^{\dagger}_{k}b_{k}b_{i}^{\dagger}b_{j}}-\expv{b_{k}b_{k}^{\dagger}b_{i}^{\dagger}b_{j}} \right)= \nonumber\\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\sum_{k=0}^{N-1}\epsilon_k\left( \expv{b_{k}b_{i}^{\dagger}}\expv{b_{k}^{\dagger}b_{j}}-\expv{b_{k}^{\dagger}b_{i}^{\dagger}}\expv{b_{k}b_{j}} \right)=\nonumber \\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\sum_{k=0}^{N-1}\epsilon_k\left(\delta_{i,k}\Gamma^{[1]}_{k,j}-\Gamma^{[1]}_{i,k} \Gamma^{[1]}_{k,j}+\Gamma^{[2]}_{i,k}\Gamma^{[3]}_{kj}\right) =\nonumber \\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\epsilon_i\Gamma^{[1]}_{i,j}+(\Gamma H_D \Gamma)_i,j
%\end{align*}
%where in the last step we used the specific diagonal  $H_D$ form of $H$ with negative entries on the first half of the diagonal and positive on the second half.\\
%With the same procedure we find
%\begin{align*}
%\expv{b_{i}^{\dagger}b_{j}\hat{H}} = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\epsilon_{j}\Gamma^{[1]}_{i,j}+(\Gamma H_D \Gamma)_{i,j}.
%\end{align*}
%Inserting both terms first in \eqref{eq:Term-1_LHS_ddt-Lambda} and then in \eqref{eq:ddtau-Lambda_1} one obtains
%\begin{equation*}
%\frac{d}{d\tau}\Gamma^{[1]}_{i,j}(\tau)= -2(\Gamma H_D \Gamma)_{i,j}-(\epsilon_{i}+\epsilon_{j})\Gamma^{[1]}_{i,j}=-2(\Gamma H_D \Gamma)_{i,j}-\left[H_D,\Gamma\right]_{i,j},
%\end{equation*}
%and thus applying the same procedure for each quadrant of the correlation matrix one obtain the general form of the derivative of the imaginary time evolution of the correlation matrix
%\begin{equation}
%\frac{d}{d\tau}\Gamma(\tau) = 4\Gamma(\tau) H_D\Gamma(\tau) - 4 H_D\Gamma(\tau) .
%\label{eq:ddtau-Lambda}
%\end{equation}
%It will result more convenient work in the Majorana formalism now. For Majorana fermions equation \eqref{eq:ddtau-Lambda} read as
%\begin{equation}
%\frac{d}{d\tau}\gamma(\tau) = 4\left((\gamma(\tau) \tilde{h}_d\gamma(\tau) - \tilde{h}_D,\gamma(\tau)\right) .
%\end{equation}
%
%%\emph{Now we introduce an approximation}.\\
%At first order in imaginary time we can write the derivative as
%\begin{equation*}
%\gamma(\tau+\delta \tau)-\gamma(\tau) = \left( 4\gamma(\tau)H_D\gamma(\tau) - 4 H_D,\gamma(\tau)\right)\delta \tau +\mathcal{O}(\delta \tau^2).
%\end{equation*}
%We want to find an orthogonal matrix $O_\tau$ such that
%\begin{equation*}
%\gamma(\tau+\delta \tau) = O_{\tau}(\delta \tau) \gamma(\tau) O_{\tau}^{T}( \delta \tau).
%\end{equation*}
%Requesting for it to be orthogonal is a necessary and sufficient condition for it to be a general transformation on Majorana Fermions preserving the anticommutation relations.
%We write $O_{\tau}(\delta \tau) = e^{L_t \delta \tau}$ with $L_t^{T}=-L_t$ (every special orthogonal matrix can be written as the exponential of a skew-symmetric matrix, this is why here is more convenient working with Majoranas).% In fact a general transformation on Dirac Fermions is a matrix $U$ such that $U\Omega^{T}$ is orthogonal or such that $UU^{\dagger}=\{\{0,\mathbb{I}\},\{\mathbb{I},0\}\}$).
%\\
%At first order in time we would have
%\begin{equation*}
%\gamma(\tau+\delta \tau) = \gamma(t)+ \left[L_t,\gamma(t) \right] \delta t+ \mathcal{O}(\delta t^2).
%\end{equation*}
%In order to find $O_{\tau}(\delta \tau)$ at first order in time we have to solve
%\begin{equation*}
%\left[L_{\tau},\gamma(\tau) \right] = 4\gamma(\tau)H_D\gamma(\tau)-4H_d,\gamma(\tau).
%\end{equation*}
%%\emph{Here we insert a request.}\\
%This equation has a simple solution if we restrict to the case of pure Fermionic Gaussian states that is  imposing to the correlation matrix to be idempotent, $\gamma=\gamma^2$.\\
%For a pure state we have
%\begin{equation*}
%L_{\tau} = 2\left[H_d,\gamma(\tau) \right].
%\end{equation*}
%Thus the imaginary time evolution of the correlation matrix of a pure Fermionic Gaussian state with an approximation at first order in time is:
%\begin{equation}
%\gamma(\tau)(t+\delta t) = e^{2\left[H_D, \gamma(\tau)\right]}\gamma(\tau)e^{-2\left[H_D,\gamma(\tau) \right]}
%\end{equation}
%or for Dirac Fermions
%\begin{equation}
%\Gamma(\tau)(t+\delta t) = e^{2\left[H_D, \Gamma(\tau)\right]}\Gamma(\tau)e^{-2\left[H_D,\Gamma(\tau) \right]},
%\end{equation}
%where $H_D$ is the block diagonalised or diagonalised Hamiltonian for Majorana or Dirac.
%
%
%
%



%%%%%%%%%%Appendix
\appendix

\chapter{Extended calculations}
\section{Eigenvalues of $\Gamma$ and $H_{\alpha}$}
\label{appendix:Eigenvalues-Relations}
We consider the state $\rho=\frac{e^{-\frac{1}{2}\vec{\alpha}^{\dagger}M_{\rho}\vec{\alpha}}}{Z}$, we diagonalise $M_{\rho}$ changing the basis to $\vec{\beta}=U^{\dagger}\vec{\alpha}$. Thus we have
\begin{equation}
\rho=\frac{e^{-\frac{1}{2}\vec{\beta}^{\dagger}M_{D}\vec{\beta}}}{Z}=\frac{e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}}{Z}.
\end{equation}

We change the basis of the correlation matrix too
\begin{equation}
\Gamma_{i,j}^{b}=\left(U^{\dagger}\Gamma U\right)_{i,j}=Tr\left[\rho\vec{\beta}_{i}\vec{\beta_{j}}^{\dagger}\right].
\end{equation}

Now we want to explicitly compute the elements of $\Gamma^{b}$. First of all we compute the normalisation constant

\begin{equation}
Z=Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\right] =\prod_{k=1}^{N-1}\left(2\cosh\left(\frac{\epsilon_{k}}{2}\right)\right).
\end{equation}

To compute the numerator part this equalities will result useful
\begin{itemize}
\item  For $x\neq y$

\begin{equation}
\begin{aligned}
Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)} b_{x}^{\dagger}b_{y}\right]	&  =\sum_{v\in\left\{ 0,1\right\} ^{N}}\langle v|e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}^{\dagger}b_{y}|v\rangle=\\
	&=\sum_{v\in\left\{ 0,1\right\} ^{N}}\langle v|e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}|\tilde{v}\rangle=\\
	& =\sum_{v\in\left\{ 0,1\right\} ^{N}}e^{-\frac{1}{2}\sum_{k=0}^{N-1}(-1)^{v_{k}+1}\epsilon_{k}}\langle v|\tilde{v}\rangle = 0
\end{aligned}
\end{equation}


\begin{equation}
Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}b_{y}^{\dagger}\right]=0
\end{equation}

â€¢\item $\forall x,y$

\begin{equation}
Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}b_{y}\right]=0
\end{equation}
\begin{equation}
Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}^{\dagger}b_{y}^{\dagger}\right]=0
\end{equation}

Thus the numerator can be explicitly written as

\begin{equation}
Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\vec{\alpha}_{i}\vec{\alpha_{j}}^{\dagger}\right]=
\end{equation}

\begin{equation*}
=\sum_{l=1}^{2N}\sum_{m=1}^{2N}U_{i,l}U_{m,j}^{\dagger}Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\vec{\beta}_{l}\vec{\beta_{m}}^{\dagger}\right]=
\end{equation*}

\begin{equation*}
=\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{l}^{\dagger}b_{l}\right]+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}Tr\left[e^{-\frac{1}{2}\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{l}b_{l}^{\dagger}\right]=
\end{equation*}

\begin{equation*}
=\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}e^{-\frac{\epsilon_{l}}{2}}\prod_{k\neq l}2\cosh(\frac{\epsilon_{k}}{2})+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}e^{\frac{\epsilon_{l}}{2}}\prod_{k\neq l}2\cosh(\frac{\epsilon_{k}}{2})
\end{equation*}

I can divide by Z and obtain

\begin{equation}
\begin{aligned}
\Gamma_{i,j} & =\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}\frac{e^{-\frac{\epsilon_{l}}{2}}}{e^{\frac{\epsilon_{l}}{2}}+e^{-\frac{\epsilon_{l}}{2}}}+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}\frac{e^{\frac{\epsilon_{l}}{2}}}{e^{\frac{\epsilon_{l}}{2}}+e^{-\frac{\epsilon_{l}}{2}}}\\
 & =\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}\frac{1}{1+e^{\epsilon_{l}}}+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}\frac{1}{1+e^{-\epsilon_{l}}}=\\
 & =\sum_{l=1}^{2N}U_{i,l}U_{l,j}^{\dagger}\frac{1}{1+e^{\epsilon_{l}}}=U\Gamma^{D}U^{\dagger}.
\end{aligned}
\end{equation}

\end{itemize}


So the same transformation U that moves to the free Hamiltonian $M_D$ is also the transformation that diagonalise the correlation matrix. The eigenvalues $\nu_{i}$ of the correlation matrix $\Gamma$ are related to the eigenvalues of the Hamiltonian $M_{\rho}$ by

\begin{equation}
\nu_{i}=\frac{1}{1+e^{\epsilon_{i}}},
\end{equation}

\begin{equation}
\epsilon_{i}=ln\left(\frac{1-\nu_{i}}{\nu_{i}}\right),
\end{equation}

since $\nu_{i}\in\left[0,1\right]$ the eigenvalues $\epsilon_{i}\text{\ensuremath{\in}[-\ensuremath{\infty},+\ensuremath{\infty}]}$.


\section{Purity}
\label{appendix:Purity}
From the previous subsection we have:

\begin{equation}
Z^{2}=\prod_{k=1}^{N-1}\left(2\cosh\left(\frac{\epsilon_{k}}{2}\right)\right)^{2}
\end{equation}

and

\begin{equation}
Tr\left[e^{-\sum_{k=0}^{N-1}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\right]=\prod_{k=1}^{N-1}\left(2\cosh\left(\epsilon_{k}\right)\right).
\end{equation}


Thus the purity is:

\begin{equation}
\mbox{Purity}=\prod_{k=1}^{N-1}\frac{1}{\sech(\epsilon_{k})+1}
\end{equation}



\chapter{F-utilities}
\begin{enumerate}
\item \code{Print\_matrix(title, M)}: Print a graphical representation of matrix \code{M} in a figure called title.

\item \code{Build\_Omega(N)$\rightarrow \Omega$}: This function return the $2N\times2N$ matrix $\Omega$ \eqref{eq:Omega}.

\item \code{Build\_FxxTxp(N)$\rightarrow F_{xx\rightarrow xp}$}: This function return the $2N\times2N$ matrix $F_{xx\rightarrow xp}$ \eqref{eq:FxxTxp}.

\item \code{Build\_FxpTxx(N)$\rightarrow F_{xp\rightarrow xx}$}: This function return the $2N\times2N$ matrix $F_{xx\rightarrow xp}^{T}$.

\item \code{Diag\_Real\_Skew(h)$\rightarrow h_D,O$}: This function implements the algorithm for the block diagonalisation of $h$ a generic skew-symmetric real matrix. $h_D$ is the block-diagonal matrix of \eqref{eq:Schur-Decomposition} and has the following property: it is in the block diagonal form, each $2\times2$ block is skew-symmetric with the upper-right element positive and real and $h_D$ is in ascending order for the upper diagonal. $O$ is an orthogonal matrix such that: $h=O h_D O^{T}$.

\item \code{Diag\_ferm(M)$\rightarrow M_{f},U_{f}$}:This function implement the fermionic algorithm of  section \ref{Dirac-Diagonalisation} with $M=H_{a}$. $M_{f}$ is the matrix we called $H_{D}$ and it is in diagonal form with the first half diagonal negative and the second one positive. $U_{f}$ is the orthogonal matrix that we called $U$ and it is a unitary matrix such that: $M=U_{f}M_{f}U_{f}^{\dagger}$.

\item \code{Diag\_Gamma(M)$\rightarrow  M_{f}, U$}
This function returns $M_{f}$, the the diagonal form \eqref{eq:Gamma-Dirac-Diagonal} of the Dirac correlation matrix $M$ and $U$ the fermionic transformation such that $M=U M_{f} U\dag $.

\item \code{Purity(M)$\rightarrow p$}: This function takes as input the correlation matrix $\Gamma$ and return a Float $p$ from $0$ to $1$ that is the purity.

\item \code{Evolve\_gamma(M,D,U,t)$\rightarrow M_{t}$}: This function evolve for a time \code{t} (last argument) the correlation matrix $\Gamma$ (first argument), \code{D} is the Dirac Hamiltonian diagonalised, $U$ is the unitary transformation that change basis from the diagonal one to the original one. e.g. If I want to evolve the correlation matrix $M$ with $H_{a}$ for a time $t$ I would write \code{M\_{t}=Evolve\_gamma(M,Diag\_ferm($H_{a}$),$t$)}.

\item \code{Evolve\_gamma\_imag(M,D,U,t)$\rightarrow M_{t}$}: This function evolve for a time \code{t} (last argument) the pure state correlation matrix $\Gamma$ (first argument) with the evolution \ref{eq:Imaginary-Evolution}, \code{D} is the Dirac Hamiltonian diagonalised, $U$ is the unitary transformation that change basis from the diagonal one to the original one .N.B. \code{M} must be a pure state (Purity$(M)=1$), \code{Evolve\_gamma\_imag(M,D,U,t)} is a pure state.

\item \code{Energy\_fermion(M,D,U)$\rightarrow e$}: This function return the energy of the correlation matrix $M$ with respect of the Hamiltonian in the diagonal form $M$ where $U$ is the change of basis from the diagonal one to the space one. e.g. If I want to compute the energy of the correlation matrix $\Gamma$ with respect to the generic quadratic Hamiltonian represented by $H$ I would write \code{Energy\_fermion($\Gamma$,Diag\_ferm($H$))}.

\item \code{Reduce\_gamma(M,N\_partition,first\_index) $\rightarrow M_{r}$}: This function return the correlation matrix of a subsystem with \code{N\_partition} size starting from the site at \code{first\_index}. e.g. \code{Reduce\_gamma()} return the green the element of the matrix $M_{6\times6}$
\begin{equation}
\mbox{\mbox{Reduce\_gamma}(\ensuremath{M_{6\times6}},2,1)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}
\end{array}\mbox{Reduce\_gamma(\ensuremath{M_{6\times6}},2,3)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}
\end{array}
\end{equation}

\item \code{Inject\_gamma(gamma, injection, first\_index)$\rightarrow M_{T}$}:This function overwrite the subsystem of gamma starting at \code{first\_index} with the system with correlation matrix injection. The system of injection has to be smaller then the one of gamma. The returned system has same dimension of gamma. e.g. \code{Inject\_gamma()} return the red and blue matrix where the elements in red are the one of the matrix injection.
\begin{equation}
\mbox{Inject\_gamma(\ensuremath{M_{6\times6}},2,1)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}
\end{array}\mbox{Inject\_gamma(\ensuremath{M_{6\times6}},2,3)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}
\end{array}
\end{equation}

\item \code{Eigenvalues\_of\_rho(M)$\rightarrow \vec{e}$}: This function take as input a correlation matrix $\Gamma$ and return the vector with all its eigenvalues. N.B. The number of eigenvalues grows exponentially with the size of $\Gamma$.

\item \code{VN\_Entropy($\Gamma$) $\rightarrow S$} This function return $S$, the \code{Float64} value of the Von Neumann Entropy of the state described by the Dirac correlation matrix $\Gamma$.


\end{enumerate}


 \chapter{Useful relations}
 \section{Pauli Matrices}
 \begin{enumerate}
  \item  $\sigma^+ = \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix}$, $\sigma^-=\begin{pmatrix} 0 & 0 \\ 1 & 0 \end{pmatrix}$, $\sigma^z=\begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix}$, $\sigma^y=\begin{pmatrix} 0 & -\im \\ \im & 0 \end{pmatrix}$, $\sigma^x=\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$, $\ket{+}_x= \frac{1}{\sqrt{2}}\colvec{2}{1}{1}$, $\ket{-}_x= \frac{1}{\sqrt{2}}\colvec{2}{1}{-1}$, $\ket{+}_y= \frac{1}{\sqrt{2}}\colvec{2}{1}{\im}$, $\ket{-}_y= \frac{1}{\sqrt{2}}\colvec{2}{1}{-\im}$, $\ket{0_{-}}_z= \colvec{2}{0}{1}$, $\ket{1_{+}}_z=\colvec{2}{1}{0}$
 \item $\sigma^z \sigma^- = -\sigma^-$
 \item $\sigma^z \sigma^+ = \sigma^+$
 \item $\sigma^- \sigma^z = \sigma^-$
 \item $\sigma^+ \sigma^z = -\sigma^+$
 \item $\sigma^+ \sigma^- = \frac{\sigma^z+\id}{2}$
  \item $\sigma^- \sigma^+ = \frac{\id-\sigma^z}{2}$
 \end{enumerate}
 \section{Operators obeying CAR}
 \label{appendix:fermionic_operators}
 \begin{enumerate}
 \item $\{a_i,a\da_j\} = \id \delta_{i,j}$ \qquad $\{a_i,a_j \}=\{a_i^{\dagger},a_{j}^{\dagger} \} = 0$
 \item $a_ia_j=-a_ja_i$;\qquad $a_i^{\dagger}a_j^{\dagger} = -a_{j}^{\dagger}a_i^{\dagger}$
 \item $a^2_i=\left(a\da_j\right)^2=0$
 \item $a_ia_j^{\dagger}=\delta_{i,j}-a_j^{\dagger}a_i$
 \item $a_ia_j=\frac{a_ia_j-a_ja_i}{2}$
 \item $a_ia_j^{\dagger}=\frac{a_ia_j^{\dagger}-a_j^{\dagger}a_i}{2}+\frac{\delta_{i,j}}{2}$
  \item $a_i^{\dagger}a_j=\frac{a_i^{\dagger}a_j-a_ja_i^{\dagger}}{2}+\frac{\delta_{i,j}}{2}$
 \end{enumerate}
Commutators
 \begin{enumerate}
  \item $[a_i^{\dagger},a_j]=\delta_{i,j}-2a_ja_i^{\dagger}=a_i^{\dagger}a_j-\delta_{i.j}$
  \item $[a_i,a_j^\dagger]=\delta_{i,j}-2a_j^{\dagger}a_i=a_i a_j^{\dagger}-\delta_{i,j}$
  \item $[a_i,a_j]=2a_i a_j$
  \item $[a_i^{\dagger},a_j^{\dagger}]=2a_i^{\dagger}a_j^{\dagger}$
 \end{enumerate}
 Majorana operators
 \begin{enumerate}
\item $x_{i}^{2}=p_{i}^{2}=\frac{1}{2}$
\item $a^{\dagger}a=\frac{i}{2}\left(xp-px\right)+\frac{1}{2}=ixp+\frac{1}{2}$
\item $aa^{\dagger}=\frac{i}{2}\left(px-xp\right)+\frac{1}{2}=ipx+\frac{1}{2}$
\item $xp=-\frac{i}{2}\left(a^{\dagger}a-aa^{\dagger}\right)=-i\left(a^{\dagger}a-\frac{1}{2}\right)$
\end{enumerate}

 \section{Jordan-Wigner Transformations}
 \subsection{spinless fermions $\rightarrow$ spins}
 \begin{enumerate}
 \item $a_j=-\bigotimes_{k=1}^{j-1}\sigma_k^z\otimes\sigma_j^-\bigotimes_{k=j+1}^N\mathbb{I}_k$
 \item $a_j^{\dag}=-\bigotimes_{k=1}^{j-1}\sigma_k^z\otimes\sigma_j^+\bigotimes_{k=j+1}^N\mathbb{I}_k$
  \item $a_j^{\dag}a_j=\bigotimes_{k=1}^{j-1}\otimes \frac{\sigma_j^z+\id_j}{2} \bigotimes_{k=j+1}^N \id_k $
 \end{enumerate}
 \subsection{spins $\rightarrow$ spinless fermions}
 \begin{enumerate}
 \item $\sigma_j^z = a_j^{\dag} a_j-a_j a_j^{\dag}$
 \item $\sigma_j^x = -\bigotimes_{k=1}^{j-1}\sigma_j^z\otimes(a_j+a_j^{\dag})\bigotimes_{k=j+1}^{N}\id_j$
 \item $\sigma_j^x = \im \bigotimes_{k=1}^{j-1}\sigma_j^z\otimes(a_j^{\dag}-a_j)\bigotimes_{k=j+1}^{N}\id_j$
 \item $\sigma_j^x\sigma_{j+1}^x = (a_j^{\dag}-a_j)(a_{j+1}+a_{j+1}^{\dag})$
 \item $\sigma_j^y\sigma_{j+1}^y = -(a_j^{\dag}+a_j)(a_{j+1}^{\dag}-a_{j+1}) $
 \item $\sigma_j^x\sigma_{j+1}^y = \im (a_j^{\dag}-a_j)(a_{j+1}^{\dag}+a_{j+1})$
 \item $\sy_j\sx_{j+1} = \im (a_j\da+a_j)(a_{j+1}\da+a_{j+1})$
 \end{enumerate}
%\section{}
%\subsection{}

\bibliography{QFH}
%\bibliographystyle{ieeetr}








































\end{document}
