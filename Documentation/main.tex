 \documentclass[elegant,blue,11pt]{elegantbook}

\title{Practical Fermionic Gaussian States}
\subtitle{Fermionic Gaussian States: practical numerical simulations}

\author{Jacopo Surace}
\institute{Strathclyde, ICFO}
\date{\today} 
\version{1.00}

\extrainfo{Julia's code on Github}

\logo{logo.png}
\cover{cover.jpg}



%%%%Inizio Miei
%\usepackage{amsthm}

\newcommand{\expv}[1]{\left\langle #1 \right\rangle}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\id}{\mathbb{I}}
\newcommand{\im}{{i\mkern1mu}}
\newcommand{\da}{^{\dag}}
\newcommand{\sx}{\sigma^x}
\newcommand{\sy}{\sigma^y}
\newcommand{\sz}{\sigma^z}
\newcommand{\ket}[1] {| #1 \rangle}
 \newcommand{\bra}[1] {\langle #1 |}
  \newcommand{\Tr}[1] {\mbox{Tr}\left[ #1 \right]}
  \DeclareMathOperator{\sech}{sech}


\newcount\colveccount
\newcommand*\colvec[1]{
        \global\colveccount#1
        \begin{pmatrix}
        \colvecnext
}
\def\colvecnext#1{
        #1
        \global\advance\colveccount-1
        \ifnum\colveccount>0
                \\
                \expandafter\colvecnext
        \else
                \end{pmatrix}
        \fi
}
\def\code#1{\texttt{#1}}
\usepackage{colortbl}
\definecolor{blue}{cmyk}{0.897, 0.393, 0, 0.0118}
\definecolor{green}{cmyk}{0.835, 0, 0.395, 0.0275}
\definecolor{red}{rgb}{0.992,0.498,0.486}



\usepackage{CJKutf8}

%\usepackage{algorithm}
%\usepackage{algpseudocode}



\usepackage{systeme}
%\usepackage{demonstration}
\usepackage{mathtools}
%\let\openbox\relax
%\usepackage{beramono}
%\usepackage{listings}

\usepackage[autoload=true]{jlcode}

\usepackage{textgreek}

\usepackage{float}

\begin{document}

\maketitle
\tableofcontents
\clearpage
\thispagestyle{empty}
\mainmatter
\hypersetup{pageanchor=true}

\chapter{The canonical anticommutation relations}
\section{The Hilbert space characterised by the canonical anticommutation relations}
Consider a set of operators $\{a_i\}_{i=1}^{N}$ acting on a Hilbert space $\mathcal{H}$. We say that these operators satisfy the \textit{canonical anticommutation relation} (CAR) when they satisfy
\begin{equation}
\label{eq:CAR}
\{a_i,a\da_j\}=\id \delta_{i,j} ;  \qquad \{a_i,a_j\}=0,
\end{equation}
with $\{a,b\}\coloneqq ab+ba$ the notation for the anticommutator. \\
As shown in \cite{nielsen} a number of properties of the set of operators $\{a_i\}_{i=1}^{N}$  and of the Hilbert space $\mathcal{H}$ can be inferred just by the fact that such operators exist and obey the CAR.\\
The  $a\da_i a_i$ are a set of \textit{commuting, hermitian,  positive operators} with eigenvalues $\{0,1\}$.
We denote with $\vec{x}\in\{0,1\}^N$ a binary string of length $N$ with the $i$-th elements $x_i$. With $|\vec{x}\rangle$ we identify one of the $2^N$ states that is the simultaneous eigenstate of $a\da_i a_i$ for all $i=1,\dots,N$ with eigenvalues respectively $x_i$. The operator $a_i$ acts as a \textit{lowering operator} for $a\da_i a_i$ and $a\da_i$ acts as a \textit{raising operator} for $a\da_i a_i$ in the sense that
\begin{enumerate}
\item If $a\da_i a_i |\vec{x}\rangle = |\vec{x}\rangle$, that is, it has the $i$-th eigenvalue equal to $1$. Then the action of $a_i$ on $|\vec{x}\rangle$ lower the corresponding eigenvalue, meaning that $a\da_i a_i (a_i |\vec{x}\rangle) = 0 (a_i |\vec{x}\rangle)$.
\item If $a\da_i a_i |\vec{x}\rangle = 0 |\vec{x}\rangle$, that is, it has the $i$-th eigenvalue equal to $0$. Then the action of $a\da_i$ on $|\vec{x}\rangle$ raise the corresponding eigenvalue, meaning that $a\da_i a_i (a\da_i |\vec{x}\rangle) = 1 (a\da_i |\vec{x}\rangle)$.
\end{enumerate}
We define an \textit{ordering} by explicitly defining $|\vec{x}\rangle \coloneqq (a\da_1)^{x_1}(a\da_2)^{x_2}\dots(a\da_N)^{x_N}|\vec{0}\rangle$, where $\vec{0}$ is the string of $N$ zeros. The set $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ form an orthonormal basis. If the dimension of the Hilbert space $\mathcal{H}$ is $2^N$, then $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ is an orthonormal basis of $\mathcal{H}$.\\
The orthonormal basis $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ is called \textit{Fock basis}.
The action of the raising and lowering operators on $|\vec{x}\rangle$ is then
\begin{align}
a_i |\vec{x}\rangle & =
\begin{cases}
	-(-1)^{S^i_{\vec{x}}}|\vec{x'}\rangle  \mbox{ with } x'_i=0 \mbox{ and } x'_{j\neq i} = x_{j \neq i},  & \text{if } x_i=1 \\
	0 & \text{if } x_i=0
\end{cases},
\\
a\da_i |\vec{x}\rangle  & =
\begin{cases}
	0 & \text{if } x_i=1 \\
	-(-1)^{S^i_{\vec{x}}}|\vec{x'}\rangle \mbox{ with } x'_i=1 \mbox{ and } x'_{j\neq i} = x_{j \neq i},  & \text{if } x_i=0
\end{cases},
\end{align}
with $S^i_{\vec{x}}=\sum_{k=1}^{i-1}x_k$.
\\
In appendix \ref{appendix:fermionic_operators}  we report some useful equalities valid for operators satisfying the CAR.
\section{Dirac and Majorana representations}
The raising and lowering operators $a\da_i$,$a_i$ are called \textit{Dirac operators} and \textcolor{red}{they represent the action of adding and removing the $i$-th fermionic mode.}\\
Both $a_i$ and its adjoint $a\da_i$ are not hermitian. The hermitian combinations of the raising and lowering operators
\begin{equation}
\label{eq:Majorana=Dirac}
\begin{array}{ccc}
x_{i}=\frac{a_{i}+a_{i}^{\dagger}}{\sqrt{2}}, & \mbox{  } & p_{i}=\frac{a_{i}-a_{i}^{\dagger}}{i\sqrt{2}},\end{array}
\end{equation}
are called \textit{Majorana operators}.
\\
The inverse transformations are:
\begin{equation}
\label{eq:Dirac=Majorana}
\begin{array}{ccc}
a_{i}=\frac{x_{i}+ip_{i}}{\sqrt{2}}, & \mbox{  } & a_{i}^{\dagger}=\frac{x_{i}-ip_{i}}{\sqrt{2}}.\end{array}
\end{equation}
\\
In terms of Majorana operators the CARs read as
\begin{equation}
\label{eq:MCAR}
\begin{array}{ccc}
\{ x_{i},x_{j}\} =\{ p_{i},p_{j}\} =\delta_{i,j}, & \mbox{  } & \{ x_{i},p_{j}\} =0.\end{array}
\end{equation}
\\

\begin{remark} Majorana operators labelled by $i$ correspond Dirac operators labelled by $i$. Moving between Majorana and Dirac operators does not mix modes.
\end{remark}


\subsection{Vector notation}
We can collect the Dirac operators of \textcolor{red}{a system with $N$ modes} in the vector $\vec{\alpha}$ of length $2N$ defined as
\begin{equation}
\label{eq:Vector-Alpha}
\begin{array}{ccc}
\vec{\alpha}=\left(\begin{array}{c}
a_{0}^{\dagger}\\
\vdots\\
a_{N-1}^{\dagger}\\
a_{0}\\
\vdots\\
a_{N-1}
\end{array}\right) & \mbox{ , } & \vec{\alpha}^{\dagger}=\left(\begin{array}{cccccc}
a_{0} & \dots & a_{N-1} & a_{0}^{\dagger} & \dots & a_{N-1}^{\dagger}\end{array}\right).\end{array}
\end{equation}
Analogously we can collect the Majorana operators in the vector $\vec{r}$ defined as
\begin{equation}
\label{eq:Majorana-r}
\vec{r}=\left(\begin{array}{c}
x_{0}\\
\vdots\\
x_{N-1}\\
p_{0}\\
\vdots\\
p_{N-1}
\end{array}\right),
\end{equation}
in terms of $\vec{r}$ the CAR are conveniently written as
\begin{equation}
\label{eq:MCAR}
\left\{ r_{i},r_{j}\right\} =\delta_{i,j}.
\end{equation}
We define the unitary matrix $\Omega$ as
\begin{equation}
\label{eq:Omega}
\begin{array}{ccc}
\Omega=\frac{1}{\sqrt{2}}\left(\begin{array}{cc}
\mathbb{I} & \mathbb{I}\\
i\mathbb{I} & -i\mathbb{I}
\end{array}\right) & \mbox{ , } & \Omega^{\dagger}=\Omega^{-1}=\frac{1}{\sqrt{2}}\left(\begin{array}{cc}
\mathbb{I} & -i\mathbb{I}\\
\mathbb{I} & i\mathbb{I}
\end{array}\right)\end{array}.
\end{equation}
Such a matrix, applied to the vector of the Dirac operators $\vec{\alpha}$, returns the vector of Majorana operators $\vec{r}=\Omega\vec{\alpha}$.

%\begin{remark}
%In the Dirac operators representation one associate to each mode $i$ the $2$ operators $a\da_i$ and $a_i$. Moving to the Majorana representation one can maintain the information about the Dirac mode with the notation in $x_i$ and $p_i$. Switching to the vector notation $\vec{r}$ one lose this information, dealing with $2N$ \textcolor{red}{modes}
%\end{remark}

\subsection{Fermionic transformation}
A transformation $\vec{r} \to \vec{s}=O\vec{r}$ is said to respect the CAR in the Majorana representation if it maps a vector of Majorana operators $\vec{r}$ to a new one $\vec{s}=O\vec{r}$. 
Mapping Majorana operators vectors to  Majorana operators vectors corresponds to
\begin{equation}
\delta_{i,j} = \{s_i,s_j\} =\sum_{k,l}O_{i,k}O_{j,l}\{r_k,r_l\}=(OO^{T})_{i,j},
\end{equation}
thus matrix $O$ must be an orthogonal matrix.\\
We call \textit{fermionic transformation} any transformation $\vec{\alpha}\to \vec{\beta}=U\vec{\alpha}$  that respects the CAR of the Dirac operators vectors. Matrix $U$ has the form of $U=\Omega\da O \Omega$ with $O$ an orthogonal matrix. It has been shown in \cite{bravyi2004} that fermionic transformations are generated by f.q.h., thus have the general form $U=e^{-i \hat{H}}$, with $\hat{H}$ a generic f.q.h..


\subsubsection{Clifford Algebra}
\label{sec:Clifford-Algebra}
%Here we present a parallelism between the Clifford algebra generated by the Majorana operators and the Grassmann algebra. This parallelism, aside being beautiful, it will result useful in understanding the \textit{lagrangian representation} of fermionic gaussian states in the next chapter.  For a more comprehensive exposition we refer to \cite{bravyi2004, francesco1997,soper1978}.\\
The $\{r_i\}_{i=1,\dots,2N}$ are hermitian, traceless and generate the Clifford algebra denoted by$\mathcal{C}_{2N}$.\\
Any arbitrary operator $X\in\mathcal{C}_{2N}$ can be represented as a polynomial of the Majorana operators as \cite{bravyi2004}
\begin{equation}
\label{eq:Polynomial-Expansion-Clifford}
X = \alpha_0 \id +\sum_{p=1}^{2N} \sum_{1\leq q_1<\dots< q_p \leq 2N} \alpha_{q_1,\dots,q_p}r_{q_1}\dots r_{q_p},
\end{equation}
where $\id$ is the identity and the coefficients $\alpha_0$ and $\alpha_{q_1,\dots,q_p}$  are real. When the representation of $X\in\mathcal{C}_{2N}$ involves only even powers of Majorana operators, we call it an \textit{even operator}. If the representation of $X$ involves only odd powers of Majorana operators, then $X$ is called \textit{odd} operator.\\
We define the \textit{parity operator} as $P=(i2)^N r_{1} r_{2}\dots r_{2N}=\prod_{i=1}^{N}(\id-2a\da_i a_i)$.\\
Every even $X$ operators commute with the parity operator $P$. The parity $p_X$ of an operator $X$ is defined as $PX=p_X X$ and it can assume just the two values $p\in \{-1,1\}$.\\
Fermionic gaussian hamiltonians are even operators.
For an $N$-mode fermionic system with orthonormal basis $\{|\vec{x}\rangle \}$, the matrices $|\vec{x}\rangle \langle \vec{x}|$ defined for every $\vec{x}$ have the polynomial representation
\begin{equation}
\label{eq:polynomial-representantion-|x><x|}
|\vec{x}\rangle \langle \vec{x}| = \left(\frac{\id}{2}-\im(-1)^{x_1}r_1 r_2\right) \left(\frac{\id}{2}-\im(-1)^{x_2}r_3 r_4\right)\dots \left(\frac{\id}{2}-\im(-1)^{x_N}r_{2N-1} r_{2N}\right),
\end{equation}
thus $\{|\vec{x}\rangle \langle \vec{x}| \}$ are all even operators with parity $p_{|\vec{x}\rangle \langle \vec{x}|}=-(-1)^{\sum_{i=1}^N x_i}$.\\
Mixed matrices $|\vec{x}\rangle \langle \vec{x}|$ with $\vec{x},\neq \vec{x'}$ are odd operators if $\text{mod}(d(\vec{x},\vec{x'}),2)=1$, where $d(\vec{x},\vec{y})$ is the hamming distance of $\vec{x}$ and $\vec{y}$, and they are even operators if $\text{mod}(d(\vec{x},\vec{x'}),2)=0$.
%A complex coefficients Grassmann algebra $\mathcal{G}_2N$ over a complex linear space $\mathbb{C}^{2N}$ is generated  by the generators $\theta_{1},\theta_{2},\dots,\theta_{2N}$, or Grassmann variables, that obey
%\begin{equation}
%\theta^{2}_i = 0, \qquad \theta_{i}\theta{j}+\theta_{j}\theta_{i}=0.
%\end{equation}
%Every element  $f\in\mathcal{G}_{2N}$ can be representend as a polynomial of the Grassman variables as
%\begin{equation}
%f(\theta) = \alpha_0+\sum_{p=1}^{2N} \sum_{1\leq a_1<\dots< a_p \leq 2N} \alpha_{a_1,\dots,a_p}\theta_{a_1}\dots \theta_{a_p}
%\end{equation}
%where the coefficients $\alpha_0$ and $\alpha_{a_1,\dots,a_p}$  are complex numbers.\\
%When the representation of $f(\theta)$ involves only even powers of Grassmann variables, we call it an \textit{even operator}.









\chapter{Fermionic Quadratic Hamiltonians}
\label{ch:1}
\section{Dirac Representation}
The general \textit{fermionic quadratic hamiltonians} (f.q.h.) on a finite lattice of $N$ sites in the Dirac operators representation  can be written as

\begin{equation}
	\label{eq:Dirac-QFH}
	\hat{H}=\sum_{i,j=1}^{N}\left(A_{i,j}a_{i}^{\dagger}a_{j}-\bar{A}_{i,j}a_{i}a_{j}^{\dagger}+B_{i,j}a_{i}a_{j}-\bar{B}_{i,j}a_{i}^{\dagger}a_{j}^{\dagger}\right),
\end{equation}
%
where $A$ is an \textit{hermitian} complex matrix, $A^{\dagger}=A$,  and $B$ is a \textit{skew-symmetric} complex matrix, $B^{T}=-B$ . \\
Defining the matrix
\begin{equation}
\label{eq:H}
H=\left(\begin{array}{cc}
-\bar{A} & B\\
-\bar{B} & A
\end{array}\right),
\end{equation}
\\
the compact form of equation \eqref{eq:Dirac-QFH} reads
\begin{equation}
\label{eq:Dirac-QFH-h}
\hat{H}= \vec{\alpha}^{\dagger}H\vec{\alpha}.
\end{equation}
We will call hamiltonians both $\hat{H}$ and $H$ as for a fized choice of Dirac operators one completely identifies the other.
%

%%%%Majorana Representation
\section{Majorana Representation}
The Majorana representation of the generic f.q.h. reads as
\begin{equation}
\label{eq:Majorana-QFH}
\hat{H}=i\sum_{i,j=1}^{N}\left(h^{xx}_{i,j} x_i x_j +h^{pp}_{i,j} p_i p_j +h^{xp}_{i,j} x_i p_j +h^{px}_{i,j} p_i x_j\right)  =i\vec{r}^{\dagger}h\vec{r},%= \frac{1}{2}\left(\vec{\alpha}^{\dagger}\Omega^{\dagger}\right)\Omega H_{a}\Omega^{\dagger}\left(\Omega\vec{\alpha}\right)
\end{equation}
%
where
\begin{equation}
\label{eq:Majorana-QFH-ih}
i h=\Omega H\Omega^{\dagger}=i \left(\begin{array}{cc}
\{A+B\} & \Re\{A+B\}\\
\Re\{B-A\} & \Im\{A-B\}
\end{array}\right)=i \left(\begin{array}{cc}
h^{xx} &h^{xp}\\
h^{px} & h^{pp}
\end{array}\right).
\end{equation}
Where $\Im\{ \cdot \}$ and $\Re\{ \cdot \}$ are respectively the imaginary and the real part of their argument.\\
Using the properties of matrices $A$ and $B$, it is easy to see that matrix $h$ is real and skew-symmetric.\\
%


%%Diagonalisation
\section{Diagonalisation}
\subsection{Hamiltonian diagonal form with Dirac operators}
\label{Diag-Ham-Dirac}
Given a particular f.q.h. $\hat{H}$ in the general form \eqref{eq:Dirac-QFH} it is always possible to find a new set of Dirac operators $\{b_k\}_{k=1}^N$ such that $\hat{H}$ in terms of $\{b_k\}_{k=1}^N$  reads as
\begin{equation}
\label{eq:Dirac-QFH-FreeFree}
\hat{H} = \sum_{k=1}^{N} \epsilon_{k} (b\da_k b_k -b_k b\da_k),
\end{equation}
with $\epsilon_k \in \mathbb{R}$ for all  $k=1,2,\dots,N$ \cite{lieb1961}.
\\
We call hamiltonians in this form free-free fermion hamiltonians.
\\
In compact form
\begin{equation}
\label{eq:Dirac-QFH-FreeFree-Compact}
\hat{H} = \vec{\beta}\da H_D \vec{\beta}
\end{equation}
with
\begin{equation}
\label{eq:Diagonal-HD}
H_{D}=U\da H U =
\left(\begin{array}{cccccc}
-\epsilon_{1} & 0 & \dots &  & \dots & 0\\
0 & \ddots & \ddots &  &  & \vdots\\
\vdots & \ddots & -\epsilon_{N}\\
 &  &  & \epsilon_{1} & \ddots & \vdots\\
\vdots &  &  & \ddots & \ddots & 0\\
0 & \dots &  &  & \dots0 & \epsilon_{N}
\end{array}\right),
\end{equation}
where $U$ is the fermionic tranformation that diagonalise the hamiltonian.\\
We will always order the eigenvalues in descending order ($\epsilon_1 \geq \epsilon_2 \geq \dots \geq \epsilon_N\geq 0$).
\subsection{Hamiltonian diagonal form with Majorana operators}
In terms of Majorana operators the diagonal form of a generic f.q.h. reads as
\begin{equation}
\label{eq:Majorana-QFH-FreeFree}
\hat{H}=i\sum_{i=1}^{N}\lambda_i(\tilde{x}_{i}\tilde{p}_{i}-\tilde{p}_{i}\tilde{x}_{i}).
\end{equation}
for a set of Majorana operators $\{\tilde{x}_i\}_i$, $\{\tilde{p}_i\}_i$.
In compact form
\begin{equation}
\hat{H} = i \vec{s}\da h_D \vec{s}
\end{equation}
with
\begin{equation}
\label{eq:diagonal-Majorana-h}
 h_d =O^{T} h O =  \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix}
\end{equation}
a block diagonal matrix and $O$ the orthogonal transformation that diagonalise the hamiltonian in the Majorana operators representation .\\
%
\section{Numerical diagonalisation}
\label{sec:Numerical-diagonalisation}
As seen in section \ref{Diag-Ham-Dirac}, diagonalising a general f.q.h. $\hat{H}$ reduces to diagonalising the matrix $H$ of its compact form.\\
We are thus interested in finding the fermionic transformation $U$ that maps $H$ and the vector of Dirac operators $\vec{\alpha}$ respectively to the diagonal matrix $H_D=U\da H U$  and to the vector of Dirac operators $\vec{\beta}  = U \vec{\alpha}$ such that, in term of $\vec{\beta}$, the hamiltonian is in the diagonal form \eqref{eq:Dirac-QFH-FreeFree}.
\\
Here we focus on the numerical approach, we diagonalise the hamiltonian using standard matrix decomposition techniques. For a more physical approach we refer to \cite{lieb1961}.
\\
First step in the diagonalisation procedure is moving to the Majorana representation of $H$
\begin{align}
\hat{H} 	&  	= \vec{\alpha}^{\dagger}H\vec{\alpha}= \vec{\alpha}\da \Omega \da \Omega H\Omega\da \Omega \vec{\alpha}= \\
		&	=   i \vec{r}\da h \vec{r}.
\end{align}
The following theorem is a standard result in matrix theory \cite{zumino1962,horn1985}
%%Theorem 1
\begin{theorem}{Block diagonal form of real, skew-symmetric matrices}{Block-Matrix}
Let $h$ be $2N\times2N$ a real, skew-symmetric matrix. There exist a a real special orthogonal matrix $O$ such that
\begin{equation}
\label{eq:Schur-Decomposition}
h=O h_D O^{T},
\end{equation}
with $h_D$ a block diagonal matrix of the form
\begin{equation}
h_D = \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix}
\end{equation}
for real, positive definite $\left\{\lambda_i\right\}_{i=1,\dots,N}$.
The non-zero eigenvalues of matrix $h$ are the imaginary numbers $\{\pm \im \lambda_i\}_{i=1,\dots,N}$.
\end{theorem}

Matrix $h$ in \eqref{eq:Majorana-QFH} is real, skew-symmetric, thus, using theorem \ref{eq:Schur-Decomposition} we find the orthogonal transformation $O$ that diagonalise the matrix
\begin{align}
\hat{H} &	= i\vec{r}^{\dagger}h\vec{r} 
		= i \vec{r}^{\dagger}O O\da h O O\da \vec{r} =\\
	& 	=  i\vec{s}^{\dagger} \left( \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \lambda_i \\ -\lambda_i & 0\end{pmatrix}  \right) \vec{s} 
		=  i\vec{s}^{\dagger} h_D \vec{s} 
\end{align}

That is  $\hat{H}=i\sum_{i=0}^{N-1}\lambda_{i}(\tilde{x}_{i}\tilde{p}_{i}-\tilde{p}_{i}\tilde{x}_{i})$
 once defined the new collection of Majorana operators $\vec{s}=O\vec{r}$  as
\begin{equation}
\label{eq:Majorana-s}
\vec{s}=\left(\begin{array}{c}
\tilde{x}_{0}\\
\tilde{p}_{0}\\
\tilde{x}_{1}\\
\tilde{p}_{1}\\
\vdots\\
\tilde{x}_{N-1}\\
\tilde{p}_{N-1}
\end{array}\right).
\end{equation}
The vector of Majorana operators $\vec{s}$ has a different ordering with respect to to the vector $\vec{r}$. We call the order of the operators in $\vec{s}$ an $xp$ ordering and the ordering of the operators in $\vec{r}$ and $xx$ ordering. 
The transformation matrix $\Omega\da$ maps a vector of Majorana operators in $xx$ ordering to a vector Dirac operators, thus, before being able to move to the Dirac representation we have to reorder the element of vector $\vec{s}$. To do so we use the matrix
\begin{equation}
\label{eq:FxxTxp}
F_{xp\rightarrow xx}=\begin{array}{c}
i=0\\
i=1\\
\vdots\\
\vdots\\
i=N\\
i=N+1\\
\vdots\\
i=2N+1
\end{array}\left(\begin{array}{cccccccc}
1 & 0 & 0 & 0 & \dots & \dots & 0 & 0\\
0 & \vdots & 1 & \vdots &  &  & \vdots & \vdots\\
\vdots & \vdots & \vdots & \vdots &  &  & 0 & \vdots\\
\vdots & 0 & 0 & 0 &  &  & 1 & \vdots\\
\vdots & 1 & 0 & 0 &  &  & 0 & \vdots\\
\vdots & 0 & \vdots & 1 &  &  & \vdots & \vdots\\
\vdots & \vdots & \vdots & 0 &  &  & \vdots & 0\\
0 & 0 & 0 & \vdots & \dots & \dots & 0 & 1
\end{array}\right)
\end{equation}
 that applied to a vector $\vec{s}$ with the $xp$ ordering returns a vector $\vec{\tilde{r}}=F_{xp\rightarrow xx} \vec{s}$ with $xx$ ordering.
Mapping back to the Dirac representation we obtain the diagonal form of the hamiltonian in the Dirac operators representation as
 \begin{align}
 \hat{H} & =  i \left(\vec{s}F_{xp\rightarrow xx}^{T} \Omega \right) \left( \Omega\da F_{xp\rightarrow xx} h_D F_{xp\rightarrow xx}^{T} \Omega \right) \left( \Omega\da F_{xp\rightarrow xx} \vec{s} \right) = \\
 	&	= \sum_{k=1}^{N} \epsilon_{k} (b\da_k b_k -b_k b\da_k) = \vec{\beta}\da H_D \vec{\beta}.
 \end{align}
The fermionic transformation $U$ that diagonalise the Hamiltonian H in the form \eqref{eq:Diagonal-HD} is
\begin{equation}
U=\Omega^{\dagger}\cdot O\cdot F_{xp\rightarrow xx}^{\dagger}\cdot\Omega.
\end{equation}
We note that $\epsilon_k=\lambda_k$.
%
\begin{proposition}{\code{Diag\_h($H$)$\rightarrow  H_{D},U$}}{}
This function diagonalise $H$. $H_D$ is the diagonal form with the first half diagonal negative and the second one positive ordered as \ref{eq:Diagonal-HD}. $U$ is the fermionic transformation such that: $H=UH_{D}U\da$. \\
\end{proposition}


%%%%Block-diagonal form of real skew-symmetric matrices
\subsection{Block-diagonal form of real skew-symmetric matrices}
\label{Diag_Real_Skew}

The matrix decomposition \eqref{eq:Schur-Decomposition}  of theorem \ref{thm:Block-Matrix} is numerically obtained in $3$ steps

\begin{enumerate}

\item Compute numerically a Schur decomposition (Schur triangularisation as in  \cite{horn1985}) of the skew-symmetric matrix $h$ such that: $h=\tilde{O}\tilde{h}_D\tilde{O}^{T}$. The matrix $\tilde{h}_D$ should be a block-diagonal matrix with each block in the anti-diagonal form
\begin{equation}
\left(\begin{array}{cc}
0 & \tilde{\lambda_{i}}\\
-\tilde{\lambda_{i}} & 0
\end{array}\right),
\end{equation}
it is not guaranteed that $\tilde{\lambda_{i}}$ is positive for each $i$. It is necessary to reorder it.

\item Build the ortogonal matrix $S=\bigoplus_{i=1}^{\lfloor N/2\rfloor}{s}_{i}$ with
\begin{equation}
s_{i}=\left(\begin{array}{cc}
0 & 1\\
1 & 0
\end{array}\right)
\end{equation}
if $\tilde{\lambda_{i}}<0$ or
\begin{equation}
s_{i}=\left(\begin{array}{cc}
1 & 0\\
0 & 1
\end{array}\right),
\end{equation}
if $\tilde{\lambda_{i}}>0$.

\item The final orthogonal transformation is $O=\tilde{O}S$ such that $h=Oh_D O^{T}$.

\end{enumerate}

\begin{proposition}{\code{Diag\_real\_skew(h) $\rightarrow h_D,O$}}{}
This function implements the algorithm for the block diagonalisation of $h$ a generic skew-symmetric real matrix. $h_D$ is the block-diagonal matrix of \eqref{eq:Schur-Decomposition} and has the following property: it is in the block diagonal form, each $2\times2$ block is skew-symmetric with the upper-right element positive and real and $h_D$ is in ascending order for the upper diagonal. $O$ is an orthogonal matrix such that: $h=O h_D O^{T}$.
\end{proposition}




%
%%%%Fermionic gaussian states
\chapter{Fermionic Gaussian States}
\section{Fermionic Gaussian states}

\begin{definition}{Fermionic gaussian state}{} A state $\rho$ is a fermionic gaussian state (f.g.s.) if it can be represented as
\begin{equation}
\label{eq:definizione-1_fermionic_gaussian_state}
\rho = \frac{e^{-\hat{H}}}{Z} = \frac{e^{-\vec{\alpha}\da H \vec{\alpha}}}{Z}
\end{equation}
with $Z\coloneqq\Tr{e^{-\hat{H}}}$ a normalisation constant and $\hat{H}$ a fermionic gaussian hamiltonian called parent hamiltonian of $\rho$.\\  Every possible value of the norm of the hamiltonian is admitted, $\norm{\hat{H}}_{1}\in [0,+\infty]$. Both extremum values are reached with a single sided limit procedure in the definition of $\rho$.\\
All the information about the state is encoded in the $2N\times 2N$ matrix $h$ at the exponential.
\end{definition}
Fermionic gaussian states have an immediate interpretation as thermal Gibbs state of f.q.h.. One can even rescale the parent hamiltonian as $\hat{\tilde{H}}=\frac{1}{\beta}\hat{H}$ such that $\norm{\hat{\tilde{H}}}=1$ and $\beta=\frac{1}{\norm{\hat{H}}}$. In this way the state reads as $\rho=\frac{e^{-i\beta \hat{\tilde{H}}}}{Z}$ with $\beta\in [0,+\infty]$.
Since f.g.s are exponential of f.g.h. and f.g.h. are even operator, it follows that f.g.s are even operator.
%%Bravyi2004 definisce anche GAUSSIANI ODD, perÃ² fa vedere che questi sono sempre riconducibili a Gaussiani even aumentando di uno modo il sistema, quindi guassiani even vanno bene per tutto.


\subsection{Single mode Gaussian states}
Consider the single mode parent hamiltonian $\hat{H}_1=\epsilon(b\da b -b b\da)$ of the f.g.s. $\rho=\frac{1}{Z}e^{-\hat{H}_1}$. The explicit representation of $\rho$ on the basis $\{|0\rangle, b\da|0\rangle\}$ is 
\begin{equation}
\rho = \begin{pmatrix}
	1-f & 0 \\
	0 & f
\end{pmatrix}
\end{equation}
where $f=\langle 0| \rho | 0 \rangle$ and the two coherences are $0$ because we cannot have the odd terms $|0\rangle \langle 1 |$ and $|1\rangle \langle 0|$ in the expansion of the even operator $\rho$. Using the polynomial expansion \eqref{eq:polynomial-representantion-|x><x|} we can see that $f=\Tr{\rho b\da b}\coloneqq \langle b\da b\rangle$, that is the occupation of the mode fermionic mode, thus a single mode gaussian state is completely characterised by the occupation $\langle b\da b\rangle$.


\section{Correlation Matrix}
\label{sec:Correlation-Matrix}
We have seen that for any f.q.h. $H$ it is always possible to find a fermionic transformation $U$ that diagonalise $H$ transforming the Dirac operators vector as $\vec{\beta}=U\vec{\alpha}$. Diagonalising the parent hamiltonian of a f.g.s. $\rho$ we obtain its decomposition in terms of single-mode thermal states
\begin{equation}
\rho = \frac{e^{-\vec{\beta}\da H_D \vec{\beta}}}{Z} = \frac{1}{Z}\bigotimes_{k=1}^{N}e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)} =\bigotimes_{k=1}^{N}\frac{e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}}{Z_k},
\end{equation}
where $Z_k = \Tr{e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}}$.\\
%To the fermionic transformation $U$ corresponds a unitary operation $U_{\rho}$ on the Hilbert space of $\rho$ such that 
%\begin{equation}
%\rho = U_{\rho}\bigotimes_{k=1}^{N}\frac{e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}}{Z_k} U_{\rho}\da.
%\end{equation}
Each single-mode thermal state is completely characterised by its occupation number, thus $\rho$ is completely characterised by the set of occupations $\{\langle b\da_{i} b\rangle\}_{i=1}^{N}$.
Expressing the occupations in term of the operators $\vec{\alpha}=U\da \vec{\beta}$, we find that every f.g.s. is \textit{completely characterised} by the collection of all the correlators $\Gamma^{a\da a}_{i,j} \coloneqq \langle a\da_i a_j \rangle$ and $\Gamma^{aa}_{i,j} \coloneqq  \langle a_i a_j \rangle$. We collect these correlators in the so called \textit{correlation matrix}
\begin{equation}
\label{eq:Majorana}
\Gamma \coloneqq \langle \vec{\alpha} \vec{\alpha}  \da \rangle= \begin{pmatrix}
\Gamma^{a\da a} & \Gamma^{a\da a\da} \\
\Gamma^{aa} & \Gamma^{a a\da}
\end{pmatrix} 
\end{equation}
with $\Gamma^{aa}_{i,j} \coloneqq \langle a_i a_j\rangle=-\overline{\Gamma^{a\da a\da}_{i,j}}$ and $\Gamma^{a a\da}_{i,j} \coloneqq \langle a_i a\da_j \rangle =(\overline{ \id - \Gamma^{a\da a}})^{T}_{i,j}$, where $\overline{A}$ is the conjugate of $A$.
The correlation matrix $\Gamma$ is hermitian, $\Gamma^{aa}$ and $\Gamma^{a \da a \da}$ are skew-symmetric, and $\Gamma^{a\da a}$ and $\Gamma^{a a\da}$ are hermitian.\\
Expressed in term of Majorana operator the correlation matrix is defined as 
\begin{equation}
\label{eq:Majorana-Gamma}
{\Gamma}^{maj} \coloneqq \langle  \vec{r} \vec{r} \da \rangle = \Omega \Gamma \Omega\da.
\end{equation}
\\
It interesting observing that, since a f.g.s. is completely described by its correlation matrix, with the spirit of the maximum entropy principle (see \cite{jaynes1957a, jaynes1957}), it is possible to equivalently define fermionic gaussian states as the states that maximise	the von Neumann entropy	given the expectation values collected in the correlation matrix. 



\section{Covariance matrix}
The \textit{covariance matrix} of a f.g.s. is the real, skew-symmetric matrix defined as
\begin{equation}
\gamma \coloneqq \im Tr\left[\rho[\vec{r}_{i},\vec{r}_{j}]\right],
\end{equation}
with $[\vec{r}_{i},\vec{r}_{j}]$ the commutator of the two Majorana operators $\vec{r}_{i}$ and $\vec{r}_{j}$.
\\
As for the correlation matrix, the covariance matrix of a f.g.s $\rho$ completely describes the states. In fact  $\gamma$ and $\Gamma$ are related by the equality
\begin{equation}
\gamma	=-\im \Omega\left(2\Gamma -\mathbb{I}\right)\Omega^\dag=-\im\left(2\Gamma^{maj}-\mathbb{I}\right).
\end{equation}
In this text we will use both the covariance matrix and the correlation matrix approach.

\section{Wick's theorem} 
As mentioned, f.g.s. are fully characterised by their covariance matrix. This means that it must be possible to obtain the expectation value of every operator $X$ from $\gamma$ solely. To do so we just need to take the polynomial expansion \eqref{eq:Polynomial-Expansion-Clifford} of $X$ and apply the celebrated Wick's theorem \cite{molinari2017} to each monomial term.
The Wick's theorem states that for a f.g.s. $\rho$ and a monomial of Majorana operators $r_{q_1}r_{q_2}\dots r_{q_p}$ one has
\begin{equation}
\Tr{\rho r_{q_1}r_{q_2}\dots r_{q_p}} = \text{Pf}(\gamma_{|_{q_1,q_2,...,q_p}})
\end{equation} 
where $1\leq q_1 < q_2<\dots <q_p \leq 2N$, $\gamma_{|_{q_1,q_2,...,q_p}}$ is the restriction of the covariance matrix to all the two point correlators involving just the Majorana operators $\{r_{q_1},r_{q_2},\dots,r_{q_p}\}$ and $\text{Pf}()$ is called the Pfaffian.
Since the Pfaffian is nonvanishing  only for $2N\times2N$ skew-symmetric matrix, it is clear that the expectation value of any odd operators is always zero.

\begin{example}
Consider a system composed by $2$ fermionic modes corresponding to the Dirac operators $a_1$ and $a_2$.
The Majorana operators vector is $\vec{r}=(r_1,r_2,r_3,r_4)$ , thus the covariance matrix takes the form
\begin{equation}
\gamma = 
\begin{pmatrix}
0 & \langle r_1, r_2  \rangle & \langle r_1, r_3  \rangle & \langle r_1, r_4  \rangle \\
-\langle r_1, r_2  \rangle & 0 & \langle r_2, r_3  \rangle & \langle r_2, r_4  \rangle \\
-\langle r_1, r_3  \rangle & -\langle r_2, r_3  \rangle & 0  & \langle r_3, r_4  \rangle \\
-\langle r_1, r_4  \rangle & -\langle r_2, r_4  \rangle & -\langle r_3, r_4  \rangle & 0 \\
\end{pmatrix}
\end{equation}
\end{example}
where $\langle r_i, r_j  \rangle \coloneqq \im \Tr{\rho [r_i, r_j] }$.
Using Wick's theorem we have that
\begin{align}
\Tr{\rho r_1 r_2 r_3 r_4}  & = \text{Pf}\begin{pmatrix}
0 & \langle r_1, r_2  \rangle & \langle r_1, r_3  \rangle & \langle r_1, r_4  \rangle \\
-\langle r_1, r_2  \rangle & 0 & \langle r_2, r_3  \rangle & \langle r_2, r_4  \rangle \\
-\langle r_1, r_3  \rangle & -\langle r_2, r_3  \rangle & 0  & \langle r_3, r_4  \rangle \\
-\langle r_1, r_4  \rangle & -\langle r_2, r_4  \rangle & -\langle r_3, r_4  \rangle & 0 \\
\end{pmatrix}=\\
&= \langle r_1, r_2  \rangle \langle r_3, r_4  \rangle -\langle r_1, r_3 \rangle \langle r_2, r_4  \rangle +\langle r_2, r_3  \rangle \langle r_1, r_4  \rangle ,
\end{align}
and
\begin{equation}
\Tr{\rho r_2r_4} = \text{Pf}
\begin{pmatrix}
0  & \langle r_2, r_4  \rangle  \\
-\langle r_2, r_4  \rangle & 0
\end{pmatrix}= \langle r_2, r_4  \rangle ,
\end{equation}
and 
\begin{equation}
\Tr{\rho r_1 r_2 r_4}  = \text{Pf}\begin{pmatrix}
0 & \langle r_1, r_2  \rangle & \langle r_1, r_4  \rangle  \\
-\langle r_1, r_2  \rangle & 0 & \langle r_2, r_4  \rangle  \\
-\langle r_1, r_4  \rangle & -\langle r_2, r_4  \rangle & 0   
\end{pmatrix}=0.
\end{equation}
%If we consider the Dirac representation of the correlation matrix $\tilde{\Gamma}=\Gamma-\frac{1}{2}\mathbb{I}$, moving to the Majorana representation we obtain the skew-symmetric matrix (analogous of $ih$)
%\begin{equation}
%i\gamma\equiv\Omega\tilde{\Gamma}\Omega^{\dagger}=\Gamma^{maj}-\frac{1}{2}\mathbb{I}=\frac{1}{2}Tr\left[\rho\left[\vec{r}_{i},\vec{r}_{j}\right]\right]
%\end{equation}
%
%
%where in the last equality we just used the fact that $ Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=Tr\left[\rho\vec{r}_{j}\vec{r}_{i}\right]$ if $i\neq j$, and $Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=\frac{1}{2}$ if $i=j$ thus taking the anticommutator and dividing by $2$ just removes the constant diagonal.
%
%At any time we can change representation with this transformations
%
%
%Someone refers to $\gamma$ as skew-symmetrised correlation matrix, someone else as covariance matrix. I will call it $\gamma$ or skew-symmetrised correlation matrix.



%\section{Standard form}
%La metto la standard form? pagina 67 del quaderno Legami

\section{Diagonalisation of the correlation matrix}
In section \ref{sec:Correlation-Matrix} we have seen that for any f.g.s. $\rho$  there exist a fermionic transformation $U$ that diagonalise its parent hamiltonian
% and thus a unitary operator $U_{\rho}$ that diagonalise the density matrix $\rho$
. With the new Dirac operators $\vec{\beta}$ the state can be expressed as a tensor product of single mode thermal states 
\begin{equation}
 \frac{e^{-\vec{\beta}\da H_D \vec{\beta}}}{Z} =\frac{1}{Z}\bigotimes_{k=1}^{N}e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}=\bigotimes_{k=1}^{N}\frac{e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}}{Z_k}.
\end{equation}
with $Z_k=\Tr{e^{-i  \epsilon_{k} (b\da_k b_k -b_k b\da_k)}}$.\\
Expressed with these operators the correlation matrix is diagonal. If we consider the Fock basis $\{|\vec{k}\rangle\}_{\vec{k}\in\{0,1\}^N}$ built with the action of the operators $\vec{\beta}$ on $|0\rangle$, we have that in this basis $\rho$ assumes a diagonal form. We call $U_{\rho}$ the unitary transformation that moves from the basis $\{|\vec{x}\rangle\}_{\vec{x}\in\{0,1\}^N}$ to the one of the modes $\{|\vec{k}\rangle\}_{\vec{k}\in\{0,1\}^N}$. \\
It is easy to see that expressed on this basis $\rho$ has the diagonal form
\begin{equation}
\label{eq:Diagona-Correlation-Matrix}
\rho^D = U_{\rho}\da \rho U_{\rho}=\bigotimes_{i=1}^{N}\left(\begin{array}{cc}
\nu_{i} & 0\\
0 & 1-\nu_{i}
\end{array}\right).
\end{equation}
The same fermionic transformation $U$ that diagonalise the parent hamiltonian brings $\Gamma$ in the diagonal form
\begin{equation}
\Gamma^D = U\da \Gamma U = 
\left(\begin{array}{cccccc}
\nu_{1} & 0 & \dots &  & \dots & 0\\
0 & \ddots & \ddots &  &  & \vdots\\
\vdots & \ddots & \nu_{N}\\
 &  &  & 1-\nu_{1} & \ddots & \vdots\\
\vdots &  &  & \ddots & \ddots & 0\\
0 & \dots &  &  & \dots0 & 1-\nu_{N}
\end{array}\right),
\end{equation}
with $\nu_i \in [0,1]$ the occupation number of the $i$-th free mode.
To numerically obtain the diagonal form of the correlation matrix we notice that the covariance matrix $\gamma$ is a real, skew-symmetric matrix, thus using theorem \ref{thm:Block-Matrix} we know that we can find an orthogonal transformation $O$ such that
\begin{equation}
\gamma = O \gamma^D O^{T} =  O \left(  \bigoplus_{i=1}^{N} \begin{pmatrix}0 & \eta_i \\ -\eta_i & 0\end{pmatrix}  \right) O^{T} 
\end{equation}
with $\eta_i \in [-\frac{1}{2},\frac{1}{2}]$.\\
Following the same procedure of section \ref{sec:Numerical-diagonalisation}, we can write the diagonal elements of $\Gamma^D$ as
\begin{equation}
\nu_i = \frac{1}{2}-\eta_i.
\end{equation}
The elements of  $H_D$ and $\Gamma^D$  are related as
\begin{align}
\epsilon_k =\frac{1}{2} \ln \left(\frac{1-\nu_k}{\nu_k} \right),\\
\nu_k = \frac{1}{1+e^{2\epsilon_k}}
\end{align}
with $\nu_k\in[0,1]$ and $\epsilon_k\in[-\infty,+\infty]$ where the boundary values are take with a limit. The complete calculation can be found in appendix \ref{appendix:Eigenvalues-Relations}.
In \ref{eq:Diagonal-HD} we defined all the $\epsilon_k$ to be positive, to use the same notation, one just has to exchange $b$ with $\tilde{b}\da$ and $b\da$ with $\tilde{b}$, that is exchanging occupations with vacancies for the mode with $\epsilon_k$ negative. This corresponds to switching $\nu_k$ with $1-\tilde{\nu}_k$ and $1-\nu_k$ with $\tilde{\nu}_k$.\\ 
In general the correlation matrix $\Gamma$ and the parent hamiltonian $H$ are related as \cite{peschel2003a,vidal2003,cheong2003,zhang2020}
\begin{equation}
\Gamma = \frac{1}{1+e^{2H}}.
\end{equation}
\begin{proposition}{\code{Diag\_gamma($\Gamma$)$\rightarrow  \Gamma^D, U$}}{}
This function returns $\Gamma^D$, the the diagonal form of the Dirac correlation matrix $\Gamma$ and $U$ the fermionic transformation such that $\Gamma=U \Gamma^D U\dag $.
\end{proposition}


\subsubsection{Phisicality of a state}
It is known that a matrix $\rho$, represent a valid physical density matrix if it is a positive semi-definite hermitian matrix with trace one. 
The condition for a matrix $\Gamma$ to represent a valid physical correlation matrix of a f.g.s. is
\begin{equation}
\Gamma^2-\Gamma \leq 0,
\end{equation}
or equivalently
\begin{equation}
\gamma\gamma\da \leq -\id.
\end{equation}
These conditions are equivalent to asking that the eigenvalues $\nu_i$ of matrix $\Gamma$ belongs all to the interval $[0,1]$.

\subsubsection{Ground states of fermionic quadratic hamiltonians}
Suppose we have a f.q.h. $H$  and we are interest in obtaining the correlation matrix $\Gamma_0$ associated to its ground state $|0\rangle$. 
In order to obtain $\Gamma_0$ we proceed by first finding the fermionic transformation $U$ that diagonalise $H$. Since our algorithm associates to each free mode of the diagonalised hamiltonian a positive energy, in the diagonal basis the ground state is $|0\rangle \langle 0|$.
The correlation matrix associated to the state $|0\rangle$ is the block matrix:
\begin{equation}
\Gamma_{ |0\rangle \langle 0|}=
\begin{pmatrix}
0 & 0\\
0 & \id_{N \times N} 
\end{pmatrix}.
\end{equation}
To obtain the ground state $\Gamma_0$ we just need to move back to the original basis, thus
\begin{equation}
\Gamma_0 = U \Gamma_{|0\rangle \langle 0|} U\da.
\end{equation}
\begin{proposition}{\code{GS\_gamma($H_D,U$)$\rightarrow  \Gamma_0$}}{}
This function returns $\Gamma_0$, the ground state of the hamiltonian $H=UH_DU\da$.
\end{proposition}


\subsubsection{Thermal state of fermionic quadratic hamiltonians}
Suppose we have a f.q.h. $H$  and we are interest in obtaining the correlation matrix $\Gamma_0$ associated to the thermal state $\rho_\beta = \frac{e^{-\beta H}}{\Tr{e^{-\beta H}}}$. 

As we did for computing the ground state, we move to the diagonal basis with the fermionic transformation $U$.
In the diagonal basis the thermal state has the correlation matrix 
\begin{equation}
\Gamma_{\beta}^D = \begin{pmatrix}
\frac{1}{1+e^{2\beta \epsilon_1}} & 0 & \dots &  & \dots & 0\\
0 & \ddots & \ddots &  &  & \vdots\\
\vdots & \ddots & \frac{1}{1+e^{2\beta \epsilon_N}} \\
 &  &  & \frac{1}{1+e^{-2\beta \epsilon_1}}  & \ddots & \vdots\\
\vdots &  &  & \ddots & \ddots & 0\\
0 & \dots &  &  & \dots0 & \frac{1}{1+e^{-2\beta \epsilon_N}} 
\end{pmatrix}.
\end{equation}
To obtain the thermal state $\Gamma_{\beta}$ we just need to move back to the original basis, thus
\begin{equation}
\Gamma_{\beta} = U \Gamma_{\beta}^D U\da.
\end{equation}
\begin{proposition}{\code{Thermal\_fix\_beta($H_D,U,\beta$)$\rightarrow  \Gamma_0$}}{}
This function returns $\Gamma_{\beta}$, the termal state at inverse temperature $\beta$ of the hamiltonian $H=UH_DU\da$.
\end{proposition}
\begin{proposition}{\code{Thermal\_fix\_energy($H_D,U,E$)$\rightarrow  \Gamma_{\beta(E)}, \beta(E), \Delta(E)$}}{}
This function variationally computes and then returns $\Gamma_{\beta(E)}$, the thermal state at inverse temperature $\beta(E)$ of the hamiltonian $H=UH_DU\da$, and $\beta(E)$ the temperature such that $\Tr{\rho_{\beta(E)}H}=E$ and $\Delta(E)$ the difference between the required energy $E$ and the actual energy of the state $\Gamma_{\beta(E)}$.
It prints in the terminal the precision $\Delta(E)$ and $\beta(E)$.
\end{proposition}

\subsubsection{Energy of a fermionic gaussian state}
Consider a  f.q.h $H$ and a f.g.s. $\Gamma$. The energy of $\Gamma$ with respect to $H$ is the expectation value $\Tr{\hat{H}\rho}$ of the associated $\hat{H}$ computed on the associated state $\rho$.  \\
In order to compute this expectation value one just need to find the fermionic transformation $U$ that diagonalises $H$ and compute the energies $\epsilon_k$ the occupations $\langle b_k\da, b_k\rangle$ and $\langle b_k, b_k\da\rangle$. The correlation matrix $\Gamma$ is not diagonal in the diagonal basis $\vec{\beta}$ of $H$, but we are just interested in its diagonal elements.\\
The energy $E_{H}(\Gamma)$ of $\Gamma$ is thus
\begin{equation}
E_{H}(\Gamma) =  \sum_{k} \epsilon_k(\langle b_k\da b_k \rangle - \langle b_k b_k\da \rangle).
\end{equation}

\begin{proposition}{\code{Energy($\Gamma,H_D,U$)$\rightarrow E_{H}(\Gamma)$}}{}
This function returns $E_{H}(\Gamma)$ the energy of the state $\Gamma$ calculated with $H$. Matrices $H_D$ and $U$ are the output of \code{Diag\_h(H)}.
\end{proposition}

%%%%Eigenvalues of rho and gamma
\section{Eigenvalues of $\rho$ and eigenvalues of $\Gamma$}
We have seen that the diagonal forms of the correlation matrix $\Gamma$ and of the density matrix $\rho$ of a f.g.s. can be obtained respectively with a fermionic transformation $U$ and a unitary operation $U_{\rho}$.
The Fock basis in which $\rho$ is diagonal is the one generated by the set of operators that expresses $\Gamma$ in diagonal form. \\
In this two basis $\rho$ and $\Gamma$ assume the forms
\begin{equation}
 \label{eq:Rho_Gaussian_State}
\Gamma^D = 
\left(\begin{array}{cccccc}
\nu_{1} & 0 & \dots &  & \dots & 0\\
0 & \ddots & \ddots &  &  & \vdots\\
\vdots & \ddots & \nu_{N}\\
 &  &  & 1-\nu_{1} & \ddots & \vdots\\
\vdots &  &  & \ddots & \ddots & 0\\
0 & \dots &  &  & \dots0 & 1-\nu_{N}
\end{array}\right), \qquad 
\rho^D=\bigotimes_{k=1}^{N}\left(\begin{array}{cc}
\nu_{k} & 0\\
0 & 1-\nu_{k}
\end{array}\right) = \left(\begin{array}{cccccc}
\pi_{\vec{0}} & 0&  \dots \\
0 & \ddots &  \vdots\\
\vdots &  \dots&  \pi_{\vec{1}}
\end{array}\right).
\end{equation}
%
Thus the if we denote each of the $2^{N}$ eigenvalues $\pi_{\vec{x}}$ of $\rho$ with a binary string $\vec{x}\in\left\{ 0,1\right\} ^{N}$ we have that: $\pi_{\vec{x}}=\prod_{k=1}^{N}\left(\vec{x}_{k}\nu_{i}+(1-\vec{x}_{k})(1-\nu_{k})\right)$.\\
It is evocative changing the order of the Dirac operators in the representation of $\Gamma^D$
\begin{equation}
\label{eq:Ordering_dada_ndnd}
\vec{\beta}=\left(\begin{array}{c}
b_{0}^{\dagger}\\
\vdots\\
b_{N-1}^{\dagger}\\
b_{0}\\
\vdots\\
b_{N-1}
\end{array}\right) \qquad \rightarrow \qquad 
\vec{\tilde{\beta}}=\left(\begin{array}{c}
b_{0}^{\dagger}\\
b_{0}\\
b_{1}\da\\
b_{1}\\
\vdots\\
b_{N}\da\\
b_{N}
\end{array}\right),
\end{equation}
this can be easily done with the fermionic transformation $\tilde{\Gamma}^D = F_{xp\rightarrow xx}\da \Gamma^D F_{xp\rightarrow xx}$.
With this ordering we have
\begin{equation}
 \label{eq:Rho_Gaussian_State}
\tilde{\Gamma}^D=\bigoplus _{k=1}^{N}\left(\begin{array}{cc}
\nu_{k} & 0\\
0 & 1-\nu_{k}
\end{array}\right),\qquad 
\rho^D=\bigotimes_{k=1}^{N}\left(\begin{array}{cc}
\nu_{k} & 0\\
0 & 1-\nu_{k}
\end{array}\right).
\end{equation}

\begin{proposition}{\code{Eigenvalues\_of\_rho($\Gamma$)}$\rightarrow\vec{\nu}$}{}
This function return the eigenvalues of the correlation matrix $\rho$ associated to the fermionic gaussian state with Dirac correlation matrix $\Gamma$. 
\end{proposition}



%%%%Reduced density matrix
\section{Reduced density matrix and tensor product of fermionic gaussian states}
\label{sec:Reducede-Density-Matrix}
Trying to define a partial trace over fermionic modes subspaces one soon faces the what is often called the "partial trace ambiguity" \cite{friis2013}.\\
%
In the case of fermionic gaussian states, though, this is a much simpler task. Any reduced state formalism has to satisfy the simple criterion that the reduced density operator contains all the information about the subsystem that can be obtained from the global state when measurements are performed only on the respective subsystem alone \cite{friis2013}.\\
%
With Wick's theorem in mind it is easy to see that the correlation matrix of the reduced state on the modes ${i_1,\dots,i_m}$ is just the correlation matrix  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$ and that the reduced state of a f.g.s. is a f.g.s. too.\\


\begin{proposition}{ \code{Reduce\_gamma($\Gamma$,m,i\_1)}$\rightarrow  \left.\Gamma \right|_{\{i_1,\dots,i_m\}}$}{}
This function takes a Dirac correlation matrix $\Gamma$, a dimension of the partition $m$ and the initial site of the partition $i_1$ and return  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$, the reduced correlation matrix on the contiguous modes $\{i_1,\dots,i_m\}$.\\
 Examples: the the green the element of the matrix $M_{6\times6}$ are the one of returned by the function.
\begin{equation}
\mbox{\mbox{Reduce\_gamma}(\ensuremath{M_{6\times6}},2,1)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}
\end{array}\mbox{Reduce\_gamma(\ensuremath{M_{6\times6}},2,3)\ensuremath{\rightarrow}}\begin{array}{cccccc}
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{green} & \cellcolor{blue} & \cellcolor{green} & \cellcolor{green} & \cellcolor{blue} & \cellcolor{green}
\end{array}
\end{equation}
\end{proposition}

The correlation matrix $\Gamma_{A,B}$ of the tensor product of two f.g.s. $\Gamma_A$ and $\Gamma_B$ is obtained simply by collecting all the elements of $\Gamma_{A}$ and $\Gamma_{B}$ in a single well ordered correlation matrix $\Gamma_{A,B}$.
The code for obtaining $\Gamma_{A,B}$ from $\Gamma_A$ and $\Gamma_B$ is
\lstinputlisting{JL_composition.jl}.
This code makes use of the function \code{Inject\_gamma}.


\begin{proposition}{ \code{Inject\_gamma($\Gamma$, $\Gamma_{inj}$, i)}$\rightarrow  {\Gamma_{comp}} $}{}
This function takes a $2N\times2N$ matrix $\Gamma$    and a $2n\times 2n$ matrix $\Gamma_{inj}$ with $n\leq N$. It returns the $2N\times 2N$ matrix $\Gamma_{comp}$ as shown in the pictures. 
\begin{equation*}
\Gamma=\begin{array}{cccccc}
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}
\end{array},\qquad
\Gamma_{inj}=\begin{array}{cccc}
\cellcolor{red} & \cellcolor{red} & \cellcolor{red} & \cellcolor{red} \\
\cellcolor{red} & \cellcolor{red} & \cellcolor{red} & \cellcolor{red} \\
\cellcolor{red} & \cellcolor{red} & \cellcolor{red} & \cellcolor{red} \\
\cellcolor{red} & \cellcolor{red} & \cellcolor{red} & \cellcolor{red} 
\end{array}
\end{equation*}

\begin{equation}
\mbox{\code{Inject\_gamma(}}\Gamma,\Gamma_{inj},\mbox{1)}\rightarrow \begin{array}{cccccc}
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}
\end{array}, \mbox{ }
\mbox{\code{Inject\_gamma(}}\Gamma,\Gamma_{inj},\mbox{3)}\rightarrow \begin{array}{cccccc}
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}\\
\cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue} & \cellcolor{blue}\\
\cellcolor{red} & \cellcolor{blue} & \cellcolor{red} & \cellcolor{red} & \cellcolor{blue} & \cellcolor{red}
\end{array}.
\end{equation}
In the last example it is clear the systems behave with periodic boundary conditions.\\
If $\Gamma$ is the correlation matrix of a f.g.s $\rho$ and $\Gamma_{inj}$ is the correlation matrix of a f.g.s $\rho_{inj}$ then $\Gamma_{comp}$ is the correlation matrix of the state $\mbox{Tr}_{\mbox{\code{i}},\dots,\mbox{\code{i+n-1}}}\left[\rho\right]\otimes\rho_{inj}$.
\end{proposition}

It is clear that with the ordering \ref{eq:Ordering_dada_ndnd}, the tensor product of two f.g.s. corresponds to the direct sum of their correlation matrices
\begin{equation}
\rho_{A,B} = \rho_{A}\otimes \rho_{B} \mbox{ } \rightarrow \mbox{ } \tilde{\Gamma}_{A,B} = \tilde{\Gamma}_{A} \oplus \tilde{\Gamma}_{B}.
\end{equation}


\section{Product Rule}
\label{sec:Product-Rule}
It will result useful to compute the product $\rho=\rho_1 \rho_2$ of the density matrices of two fermionic gaussian states.
We observe that the commutator of two quadratic terms of Majorana operators $\vec{r}$ is always again a quadratic operator or zero
\begin{equation}
[r_i r_j,r_k r_l] = \delta_{k,i} r_l r_j+\delta_{k,j} r_i r_l-\delta_{i,l} r_k r_j-\delta_{l,j} r_i r_k.
\end{equation}
This is also valid for Dirac operators. We say that the commutator of two monomial of Dirac operator of degree at most $2$ is a polynomial of Dirac operators of degree at most $2$.
Using this observation together with the Baker-Campbell-Hausdorff formula ( equation B.C.H.0 in appendix \ref{appendix:Formulas}), it is easy to see that $\rho$, the product of two f.g.s., is always a f.g.s. 
\begin{equation}
\rho = \frac{e^{-\hat{H}}}{Z},
\end{equation}
with $\hat{H}$ given by the B.C.H.0.\\
It is possible to derive the covariance matrix $\gamma$ of $\rho$ directly from the covariance matrices $\gamma_1$ and $\gamma_2$ of the states $\rho_1$ and $\rho_2$.
This formula appears in \cite{fagotti2010} where a more detailed description, considering even pathological cases, is given. If we assume that $\id-\gamma_1$ and $\id-\gamma_2$ are invertible than we have
\begin{equation}
\gamma = \id-(\id-\gamma_2)\frac{1}{\id+\gamma_1 \gamma_2} (\id-\gamma_1).
\end{equation}
\begin{proposition}{\code{Product($\Gamma_1,\Gamma_2$)}$\rightarrow \Gamma$}{}
This function return the correlation matrix $\Gamma$ corresponding to the f.g.s $\rho=\rho_1 \rho_2$, where $\rho_1$ and $\rho_2$ are characterised by the correlation matrices $\Gamma_1$ and $\Gamma_2$. 
\end{proposition}



%%%%Information measures
\section{Information measures}
%%%%Von Neumann Entropies
\subsection{Von Neumann Entropies}
The Von Neumann entropy of a quantum state described by the density matrix $\rho$ is
\begin{equation}
\label{eq:General_VonNeumann_Entropy}
S(\rho) = -\Tr{\rho\ln(\rho)}.
\end{equation}
In terms of the eigenvalues $\lambda$ of $\rho$, the Von Neumann entropy read as
\begin{equation}
S(\rho) = -\sum_{\lambda} \lambda \ln(\lambda)
\end{equation}
If $\rho$ is a f.g.s. of a system with $N$ sites, since the VonNeumann entropy is invariant under unitary transformation of the state, substituting in \eqref{eq:General_VonNeumann_Entropy} the product form \eqref{eq:Rho_Gaussian_State} and using the fact the the VonNeumann entropy is additive for product states, the VonNeumann entropy becomes a function of the eigenvalues $\nu_i$ of the correlation matrix $\Gamma$ and it is the sum of just $2N$ terms
\begin{equation}
S(\Gamma) \equiv S(\rho) = -\sum_{k=1}^{N} \left[\nu_k \ln(\nu_k)+(1-\nu_k) \ln(1-\nu_k) \right].
\end{equation}

\begin{proposition}{\code{VN\_entropy($\Gamma$)}$\rightarrow S$}{}
This function return $S$, the \code{Float64} value of the Von Neumann Entropy of the state described by the Dirac correlation matrix $\Gamma$.
\end{proposition}

%%%%Purity
\subsection{Purity}
A state is pure if its correlation matrix $\Gamma$ is such that \cite{bach1994a}
\begin{equation}
\Gamma^2 = \Gamma,
\end{equation}
or, equivalently,
\begin{equation}
\gamma^2 =-\id
\end{equation}
The purity of a state $\rho$ is defined as
\begin{equation}
\mbox{Purity}(\rho)\equiv Tr\left[\rho^{2}\right].
\end{equation}
We have that:
\begin{equation}
\mbox{Purity}(\rho)=\prod_{i=1}^{N-1}\frac{1}{2}\left(1+\tanh(x)^2\right),
\end{equation}

\begin{equation}
\mbox{Purity}(\Gamma)=\prod_{i=1}^{N-1}(2\left(\nu_{i}-1\right)\nu_{i}+1),
\end{equation}

\begin{equation}
\mbox{Purity}(\gamma)=\prod_{i=1}^{N-1}\left(2\eta_{i}^{2}+\frac{1}{2}\right).
\end{equation}

For more details see appendix \ref{appendix:Purity}.

\begin{proposition}{\code{Purity($\Gamma$)$\rightarrow  p$}}{}
This function return $p$ the purity of the fermionic gaussian state with Dirac correlation matrix $\Gamma$.
\end{proposition}

%%%%Entanglement Contour
\subsection{Entanglement Contour}
In 2014 Chen and Vidal \cite{chen2014} introduced entanglement contour "a tool for identifyng which real-space degrees of freedom contribute, and how much, to the entanglement of a region A with the rest of the system B". 
We consider the state of a system on a chain of $N$ sites, we divide the chain in two complementary partitions, partition $A$ and partition $B$. Now suppose partition $A$ and $B$ are entangled and there exists a measure $\mathcal{E}(A,B)$ that quantifies the amount of entanglement between $A$ and $B$. The entanglement contour $c_A(i)$ of partition $A$ tells us how much each site $i$ of partition $A$ contributes to the total amount of entanglement betwen $A$ and $B$. Furthermore summing $c_A(i)$ over all the sites of $A$ one should obtain exactly $\mathcal{E}(A,B)$. \\
Chen and Vidal decide five reasonably properties that define when a function is a contour function. In the same paper they show that these five properties do note define a single contour function, but instead a class of functions.
We will present here a specific form of entanglement contour, the one introduced by Chen and Vidal for fermionic gaussian states, for other kinds of contour function see i.e. \cite{coser2017,tonni2018}. \\
First of all we restrict to pure states. For pure state it is known that a good measure of entanglement between two complementary partition $A$ and $B$ is the entanglement entropy, that is the VonNeumann entropy $\mathcal{E}(A,B)=S(A)$ of the reduced state on $A$.\\
We consider an Hilbert space $\mathcal{H}$ arbitrarily divided in the two complementary partitions $\mathcal{H}= \mathcal{H}_A\otimes \mathcal{H}_B$, each partition with $N_A$ and $N_B$ sites respectively. The Schmidt decomposition of a pure state $|\psi^{A,B}\rangle$ in $\mathcal{H}$ is
\begin{equation}
\label{eq:Schmidt-Decomposition}
|\psi^{A,B}\rangle = \sum_{i} \sqrt{p_i}|\psi^{A}_i\rangle \otimes |\psi^B_i\rangle,
\end{equation}
with $p_i\geq0$, $\sum_{i} p_i = 1$ and
\begin{equation}
\rho^{A}\equiv Tr_{B}\left[ |\psi^{A,B}\rangle \langle \psi^{A,B}|\right] = \sum_{i} p_i |\psi^{A}_i \rangle \langle \psi^{A}_i|.
\end{equation}
The entanglement entropy for this choice of partition is thus $S(A)= -\sum_{i} p_i ln(p_i)$.\\
Factorising the Hilbert space $\mathcal{H}_A$ in its tensor product structure $\mathcal{H}_A=\bigotimes_{j\in A}\mathcal{H}_j$, we individuate in each local Hilbert space $\mathcal{H}_j$ a site of the partition $A$.
We remind that $\rho^A$ cannot be expressed as a product state over this factorisation of $\mathcal{H}_A$ and that the VonNeumann entropy is not addittive. Thus the VonNeumann entropy computed on each site is not a good entanglement contour function.\\
We know from \ref{sec:Reducede-Density-Matrix} that $\rho_A$ is a f.g.s., thus we can express the entanglement entropy $S(A)$ as the sum of the VonNeumman entropy of each mode in $A$
\begin{equation} 
S(A) = \sum_{k=1}^{N_A} S_k = -\sum_{k=1}^{N_A}\left[\nu_k \ln(\nu_k)+(1-\nu_k)\ln(1-\nu_k) \right] .
\end{equation}
Each mode $k$ associated to the Dirac operators $\beta_k=b_k\da$, $\beta_{k+N_A}=b_k$ is connected to the real space modes associated the Dirac operators $\alpha_i=a_i\da$, $\alpha_{i+N_A}=a_i$ by the fermionic transformation $U$ such that
\begin{equation}
\beta_k = \sum_{i=1}^{N_A} U_{k,i} \alpha_i.
\end{equation}
We want to use this equation to find how much a fixed mode $k$ contribute to a fixed site $i$. We call this contribution $p_i(k)$ and we define it as
\begin{equation}
p_i(k) \coloneqq \frac{1}{2}\left[|U_{k,i}|^2+|U_{k+N_A,i+N_A}|^2+|U_{k,i+N_A}|^2+|U_{k+N_A,i}|^2 \right].
\end{equation}
The entanglement contour for partition $A$ is thus defined as 
\begin{equation}
c_A(i) \coloneqq \sum_{k=1}^{N_A} p_i(k) S_k.
\end{equation}
It is easy to see that each of the $p_i(k)$ is positive and that 
\begin{equation}
\sum_{k=1}^{N_A} p_i(k) = 1,
\end{equation}
as $
\sum_{k=1}^{N_A} p_i(k)  = \frac{1}{2} \left[\sum_{l=1}^{2N_A} U_{i,l}U^{*}_{l,i} + U_{i+N_A,l}U^{*}_{l,i+N_A}\right] = \frac{1}{2} \left( (UU\da)_{i,i} + (UU\da)_{i+N_A,i+v}\right) = 1$, 
since $U$ is unitary. Thus one has the desired property
\begin{equation}
\sum_{i=1}^{N_A} c_{A}(i) = S(A).
\end{equation}

\begin{proposition}{\code{Contour($\Gamma_A$)$\rightarrow  \vec{c_A}$}}{}
This function return the vector $\vec{c_A}_i = c_A(i)$ of the entanglement contour of the correlation matrix $Gamma_A$.
\end{proposition}

\section{Examples}

We will use the function 
\begin{proposition}{\code{Random\_NNhamiltonianr(N)$\rightarrow  H$}}{}
Generate a random f.q.h. hamiltonian for a system of $N$ with just nearest neighbour interactions.
\end{proposition}

\subsection{Computing the energies of H}
\label{ex:JL-Energies-Of-H}
\lstinputlisting{JLCODE1.jl}


\includegraphics[width=0.7\textwidth]{figure/JLCODE1.pdf} 
  \captionof{figure}{Output of examples \ref{ex:JL-Energies-Of-H}.}
  



\subsection{Computing the entanglement contour of a partition of a ground state}
\label{ex:JL-Contour-Partition-GS}
\lstinputlisting{JLCODE2.jl}
Output:

\code{The energy of the ground state is: -83.1750144099933}


  \centerline{
\includegraphics[width=0.7\textwidth]{figure/JLCODE2.pdf} }
  \captionof{figure}{Output of examples \ref{ex:JL-Contour-Partition-GS}, note how for a nearest neighbour hamiltonian, the contour is higher on the boundary of the partition.}
  

\chapter{Time evolution}

\section{Real Time Evolution}
In the previous sections we talked about hamiltonians and states. It is now the time to put this two ingredient together and finally talk about the unitary evolution of fermionic gaussian states.\\
We start by say that \textit{the space of fermionic gaussian states is closed under evolution induced by fermionic quadratic hamiltonians}.
The best way for seeing this is using the Majorana operators representation. We consider a general f.q.h. $\hat{H}$ and a generic f.g.s. $\rho=\frac{e^{-\hat{H}_{\rho}}}{Z}$ with both $\hat{H}$ a and $\hat{H}_{\rho}$ of the form \ref{eq:Majorana-QFH}.
Using standard notation we call $\rho(t)$ the state $\rho$ at time $t$ defined as
\begin{equation}
\rho(t) \coloneqq e^{-it\hat{H}} \rho e^{it\hat{H}} = \frac{e^{-it\hat{H}} e^{-\hat{H}_{\rho}} e^{it\hat{H}}}{Z}.
\end{equation}
As already observed in section \ref{sec:Product-Rule}, the commutator of two quadratic monomial of Dirac operators is a polynomial at most quadratic in Dirac operators. Using this observation together with the Baker-Campbell-Hausdorff formula ( equation B.C.H.0 in appendix \ref{appendix:Formulas}), it is easy to see that $\rho(t)$ has the form
\begin{equation}
\rho(t) = \frac{e^{-\hat{H}_{\rho(t)}}}{Z}, 
\end{equation}
with $\hat{H}_{\rho(t)}$ a fermionic quadratic hamiltonian. Thus $\rho(t)$ is again a gaussian state and we proved that the space of gaussian states is closed under evolution induced by fermionic quadratic hamiltonians.\\
We will now compute an explicit formula for the time evolution of the correlation matrix $\Gamma(t)$ of the f.g.s. state $\rho(t)$.
The first step is computing the time evolution of the creation and annihilation operators in the Heisenberg picture. We denote with $\vec{\beta}$ the vector of Dirac operators that diagonalise $H$. The annihilation and creation operators $b_k$ and $b_k\da$ evolved at time $t$ are (see appendix \ref{appendix:Real-Heisenberg-Evolution})
\begin{align}
	b_k(t)&= e^{-i\hat{H}t} b_k e^{i\hat{H}t} = e^{-i 2 \epsilon_k t}b_k,\\
	b_k\da(t) &= e^{-i\hat{H}t} b_k\da e^{i\hat{H}t} = e^{i 2 \epsilon_k t}b_k\da.
\end{align}
In compact form this can be written as
\begin{equation}
\vec{\beta}(t) = e^{i 2 H_Dt}\vec{\beta}.
\end{equation}
It is easy now to compute the time evolution of the correlators $\langle \vec{\beta}\vec{\beta}\da\rangle$
\begin{equation}
 \langle \vec{\beta}(t)\vec{\beta}\da(t) \rangle = \langle e^{i 2 H_Dt} \vec{\beta}\vec{\beta}\da e^{-i 2 H_Dt}\rangle.
\end{equation}
Thus, if $U$ is the fermionic transformation such that $\vec{\beta} = U\vec{\alpha}$, the fermionic transformation implementing the time evolution of $\vec{\alpha}$ is $U\da e^{i 2 H_Dt}U = e^{i 2 Ht}$. We finally obtain that the correlation matrix $\Gamma$ evolves with $H$ as
\begin{equation}
\Gamma(t) = e^{i 2 Ht}\Gamma e^{-i 2 Ht}.
\end{equation} 



\begin{proposition}{\code{Evolve($\Gamma$, H\_D, U, t)$\rightarrow  \Gamma(t)$}}{}
This function return the correlation matrix $\Gamma$ evolved at time $t$ with $H$. Matrices $H_D$ and $U$ are the output of \code{Diag\_h(H)}.
\end{proposition}





\section{Imaginary-time evolution}
In order to find the ground state of a non-degenerate Hamiltonian $H$ one can use the following equality
\begin{equation}
|GS\rangle = \lim_{\tau\rightarrow\infty} \frac{e^{-H\tau}|\psi\rangle}{||e^{-H\tau}|\psi\rangle||}
\label{eq:Pure_state-ITE}
\end{equation}
starting from a generic state $|\psi\rangle$ with $\langle GS | \psi \rangle \neq 0$.\\
To see this, let's consider the orthononormal basis $\{|E_i\rangle\}_{i}$ generated by the collection of the eigenvectors of $H$, with eigenvalues $\{E_i\}_i$ such that $E_0\lneqq E_1 \leq E_2 \leq \dots \leq E_{dim(\mathcal{H})}$, where $\mathcal{H}$ is the Hilbert space on which $H$ act.\\
Expanding $|\psi\rangle$ on this basis one obtains $|\psi\rangle = \sum_i c_i |E_i\rangle$, with $c_0\neq 0$ from the fact that $\langle GS | \psi \rangle \neq 0$.
One can thus see that eq \eqref{eq:Pure_state-ITE} is just a projection to the ground state:
\begin{align}
 \lim_{\tau\rightarrow\infty} &  \frac{e^{-H\tau}|\psi\rangle}{||e^{-H\tau}|\psi\rangle||}  = \lim_{\tau\rightarrow\infty} \sum_i \frac{e^{-E_i \tau}c_i}{\sqrt{\sum_i e^{-2E_i \tau}|c_i|^2}}|E_i\rangle = \\
 & = \lim_{\tau\rightarrow\infty} \sum_i \frac{e^{-\frac{E_i}{E_0} \tau}c_i}{\sqrt{\sum_i e^{-2\frac{E_i}{E_0} \tau}|c_i|^2}}|E_i\rangle = |E_0\rangle,
\end{align}
and thus that $\lim_{\tau\rightarrow \infty}\frac{e^{-H\tau}}{||e^{-H\tau}||}$ is the projector on the ground state:
\begin{align}
\lim_{\tau\rightarrow \infty} & \frac{e^{-H\tau}}{||e^{-H\tau}||} = \lim_{t\rightarrow \infty}\frac{\sum_{i} e^{-E_i \tau}|E_i\rangle \langle E_i |}{\sqrt{\sum_i e^{-2E_i \tau}}} = \\
&= \lim_{\tau\rightarrow \infty}\frac{\sum_{i} e^{-\frac{E_i}{E_0} \tau}|E_i\rangle \langle E_i |}{\sqrt{\sum_i e^{-2\frac{E_i}{E_0} \tau}}} = |E_0\rangle \langle E_0 |.
\end{align}
Applying the same method to the density matrix one can obtain the ground state $\rho_{GS}$  of a non degenerate Hamiltonian $H$ from a general density matrix $\rho$ such that $Tr[\rho\rho_{GS}]\neq0$ as
\begin{equation}
\rho_{GS} = \lim_{\tau \rightarrow \infty} \frac{e^{-H\tau}\rho e^{-H\tau}}{Tr\left[\rho e^{-2H\tau}\right]}.
\label{eq:Corr_matr-ITE}
\end{equation}
We refer to the method for obtaining the ground state using \eqref{eq:Pure_state-ITE} as performing an \emph{imaginary time evolution}. \\
This is the case because, if for the time evolution operator $U(t)=e^{-iHt}$ for the Hamiltonian $H$,  we select $t=-i \tau$ we obtain the operator $e^{-H \tau }$ that is the one of eq \eqref{eq:Pure_state-ITE}. One can thus write in a non-formal way $|GS\rangle = \lim_{t \rightarrow -i \infty} \frac{|\psi(t)\rangle}{||\psi(t)\rangle||}$.\\
It's important to keep in mind that the operator $e^{-H\tau}$ is not unitary and for this reason it doesn't preserve the norm of the state and one has to renormalise it.\\
%Nevertheless in the rest of these notes we will always refer to this method as a time evolution ;-).
%textdej{ ð}.
We know already how to compute the ground state of any f.q.h., but it could result useful to be able to simulate an imaginary time evolution with f.g.s. in the case one is interested in benchmarking more complex algorithms.

\section{Numerical Imaginary time evolution}
In the numerical approach to imaginary time evolution one faces some difficulties.\\
Almost in all cases one is forced to evolve the state step by step renormalising every time, performing a discrete imaginary time evolution.\\
This procedure doesn't allow to reach infinite time in a finite amount of time steps, thus one has to find a criterion to stop the evolution when the convergence is accurate up to some confidence parameter. To check if the reached state is the expected state is tricky and theoretically impossible in most of the cases since one does not always have the exact value of the energy of the ground state.\\
A method for checking the convergence is to check the energy difference between two steps of the discrete imaginary time evolution. Once the difference in energy between two steps is lower than an acceptable value $\epsilon$, one decides that the algorithm converged.\\
It is not always the case though.  It is also possible that the approximate imaginary time evolution stops at some plateau and thus trick the algorithm in believing in a false convergence to the ground state. \\
%It seems the best way to deal with this is learning the art.
%
%\section{Numerical Imaginary time evolution for Fermionic Gaussian states}
%The imaginary time evolution of Fermionic Gaussian state is one of the many cases for which it is not possible to compute an exact imaginary time evolution but one has to use an approximate one.\\
%The reasons for which it is not possible to compute an exact imaginary time evolution for Fermionic Gaussian systems are mainly two.\\
%Given a Gaussian Fermionic Hamiltonian $H$ one expects for its ground state $\rho_{GS}$ to be a Gaussian state characterised by the correlation matrix $\Gamma_{GS}$. Thus, starting with a Fermionic Gaussian states $\Lambda_0$, one evolve it for the imaginary time step $\delta t$ until the algorithm converges. \\
%The first main problem is that the evolution of expression \eqref{eq:Corr_matr-ITE} does not preserve the Guassianity of the state \cite{kraus2009}, thus, in the  standard framework for Fermionic Gaussian state, that is the one of correlation matrices, finding the imaginary-time evolved form $\Gamma(t)$ of the initial state $\Gamma_0$ corresponds first evolve the initial state $\rho_{GS}$ and then projecting it again in the space of Gaussian states. This procedure introduces an approximation in the algorithm which makes the questions about convergence to the real ground state even harder.
%
%%%%%FIGURE 1
%\begin{figure}
%	\centering
%	\includegraphics[width=0.8\linewidth]{figure/Gaussian-Projection.pdf}
%	\caption{Imaginary time evolution of the Guassian state $\rho_{0}$ with Hamiltonian $H$. In green is represented the exact imaginary time evolution. The red dotted lines represent projections into the the space of Gaussian states. If we compute the exact imaginary time evolution until the p oint of convergence we can reach the ground state $\rho_{GS}$ of $H$ within machine precision. With the numerical algorithm one has to project at each step the evolved state into the space of Gaussian states, possibly leading to a wrong approximation of the ground state $\tilde{\rho}_{GS}$.
%	}
%	\label{fig:Sectors_Fourier}
%\end{figure}
%%%%%
%
%The second main problem is that, as we will soon see, in the framework of Gaussian states it seems not even possible to compute the exact time evolution for each time step. We are thus forced to consider an approximate imaginary dynamic for each time step.\\
\subsection{Imaginary time evolution of  the correlation matrix}
The imaginary time evolution of the correlation matrix is defined as
\begin{align}
\Gamma_{i,j}(\tau) & = Tr\left[\rho(\tau) \vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}\right] = \\
& = \frac{Tr \left[e^{-\hat{H}\tau} \rho e^{-\hat{H}\tau}\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}  \right]}{Tr\left[e^{-\hat{H}\tau} \rho e^{-\hat{H}\tau}\right]}.
\label{eq:rho(tau)}
\end{align}
%\subsubsection{Heisenberg imaginary time evolution}
Obtaining an explicit form for $\Gamma(\tau)$ just in term of $H$ and $\Gamma(0)$ is not easy.
One can compute the imaginary time evolution in Heisenberg picture with $e^{-\hat{H}\tau}$ of  the operator $\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}$. Using \emph{BCH2} (i.e. $e^{A}Be^{A}=\sum_{n=0}^{\infty}\frac{1}{n!}\underbrace{\{A,...\{A}_{n},B\underbrace{\}...\}}_{n}$) and moving in the diagonal basis with Dirac operators  $\vec{\beta}$ one can write the Hamiltonian as $\hat{H}= \sum_k \epsilon(k) \left(b_k^{\dagger}b_k-b_kb_k^{\dagger}\right)$.\\
Thus one has
\begin{align}
e^{-\hat{H}\tau}&\vec{\beta}_{l}\vec{\beta}_{j}^{\dagger}e^{-\hat{H}\tau} = \sum_{n=0}^{\infty} \frac{-\tau^n}{n!} \underbrace{\{\hat{H},...\{\hat{H}}_{n},\vec{\beta}_{l}\vec{\beta}_{j}^{\dagger}\underbrace{\}...\}}_{n}.
\end{align}
Since  $b_l\da b_j\hat{H} = (\hat{H}+2\Delta_{l,j})b_l\da b_j$, we cannot simplify this expression as in the case of real time evolution.\\
To obtain a  numerical algorithm for the imaginary time evolution one has to realise that, for each value of $\tau$, $\Gamma(\tau)$ is just the correlation matrix of the f.g.s. 
\begin{equation}
\rho(\tau) = \frac{e^{-\hat{H}\tau} \rho e^{-\hat{H}\tau}}{\Tr{e^{-\hat{H}\tau} \rho e^{-\hat{H}\tau}}}.
\end{equation}
The correlation matrix $\Gamma(\tau)$ can be easily obtained by the product rule (see section \ref{sec:Product-Rule}) of the initial f.g.s. $\rho$ and the thermal state $\rho_{\beta=\tau}=\frac{e^{-{H}\tau}}{\Tr{e^{-\hat{H}\tau}}}$.


\begin{proposition}{\code{Evolve\_imag($\Gamma$, H\_D, U, $\tau$)$\rightarrow  \Gamma(\tau)$}}{}
This function return the correlation matrix $\Gamma$ evolved at imaginary time $\tau$ with $H$. Matrices $H_D$ and $U$ are the output of \code{Diag\_h(H)}.
\end{proposition}



%
%Knowing that $b_l\da b_j\hat{H} = (\hat{H}+2\Delta_{l,j})b_l\da b_j$, with $\Delta_{l,j}=\epsilon_j-\epsilon_l$, we have we  see that the time evolution of the operator $b_l\da b_j$ is
%\begin{equation}
%e^{-\hat{H} \tau} b_{l}^{\dag}b_{j} e^{-\hat{H} \tau} = \sum_{n=0}^{\infty} \frac{(-2(\hat{H}+\Delta_{l,j})\tau)^n}{n!} b_l\da b_j=e^{-2(\hat{H}+\Delta_{l,j})\tau}b_l\da b_j.  
%\end{equation}
%For the other $3$ quadrants of the correlation matrix we have
%\begin{align}
%e^{-\hat{H} \tau} b_{l}b_{j}\da e^{-\hat{H} \tau} &= e^{-2(\hat{H}-\Delta_{l,j})\tau}b_l b_j\da, \\
%e^{-\hat{H} \tau} b_{l}b_{j} e^{-\hat{H} \tau} &= e^{-2(\hat{H}+\nabla_{l,j})\tau}b_l b_j,\\
%e^{-\hat{H} \tau} b_{l}\da b_{j}\da e^{-\hat{H} \tau} &= e^{-2(\hat{H}-\nabla_{l,j})\tau}b_l\da b_j\da,
%\end{align}
%with $\nabla_{i,j}=(\epsilon_i+\epsilon_j)$.

%Computing the anticommutators in the expansion of the imaginary time evolution of the couple $b_{i}^{\dag}b_{j}$ we obtain
%\begin{align}
%e^{-\hat{H} \tau} b_{i}^{\dag}b_{j} e^{-\hat{H} \tau} = \left[ \sum_{n=0}^{\infty}  \frac{\tau^n}{n!} \sum_{k=0}^{n}  \binom{n}{k}\Delta_{i,j}^{n-k} \hat{H}^{k} \right]b_{i}^{\dag}b_{j},
%\end{align}
%with $\Delta_{i,j} = (\epsilon(j)-\epsilon(i))$ and $\binom{n}{k}=\frac{n!}{k!(n-k)!}$ the binomial coefficient.


%The expansion of the anticommutators for each value of $n$ is not trivial. We computed the first terms in the expansion of the imaginary time evolution of the couple $b_{i}^{\dagger}b_j$:\\
%\resizebox{\textwidth}{!}{%
%$
%\begin{array}{ccccccc}
%	n & anticommutator & b_{i}^{\dagger}b_{j} & Hb_{i}^{\dagger}b_{j} & H^{2}b_{i}^{\dagger}b_{j} & H^{3}b_{i}^{\dagger}b_{j} & H^{4}b_{i}^{\dagger}b_{j}\\
%	0 & \mathbb{I}& 1&0  &0 &0 &0 \\
%	1 & \left\{ H,b_{i}^{\dagger}b_{j}\right\}  & \left(\epsilon_{j}-\epsilon_{i} \right)-\sigma & 1 & 0 & 0 & 0\\
%	 2 &\left\{ H,\left\{ H,b_{i}^{\dagger}b_{j}\right\} \right\}  & \left((\epsilon_{j}-\epsilon_{i})-\sigma\right)^{2} & \left(2(\epsilon_{j}-\epsilon_{i})-\sigma\right) & 2 & 0 & 0\\
%	3 &\left\{ H,\left\{ H,\left\{ H,b_{i}^{\dagger}b_{j}\right\} \right\} \right\}  & \left((\epsilon_{j}-\epsilon_{i})-\sigma \right)^{3} & \left((\epsilon_{j}-\epsilon_{i})-\sigma\right)^2+(\epsilon_{j}-\epsilon_{i})\left(2(\epsilon_{j}-\epsilon_{i})-\sigma\right) & \left(6(\epsilon_{j}-\epsilon_{i})-2\sigma \right) & 4 & 0 \\
%	\vdots&\vdots & \vdots & \vdots & \vdots & \vdots & \ddots
%\end{array}.
%$
%}\\
%
%We associate to each line $n\in[0,\infty)$ of the table a vector $\vec{X}^n$ of coefficients $\{X_i^n\}_{i\in[0,\infty)}$ defining $\Delta_{l,j} = (\epsilon_{j}-\epsilon_{l})$ and $\sigma=\sum \frac{\epsilon_k}{2}$, we can write  $\vec{X}^n(l,j)$ as:
%\begin{align}
%\vec{X}^n(l,j)  = [&(\Delta_{l,j}-\sigma)^n, X_0^{n-1}(l,j)+\Delta_{l,j} X_1^{n-1}(l,j),2X_1^{n-1}(l,j)+\Delta_{l,j} X_2^{n-1}(l,j), \nonumber \\
%& \dots,\underbrace{2X_{i,1}^{n-1}+\Delta X_{i}^{n-1}}_{i},\dots ]
%\label{eq:coefficients}
%\end{align}
%with
%\begin{equation}
%X^{n}_i(l,j) =
%\begin{cases*}
%0  & if $ i<n$ \\
%2^{(n-1)}        & if $i=n$\\
%1 & if $i=n=0$
%\end{cases*}.
%\end{equation}
%Using this we rewrite the imaginary time evolution as
%\begin{equation}
%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} = \sum_{n=0}^{\infty}\sum_{i=0}^{n}\frac{\tau^n X^n_i(l,j)}{n!}H^i b_{l}^{\dagger}b_j.
%\label{eq:Heisenberg-evolution-bibj}
%\end{equation}
%%This is complex to compute. (Is it like a cellular automata?).
%Changing the order of these sums %(can I? it seems the sum it doesn't converge if I exchange)
% as
%\begin{equation}
%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} = \sum_{i=0}^{\infty}\sum_{n=i}^{\infty}\frac{\tau^n X^n_i(l,j)}{n!}H^i b_{l}^{\dagger}b_j,
%\end{equation}
%we can rewrite the imaginary time evolution of the operators $b_{l}^{\dagger}b_j$ in terms of the weighted Pascal's triangle terms $D^{n}_i$
%\begin{align}
%e^{-H\tau}b_{l}^{\dagger}b_j e^{-H\tau} &= \sum_{i=0}^{\infty}\sum_{n=i}^{\infty}\frac{\tau^{n+1} D^n_i(l,j)}{(n+1)!}H^{i+1} b_{l}^{\dagger}b_j+\nonumber \\
%&+\sum_{i=0}^{\infty}\frac{\left(\tau(\Delta-\sigma)\right)^n}{n!}b_{l}^{\dagger}b_j.
%\end{align}
%
%%%%%FIGURE 2
%\begin{figure}
%	\centering
%	\includegraphics[width=0.80\linewidth]{figure/Weighted-Pascal.pdf}
%	\caption{The table of the coefficients \eqref{eq:coefficients} has this structure. The coefficients of $b_{i}^{\dagger}b_j$ are simple incremental power of $(\Delta-\sigma)$. From the second column on it has the structure of a weighted Pascal's triangle with $2$  as weight on the diagonal direction and $\Delta$ as weight on the vertical direction, thus for example we have $D^{2}_2=2D^{2}_{1}+\Delta D^{1}_{2}$.
%	}
%	\label{fig:Sectors_Fourier}
%\end{figure}
%%%%%
%
%It is possible to find a non-recursive form of the terms $D^{n}_{i}$, that is
%\begin{equation}
%D^{n}_{i}(l,j)=2^i \sum_{x=0}^{n}\Delta^{x}_{l,j}A_{l,j}(n-x)\binom{i-1+x}{i-1}.
%\end{equation}
%This form refers just to the fixed boundary terms.
%Inserting the expansion of the boundary terms we obtain
%\begin{align}
%D^{n}_{i}(l,j)& =\frac{2^i \Delta^{n+1}_{l,j}}{\sigma}\binom{i+n}{i}+ \nonumber \\& -\frac{2^{i}(\Delta_{l,j}-\sigma)}{\sigma}\sum_{x=0}^{n}\binom{i-1+x}{i-1}\Delta^{x}_{l,j}(\Delta_{l,j}-\sigma)^{n-x}
%\end{align}
%%\begin{remark}Some observations on the expansion \eqref{eq:Heisenberg-evolution-bibj}
%%	\begin{itemize}
%%		%\item Since the Hamiltonian is Fermionic we have that the sum over $i$ in \eqref{eq:Heisenberg-evolution-bibj} run from $0$ to $N$, where $N$ is the number of considered Fermionic sites. In fact, if $i>N$ we would have $H^i=0$ because necessarily some fermionic operator would be doubled.
%%		\item If we exchange the summation in \eqref{eq:Heisenberg-evolution-bibj} (can we?) we obtain an approximation of $\langle b_i^{\dagger}b_j\rangle(t)$in terms of  $\langle H^ib_i^{\dagger}b_j\rangle$, thus in terms of $i-$points correlations. What does it mean to cut to some $i$?
%%	\end{itemize}
%%\end{remark}

%
%













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%IMAGINARY TIME EXPANSION%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsubsection{Expansion of the imaginary time evolution with $\delta t$}
%This method has been showed in \cite{kraus2010} to be equivalent to other variational methods and to be  usually an effective method.
%
%
%In order to compute the expansion of the imaginary evolution in terms of $\delta t$ we start from the exact time derivative of eq \eqref{eq:rho(tau)}
%\begin{equation}
%\frac{d}{d\tau} \rho(\tau) = -\left\{ \hat{H},\rho(\tau) \right\}+2\rho(\tau)\langle \hat{H} \rangle.
%\end{equation}
%Using the last equation and exploiting the linearity of the trace, we can easily compute the time derivative of the evolution of a term of the correlation matrix
%\begin{equation}
%\frac{d}{dt}\Gamma^{[1]}_{i,j}(\tau)= -Tr\left[ \left\{ \hat{H},\rho(\tau)\right\}b_{i}^{\dagger}b_j\right]+2\langle \hat{H}\rangle \Gamma^{[1]}_{i,j}.
%\label{eq:ddtau-Lambda_1}
%\end{equation}
%Considering the first term in the LHS we can proceed as follows.
%\begin{align}
%Tr\left[ \left\{ \hat{H},\rho(\tau)\right\}b_{i}^{\dagger}b_j\right] &=\Tr{\left\{ \hat{H},b_{i}^{\dagger}b_j\right\}\rho(\tau)}= \nonumber\\
%& =\langle \hat{H} b_{i}^{\dagger}b_{j}\rangle + \langle b_{i}^{\dagger}b_{j} \hat{H} \rangle,
%\label{eq:Term-1_LHS_ddt-Lambda}
%\end{align}
%using the Fermionic Wick Theorem (i.e. $\expv{abcd}=\expv{ab}\expv{cd}-\expv{ac}\expv{bd}+\expv{ad}\expv{bc}$)
%\begin{align*}
%\langle \hat{H} & b_{i}^{\dagger}b_{j}\rangle  =\sum_{k=1}^{N}\frac{\epsilon_k}{2}\left(\expv{b^{\dagger}_{k}b_{k}b_{i}^{\dagger}b_{j}}-\expv{b_{k}b_{k}^{\dagger}b_{i}^{\dagger}b_{j}} \right)= \nonumber\\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\sum_{k=1}^{N}\epsilon_k\left( \expv{b_{k}b_{i}^{\dagger}}\expv{b_{k}^{\dagger}b_{j}}-\expv{b_{k}^{\dagger}b_{i}^{\dagger}}\expv{b_{k}b_{j}} \right)=\nonumber \\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\sum_{k=1}^{N}\epsilon_k\left(\delta_{i,k}\Gamma^{[1]}_{k,j}-\Gamma^{[1]}_{i,k} \Gamma^{[1]}_{k,j}+\Gamma^{[2]}_{i,k}\Gamma^{[3]}_{kj}\right) =\nonumber \\
%& = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\epsilon_i\Gamma^{[1]}_{i,j}+(\Gamma H_D \Gamma)_i,j
%\end{align*}
%where in the last step we used the specific diagonal  $H_D$ form of $H$ with negative entries on the first half of the diagonal and positive on the second half.\\
%With the same procedure we find
%\begin{align*}
%\expv{b_{i}^{\dagger}b_{j}\hat{H}} = \expv{\hat{H}}\Gamma^{[1]}_{i,j}+\epsilon_{j}\Gamma^{[1]}_{i,j}+(\Gamma H_D \Gamma)_{i,j}.
%\end{align*}
%Inserting both terms first in \eqref{eq:Term-1_LHS_ddt-Lambda} and then in \eqref{eq:ddtau-Lambda_1} one obtains
%\begin{equation*}
%\frac{d}{d\tau}\Gamma^{[1]}_{i,j}(\tau)= -2(\Gamma H_D \Gamma)_{i,j}-(\epsilon_{i}+\epsilon_{j})\Gamma^{[1]}_{i,j}=-2(\Gamma H_D \Gamma)_{i,j}-\left[H_D,\Gamma\right]_{i,j},
%\end{equation*}
%and thus applying the same procedure for each quadrant of the correlation matrix one obtain the general form of the derivative of the imaginary time evolution of the correlation matrix
%\begin{equation}
%\frac{d}{d\tau}\Gamma(\tau) = 4\Gamma(\tau) H_D\Gamma(\tau) - 4 H_D\Gamma(\tau) .
%\label{eq:ddtau-Lambda}
%\end{equation}
%It will result more convenient work in the Majorana formalism now. For Majorana fermions equation \eqref{eq:ddtau-Lambda} read as
%\begin{equation}
%\frac{d}{d\tau}\gamma(\tau) = 4\left((\gamma(\tau) \tilde{h}_d\gamma(\tau) - \tilde{h}_D,\gamma(\tau)\right) .
%\end{equation}
%
%%\emph{Now we introduce an approximation}.\\
%At first order in imaginary time we can write the derivative as
%\begin{equation*}
%\gamma(\tau+\delta \tau)-\gamma(\tau) = \left( 4\gamma(\tau)H_D\gamma(\tau) - 4 H_D,\gamma(\tau)\right)\delta \tau +\mathcal{O}(\delta \tau^2).
%\end{equation*}
%We want to find an orthogonal matrix $O_\tau$ such that
%\begin{equation*}
%\gamma(\tau+\delta \tau) = O_{\tau}(\delta \tau) \gamma(\tau) O_{\tau}^{T}( \delta \tau).
%\end{equation*}
%Requesting for it to be orthogonal is a necessary and sufficient condition for it to be a general transformation on Majorana Fermions preserving the anticommutation relations.
%We write $O_{\tau}(\delta \tau) = e^{L_t \delta \tau}$ with $L_t^{T}=-L_t$ (every special orthogonal matrix can be written as the exponential of a skew-symmetric matrix, this is why here is more convenient working with Majoranas).% In fact a general transformation on Dirac Fermions is a matrix $U$ such that $U\Omega^{T}$ is orthogonal or such that $UU^{\dagger}=\{\{0,\mathbb{I}\},\{\mathbb{I},0\}\}$).
%\\
%At first order in time we would have
%\begin{equation*}
%\gamma(\tau+\delta \tau) = \gamma(t)+ \left[L_t,\gamma(t) \right] \delta t+ \mathcal{O}(\delta t^2).
%\end{equation*}
%In order to find $O_{\tau}(\delta \tau)$ at first order in time we have to solve
%\begin{equation*}
%\left[L_{\tau},\gamma(\tau) \right] = 4\gamma(\tau)H_D\gamma(\tau)-4H_d,\gamma(\tau).
%\end{equation*}
%%\emph{Here we insert a request.}\\
%This equation has a simple solution if we restrict to the case of pure Fermionic Gaussian states that is  imposing to the correlation matrix to be idempotent, $\gamma=\gamma^2$.\\
%For a pure state we have
%\begin{equation*}
%L_{\tau} = 2\left[H_d,\gamma(\tau) \right].
%\end{equation*}
%Thus the imaginary time evolution of the correlation matrix of a pure Fermionic Gaussian state with an approximation at first order in time is:
%\begin{equation}
%\gamma(\tau)(t+\delta t) = e^{2\left[H_D, \gamma(\tau)\right]}\gamma(\tau)e^{-2\left[H_D,\gamma(\tau) \right]}
%\end{equation}
%or for Dirac Fermions
%\begin{equation}
%\Gamma(\tau)(t+\delta t) = e^{2\left[H_D, \Gamma(\tau)\right]}\Gamma(\tau)e^{-2\left[H_D,\Gamma(\tau) \right]},
%\end{equation}
%where $H_D$ is the block diagonalised or diagonalised Hamiltonian for Majorana or Dirac.














%%%%%%%%%%Appendix
\appendix

\chapter{Extended calculations}
\section{Eigenvalues of $\Gamma$ and $H_{\alpha}$}
\label{appendix:Eigenvalues-Relations}
We consider the state $\rho=\frac{e^{-\vec{\alpha}^{\dagger}H \vec{\alpha}}}{Z}$, we diagonalise $H$ changing the basis to $\vec{\beta}=U^{\dagger}\vec{\alpha}$. Thus we have
\begin{equation}
\rho=\frac{e^{-\vec{\beta}^{\dagger}H_{D}\vec{\beta}}}{Z}=\frac{e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}}{Z}.
\end{equation}

We change the basis of the correlation matrix too
\begin{equation}
\Gamma_{i,j}^{b}=\left(U^{\dagger}\Gamma U\right)_{i,j}=Tr\left[\rho\vec{\beta}_{i}\vec{\beta_{j}}^{\dagger}\right].
\end{equation}

Now we want to explicitly compute the elements of $\Gamma^{b}$. First of all we compute the normalisation constant

\begin{equation}
Z=Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\right] =2^N\prod_{k=1}^{N}\left(\cosh\left(\epsilon_{k}\right)\right).
\end{equation}

To compute the numerator part this equalities will result useful
\begin{itemize}
\item  For $x\neq y$

\begin{equation}
\begin{aligned}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)} b_{x}^{\dagger}b_{y}\right]	&  =\sum_{v\in\left\{ 0,1\right\} ^{N}}\langle v|e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}^{\dagger}b_{y}|v\rangle=\\
	&=\sum_{v\in\left\{ 0,1\right\} ^{N}}\langle v|e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}|\tilde{v}\rangle=\\
	& =\sum_{v\in\left\{ 0,1\right\} ^{N}}e^{-\sum_{k=1}^{N}(-1)^{v_{k}+1}\epsilon_{k}}\langle v|\tilde{v}\rangle = 0
\end{aligned}
\end{equation}


\begin{equation}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}b_{y}^{\dagger}\right]=0
\end{equation}

â¢\item $\forall x,y$

\begin{equation}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}b_{y}\right]=0
\end{equation}
\begin{equation}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{x}^{\dagger}b_{y}^{\dagger}\right]=0
\end{equation}

Thus the numerator can be explicitly written as

\begin{equation}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\vec{\alpha}_{i}\vec{\alpha_{j}}^{\dagger}\right]=
\end{equation}

\begin{equation*}
=\sum_{l=1}^{2N}\sum_{m=1}^{2N}U_{i,l}U_{m,j}^{\dagger}Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\vec{\beta}_{l}\vec{\beta_{m}}^{\dagger}\right]=
\end{equation*}

\begin{equation*}
=\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{l}^{\dagger}b_{l}\right]+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}b_{l}b_{l}^{\dagger}\right]=
\end{equation*}

\begin{equation*}
=\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}e^{-\epsilon_{l}}\prod_{k\neq l}2\cosh(\epsilon_k))+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}e^{\epsilon_{l}}\prod_{k\neq l}2\cosh(\epsilon_k))
\end{equation*}

I can divide by Z and obtain

\begin{equation}
\begin{aligned}
\Gamma_{i,j} & =\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}\frac{e^{-\epsilon_{l}}}{e^{\epsilon_{l}}+e^{-\epsilon_{l}}}+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}\frac{e^{\epsilon_{l}}}{e^{\epsilon_{l}}+e^{-\epsilon_{l}}}\\
 & =\sum_{l=1}^{N}U_{i,l}U_{l,j}^{\dagger}\frac{1}{1+e^{2\epsilon_{l}}}+\sum_{l=1}^{N}U_{i,l+N}U_{l+N,j}^{\dagger}\frac{1}{1+e^{-2\epsilon_{l}}}=\\
 & =(U\Gamma^{D}U^{\dagger})_{i,j}.
\end{aligned}
\end{equation}

\end{itemize}


So the same transformation U that moves to the free Hamiltonian $H_D$ is also the transformation that diagonalise the correlation matrix. The eigenvalues $\nu_{i}$ of the correlation matrix $\Gamma$ are related to the eigenvalues of the parent hamiltonian $H$ by

\begin{equation}
\nu_{i}=\frac{1}{1+e^{2\epsilon_{i}}},
\end{equation}

\begin{equation}
\epsilon_{i}=\frac{1}{2}ln\left(\frac{1-\nu_{i}}{\nu_{i}}\right),
\end{equation}

since $\nu_{i}\in\left[0,1\right]$ the eigenvalues $\epsilon_{i}\text{\ensuremath{\in}[-\ensuremath{\infty},+\ensuremath{\infty}]}$.


\section{Purity}
\label{appendix:Purity}
From the previous subsection we have:

\begin{equation}
Z^{2}=\prod_{k=1}^{N}\left(2\cosh\left(\epsilon_{k}\right)\right)^{2}
\end{equation}

and

\begin{equation}
Tr\left[e^{-\sum_{k=1}^{N}\epsilon_{k}\left(b_{k}^{\dagger}b_{k}-b_{k}b_{k}^{\dagger}\right)}\right]=\prod_{k=1}^{N}\left(2\cosh\left(2\epsilon_{k}\right)\right).
\end{equation}


Thus the purity is:

\begin{equation}
\mbox{Purity}=\prod_{k=1}^{N}\frac{1}{\sech(\epsilon_{k})+1}
\end{equation}


\section{Real Time Evolution}
We want to compute the time evolution in the Heisenberg picture of the annihilation operator $b_k$ induced by the hamiltonian $\hat{H} = \sum_{l=1}^{N} \epsilon_{l} (b\da_l b_l -b_l b\da_l) $.
First we simplify the expression exploiting the commuting terms 
\begin{align}
  b_k(t) &= e^{i\hat{H}t}b_ke^{-i\hat{H}t}=e^{ it\sum_{l=1}^{N} \epsilon_{l} (b\da_l b_l -b_l b\da_l)} b_k e^{it \sum_{l=1}^{N} \epsilon_{l} (b\da_k b_l -b_l b\da_l)}= \\
            &= e^{ it \epsilon_{k} (b\da_k b_k -b_k b\da_k)} b_k e^{it \epsilon_{k} (b\da_k b_k -b_k b\da_k)}.
\end{align}
Secondly applying B.C.H.1 (see B.C.H.1 in \ref{appendix:Formulas}) we obtain that
\begin{equation}
  b_k(t)  = \sum_{n=0}^{\infty} \frac{(i e_k t)^n}{n!}\underbrace{[b_k\da b_k-b_k b_k\da,\dots[v_k\da b_k-b_k b_k\da,}_{n}b_k\underbrace{]\dots]}{n},
\end{equation}
and using the fact that 
\begin{equation}
[b_k\da b_k-b_k b_k\da,b_k] = -2b_k,
\end{equation}
we obtain 
\begin{equation}
b_k(t)= \sum_{n=0}^{\infty} \frac{(2 i e_k t)^n}{n!}b_k = e^{-i2e_kt}b_k.
\end{equation}






 \chapter{Useful relations}
 \section{Pauli Matrices}
 \begin{enumerate}
  \item  $\sigma^+ = \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix}$, $\sigma^-=\begin{pmatrix} 0 & 0 \\ 1 & 0 \end{pmatrix}$, $\sigma^z=\begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix}$, $\sigma^y=\begin{pmatrix} 0 & -\im \\ \im & 0 \end{pmatrix}$, $\sigma^x=\begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$, $\ket{+}_x= \frac{1}{\sqrt{2}}\colvec{2}{1}{1}$, $\ket{-}_x= \frac{1}{\sqrt{2}}\colvec{2}{1}{-1}$, $\ket{+}_y= \frac{1}{\sqrt{2}}\colvec{2}{1}{\im}$, $\ket{-}_y= \frac{1}{\sqrt{2}}\colvec{2}{1}{-\im}$, $\ket{0_{-}}_z= \colvec{2}{0}{1}$, $\ket{1_{+}}_z=\colvec{2}{1}{0}$
 \item $\sigma^z \sigma^- = -\sigma^-$
 \item $\sigma^z \sigma^+ = \sigma^+$
 \item $\sigma^- \sigma^z = \sigma^-$
 \item $\sigma^+ \sigma^z = -\sigma^+$
 \item $\sigma^+ \sigma^- = \frac{\sigma^z+\id}{2}$
  \item $\sigma^- \sigma^+ = \frac{\id-\sigma^z}{2}$
 \end{enumerate}
 \section{Operators obeying CAR}
 \label{appendix:fermionic_operators}
 \begin{enumerate}
 \item $\{a_i,a\da_j\} = \id \delta_{i,j}$ \qquad $\{a_i,a_j \}=\{a_i^{\dagger},a_{j}^{\dagger} \} = 0$
 \item $a_ia_j=-a_ja_i$;\qquad $a_i^{\dagger}a_j^{\dagger} = -a_{j}^{\dagger}a_i^{\dagger}$
 \item $a^2_i=\left(a\da_j\right)^2=0$
 \item $a_ia_j^{\dagger}=\delta_{i,j}-a_j^{\dagger}a_i$
 \item $a_ia_j=\frac{a_ia_j-a_ja_i}{2}$
 \item $a_ia_j^{\dagger}=\frac{a_ia_j^{\dagger}-a_j^{\dagger}a_i}{2}+\frac{\delta_{i,j}}{2}$
  \item $a_i^{\dagger}a_j=\frac{a_i^{\dagger}a_j-a_ja_i^{\dagger}}{2}+\frac{\delta_{i,j}}{2}$
 \end{enumerate}
Commutators
 \begin{enumerate}
  \item $[a_i^{\dagger},a_j]=\delta_{i,j}-2a_ja_i^{\dagger}=a_i^{\dagger}a_j-\delta_{i.j}$
  \item $[a_i,a_j^\dagger]=\delta_{i,j}-2a_j^{\dagger}a_i=a_i a_j^{\dagger}-\delta_{i,j}$
  \item $[a_i,a_j]=2a_i a_j$
  \item $[a_i^{\dagger},a_j^{\dagger}]=2a_i^{\dagger}a_j^{\dagger}$
 \end{enumerate}
 Majorana operators
 \begin{enumerate}
\item $x_{i}^{2}=p_{i}^{2}=\frac{1}{2}$
\item $a^{\dagger}a=\frac{i}{2}\left(xp-px\right)+\frac{1}{2}=ixp+\frac{1}{2}$
\item $aa^{\dagger}=\frac{i}{2}\left(px-xp\right)+\frac{1}{2}=ipx+\frac{1}{2}$
\item $xp=-\frac{i}{2}\left(a^{\dagger}a-aa^{\dagger}\right)=-i\left(a^{\dagger}a-\frac{1}{2}\right)$
\end{enumerate}

 \section{Jordan-Wigner Transformations}
 \subsection{spinless fermions $\rightarrow$ spins}
 \begin{enumerate}
 \item $a_j=-\bigotimes_{k=1}^{j-1}\sigma_k^z\otimes\sigma_j^-\bigotimes_{k=j+1}^N\mathbb{I}_k$
 \item $a_j^{\dag}=-\bigotimes_{k=1}^{j-1}\sigma_k^z\otimes\sigma_j^+\bigotimes_{k=j+1}^N\mathbb{I}_k$
  \item $a_j^{\dag}a_j=\bigotimes_{k=1}^{j-1}\otimes \frac{\sigma_j^z+\id_j}{2} \bigotimes_{k=j+1}^N \id_k $
 \end{enumerate}
 \subsection{spins $\rightarrow$ spinless fermions}
 \begin{enumerate}
 \item $\sigma_j^z = a_j^{\dag} a_j-a_j a_j^{\dag}$
 \item $\sigma_j^x = -\bigotimes_{k=1}^{j-1}\sigma_j^z\otimes(a_j+a_j^{\dag})\bigotimes_{k=j+1}^{N}\id_j$
 \item $\sigma_j^x = \im \bigotimes_{k=1}^{j-1}\sigma_j^z\otimes(a_j^{\dag}-a_j)\bigotimes_{k=j+1}^{N}\id_j$
 \item $\sigma_j^x\sigma_{j+1}^x = (a_j^{\dag}-a_j)(a_{j+1}+a_{j+1}^{\dag})$
 \item $\sigma_j^y\sigma_{j+1}^y = -(a_j^{\dag}+a_j)(a_{j+1}^{\dag}-a_{j+1}) $
 \item $\sigma_j^x\sigma_{j+1}^y = \im (a_j^{\dag}-a_j)(a_{j+1}^{\dag}+a_{j+1})$
 \item $\sy_j\sx_{j+1} = \im (a_j\da+a_j)(a_{j+1}\da+a_{j+1})$
 \end{enumerate}
 
 
\section{Formulas}
\label{appendix:Formulas}
\begin{enumerate}
\item B.C.H. 1: $e^Ae^B=e^{Z}$ with $Z=A+B+\frac{1}{2}\left[A,B \right]+\frac{1}{12}\left[A,\left[A,B\right]\right]+\frac{1}{12}\left[B,\left[A,B\right]\right]+\dots \mbox{higher commutators of A and B}$
\item B.C.H 2: $e^ABe^{-A} = \sum_{n=0}^{\infty} \frac{1}{n!}\underbrace{[A,\dots [A}_{n},B\underbrace{] \dots ]}_{n}$ where $[A,B]=AB-BA$.
\item B.C.H 3: $e^ABe^{A} = \sum_{n=0}^{\infty} \frac{1}{n!}\underbrace{\{A,\dots \{A}_{n},B\underbrace{\} \dots \}}_{n}$ where $\{A,B\}=AB+BA$.
\end{enumerate}

\bibliography{QFH}
%\bibliographystyle{ieeetr}








































\end{document}






















%\begin{note}
%Note that a subgroup~$H$ of a group $G$ is itself a left coset of $H$ in $G$.
%\end{note}





%	\section{Representations of fermionic density matrix}
%	Let us start with a trivial remark on the definition of fermionic gaussian state just given.\\
%	%
%	\begin{remark}Gaussian states are ground state and thermal Gibbs state of a f.q.h..
%	\end{remark}
%	%
%From section \ref{ch:1} we know that the f.q.h.s can be diagonalised as \eqref{eq:Dirac-QFH-FreeFree}, thus a gaussian states have a normal-mode decomposition in terms of $N$ single-mode thermal states of the form $\sim e^{-\beta_{i}b_{i}^{\dagger}b_{i}}$.\\
%%
%One can thus refine the previous remark as\\
%%
%	\begin{remark}Gaussian states are ground state and thermal Gibbs state of free-free f.q.h..
%	\end{remark}
%From this observation, one can show that the state is fully determined by the expectation values of quadratic operators \cite{kraus2009,peschel2003}. We will see how to further develop this intuition in the correlation matrix representation in the following sections.\\
%%
%\subsection{Standard form of fermionic gaussian states}
%Switching to the Majorana operator representation of the exponentiated Hamiltonian in \eqref{eq:Fermionic-Gaussian-State}, diagonalising it as explained in the previous chapter, expanding the exponential in series and applying the MCAR one obtain the so called \textit{standard form}  of $\rho$
%\begin{equation}
%\label{eq:stnd-form-rho}
%\rho = \prod_{k=1}^{N}\chi_k,
%\end{equation}
%where $\chi_k = \frac{\mathbb{I}}{2}+i \lambda_k s_{2k-1} s_{2k}$, and coefficients $\lambda_k\in[-1,1]$ , and $s_i$ are the Majorana operators that diagonalise exponentiated matrix of the state \cite{demelo2013}.
%
%
%%%%%Correlation Matrix
%\section{Correlation Matrix}
%\subsection{Dirac representation}
%Because of Wick's theorem (we will see it in subsection \ref{subsec:Wick}), a fermionic gaussian state is completely characterised by the $2N\times2N$ correlation matrix
%\begin{equation}
%\Gamma_{i,j}\equiv Tr\left[\rho\vec{\alpha}_{i}\vec{\alpha}_{j}^{\dagger}\right]=\left(\begin{array}{cc}
%\Gamma^{UL} & \Gamma^{UR}\\
%\Gamma^{BL} & \Gamma^{BR}
%\end{array}\right).
%\end{equation}
%Where $\Gamma$ is Hermitian, matrices $\Gamma^{BL}$ and $\Gamma^{UR}$ are skew-symmetric, $\Gamma^{BL}=-\overline{\Gamma^{UR}}$ and $\Gamma^{UL}$ and $\Gamma^{BR}$ are Hermitian. \\
%The four quadrants of $\Gamma$ corresponds to the two points correlators of the couples of fermionic creation and annihilation operators:
%\begin{equation}
%\left(\begin{array}{cc}
%\Gamma^{UL} & \Gamma^{UR}\\
%\Gamma^{BL} & \Gamma^{BR}
%\end{array}\right) \leftrightarrow \left(\begin{array}{cc}
%a^{\dagger}a & a^{\dagger}a^{\dagger}\\
%aa & aa^{\dagger}
%\end{array}\right).
%\end{equation}
%
%	\begin{remark}Gaussian states are the states	that maximise	the von Neumann entropy	given the expectation values collected in the correlation matrix \cite{gluza2016}. This can be easily seen remembering the definition of the Gibbs ensemble as the state that maximise the entropy for a given energy.
%	\end{remark}
%%
%
%\subsection{Majorana representation}
%Using the Majorana operators representation we define the Majorana correlation matrix as
%\begin{equation}
%\Gamma_{i,j}^{Maj}=Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=\left(\Omega\Gamma\Omega^{\dagger}\right)_{i,j},
%\end{equation}
%this matrix is imaginary, skew-symmetrix if we subtract the diagonal always equal to $\frac{1}{2}\mathbb{I}$. \\
%The four quadrants of $\Gamma^{Maj}$ corresponds to the two points correlators of the couple of Majorana operators:
%\begin{equation}
% \left(\begin{array}{cc}
%xx & xp\\
%px & pp
%\end{array}\right).
%\end{equation}
%\subsubsection{Covariance matrix}
%The covariance matrix of a fermionic gaussian state is defined in terms of Majorana operators as
%\begin{equation}
%\gamma = \im Tr\left[\rho\left[\vec{r}_{i},\vec{r}_{j}\right]\right],
%\end{equation}
%with $\left[\vec{r}_{i},\vec{r}_{j}\right]$ the commutator of the two Majorana operators.\\
%The covariance matrix completely describe the fermionic gaussian state and has the advantage of being a skew-symmetric matrix, thus a matrix of the same form of the hamiltonian matrix $h$ in \ref{eq:Majorana-QFH}.\\
%The covariance matrix is derived from the Dirac and Majorana correlation matrix as follows:
%\begin{equation}
%\gamma	=-\im \Omega\left(2\Gamma -\mathbb{I}\right)\Omega^\dag=-\im\left(2\Gamma^{maj}-\mathbb{I}\right).
%\end{equation}
%
%
%%If we consider the Dirac representation of the correlation matrix $\tilde{\Gamma}=\Gamma-\frac{1}{2}\mathbb{I}$, moving to the Majorana representation we obtain the skew-symmetric matrix (analogous of $ih$)
%%\begin{equation}
%%i\gamma\equiv\Omega\tilde{\Gamma}\Omega^{\dagger}=\Gamma^{maj}-\frac{1}{2}\mathbb{I}=\frac{1}{2}Tr\left[\rho\left[\vec{r}_{i},\vec{r}_{j}\right]\right]
%%\end{equation}
%%
%%
%%where in the last equality we just used the fact that $ Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=Tr\left[\rho\vec{r}_{j}\vec{r}_{i}\right]$ if $i\neq j$, and $Tr\left[\rho\vec{r}_{i}\vec{r}_{j}\right]=\frac{1}{2}$ if $i=j$ thus taking the anticommutator and dividing by $2$ just removes the constant diagonal.
%%
%%At any time we can change representation with this transformations
%%
%%
%%Someone refers to $\gamma$ as skew-symmetrised correlation matrix, someone else as covariance matrix. I will call it $\gamma$ or skew-symmetrised correlation matrix.
%
%
%
%
%%%%%Diagonalisation of the correlation matrix
%\subsection{Diagonal form of the correlation matrix}
%
%It is possible to find the fermionic transformation $V$ that brings the correlation matrix $\Gamma$ in the diagonal form $\Gamma^{D} = V\da \Gamma V$ where
%\begin{equation}
%\Gamma^D =
%\left(\begin{array}{cccccc}
%\nu_{1} & 0 & \dots &  & \dots & 0\\
%0 & \ddots & \ddots &  &  & \vdots\\
%\vdots & \ddots & \nu_{N}\\
% &  &  & 1-\nu_{1} & \ddots & \vdots\\
%\vdots &  &  & \ddots & \ddots & 0\\
%0 & \dots &  &  & \dots0 & 1-\nu_{N}
%\end{array}\right),
%\end{equation}
%with $\nu_{i}\text{\ensuremath{\in\left[0,1\right]}}$ the occupation of the $i$-esim mode of the diagonal form of the Hamiltonian at the exponent in the density matrix representation of the Gaussian state.\\
%
%\subsubsection{Method for diagonalisation}
%The matrix $\tilde{\Gamma}=2\Gamma-\mathbb{I}$ has the same form of $H$ in \eqref{eq:Dirac-QFH-h}. In order to diagonalise $\Gamma$, we firstly diagonalise $\tilde{\Gamma}$ and then add again $\mathbb{I}$ and divide by $2$ to obtain the diagonal form of $\Gamma^{D}$ with $\nu_{i}\text{\ensuremath{\in\left[0,1\right]}}$.
%
%\begin{proposition}{\code{Diag\_Gamma($\Gamma$)$\rightarrow \Gamma^D, U$}}{}
%This function returns $\Gamma^D$, the the diagonal form \eqref{eq:Gamma-Dirac-Diagonal} of the Dirac correlation matrix $\Gamma$ and $U$ the fermionic transformation such that $\Gamma=U \Gamma^D U\dag $.
%\end{proposition}
%
%By means of theorem \eqref{eq:Schur-Decomposition} we obtain the block diagonal form of the covariance matrix $\gamma$. We call the anti-diagonal elements of each block $\pm \eta_i$ for $i=1,\dots,N$
%\begin{equation}
%\label{eq:Gamma-Majorana-Diagonal}
%\gamma^{D}=\left(\begin{array}{ccccccc}
%0 		& \eta_1 	& 0 		& 0 		& 		& \dots 	& 0 \\
%-\eta_1 	&0   		& 0 		& 0 		&		&  		& \vdots\\
%0 		& 0 		& 0 		& \eta_2 	& 		&		& \\
% 0		& 0 		& -\eta_2 & 0 		&  		& 		&  \\
% 0 		& 0 		& 0 		& 0  		& \ddots 	& 		&   \\
%\vdots 	&  		&  		&  		&		&  0		& \eta_N	 \\
%0 		& \dots 	&  		& 		&  		&-\eta_N 	& 0\\
%\end{array}\right).
%\end{equation}\\
%%
%The different eigenvalues lie in the following intervals
%%
%\begin{itemize}
%\item $\Gamma\rightarrow\Gamma^{D}$ with eigenvalues $\nu_{i}\in\left[0,1\right]$.
%
%\item  $\tilde{\Gamma}\rightarrow\tilde{\Gamma}^{D}$ with eigenvalues $\tilde{\nu}_{i}\in\left[-1,1\right]$, with $\tilde{\nu_i}=2\nu_i-1$.
%
%\item $\gamma\rightarrow\gamma^{D}$ with eigenvalues $\eta_{i}\in\left[-1,1\right]$.
%\end{itemize}
%
%
%
%%%%%Wick's Theorem
%		\subsection{Wick's Theorem}
%		\label{subsec:Wick}
%		A general operator is a linear combination of operators $c(\vec{x})$ defined as
%		\begin{equation}
%			c(\vec{x})=r_{1}^{x_{1}}r_{2}^{x_{2}}\dots r_{2N}^{x_{2N}},
%		\end{equation}
%where $r_{i}$ are the Majorana operators, and $\vec{x}\in\left\{ 0,1\right\} ^{2N}$ \cite{bravyi2004,greplova2013}.
%
%Then for every Gaussian state $\rho$ and even binary string $\vec{x}\in\left\{ 0,1\right\} ^{2N}$ with weight $|x|=2l$ one has
%\begin{equation}
%Tr\left[\rho c(\vec{x})\right]=-i^{l}\mbox{Pf}\left(\left. \gamma\right|_{\vec{x}}\right),
%\end{equation}
%where $\mbox{Pf}()$ is the Pfaffian and $\left. \gamma\right|_{\vec{x}}$ is the restriction of the correlation matrix to all the the elements $\gamma_{i,j}$ such that $x_{i}=x_{j}=1$ (both equal one simultaneously) %(In \cite{greplova2013} the sign is different because different is the sign of $\gamma$).
%
%If the binary string has an odd weight then $Tr\left[\rho c(\vec{x}_{odd})\right]=0$.
%
%%%%%Reduced density matrix
%\subsubsection{Reduced density matrix}
%Trying to define a partial trace over fermionic modes subspaces one soon faces the what is often called the "partial trace ambiguity" \cite{friis2013}.\\
%%
%In the case of fermionic gaussian states, though, this is a much simpler task. Any reduced state formalism has to satisfy the simple criterion that the reduced density operator contains all the information about the subsystem that can be obtained from the global state when measurements are performed only on the respective subsystem alone \cite{friis2013}.\\
%%
%With Wick's theorem in mind it is easy to see that the correlation matrix of the reduced state on the modes ${i_1,\dots,i_m}$ is just the correlation matrix  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$.\\
%To obtain the reduced correlation matrix of the contiguous sites $\{i_1,\dots,i_m\}$ with \code{F-utilities.jl} from $\Gamma$ one should use the function \code{Reduce\_Gamma($\Gamma$,m,i\_1)}.
%
%\begin{proposition}{ \code{Reduce\_Gamma($\Gamma$,m,i\_1)}$\rightarrow  \left.\Gamma \right|_{\{i_1,\dots,i_m\}}$}{}
%This function takes a Dirac correlation matrix $\Gamma$, a dimensione of the partition $m$ and the initial site of the partition $i_1$ and return  $\left.\Gamma \right|_{\{i_1,\dots,i_m\}}$, the reduced correlation matrix on the contiguous modes $\{i_1,\dots,i_m\}$.
%\end{proposition}
%
%
%%%%%Eigenvalues of rho and gamma
%\section{Eigenvalues of $\rho$ and eigenvalues of $\Gamma$}
%Consider the fermionic gaussian state $\rho=\frac{e^{-\frac{1}{2}\vec{\alpha}^{\dagger}M_{\rho}\vec{\alpha}}}{Z}$ and its correlation matrix $\Gamma$. We call $\{\nu_i\}_{i=1,\dots,N}$ the eigenvalues of $\Gamma$ and $\{\epsilon_i\}_{i=1,\dots,N}$ the eigenvalues of $H_{\alpha}$.
%Then we have
%\begin{equation}
%\nu_{i}=\frac{1}{1+e^{\epsilon_{i}}},
%\end{equation}
%
%\begin{equation}
%\epsilon_{i}=ln\left(\frac{1-\nu_{i}}{\nu_{i}}\right),
%\end{equation}
%
%\begin{equation}
%\epsilon_{i}=ln\left(\frac{\frac{1}{2}-\eta_{i}}{\frac{1}{2}+\eta_{i}}\right),
%\end{equation}
%
%\begin{equation}
%\eta_{i}=\frac{1}{2}\tanh\left(\frac{\epsilon_{i}}{2}\right).
%\end{equation}
%For details and a more detailed treatment of the topic see most relevant reference \cite{peschel2003} or see the appendix \ref{appendix:Eigenvalues-Relations}.\\
%%
%The correlation matrix $\Gamma^{D}$ tells us that a basis exists in which the density matrix $\rho$ of the state can be written as the tensor product of $N$ density matrices, one for each site. If $\nu_{i\in\left[1,N\right]}$ are the positive eigenvalues of $\Gamma$ then there exists a basis such that:
%\begin{equation}
%\label{eq:Rho_Gaussian_State}
%\rho=\bigotimes_{i=1}^{N}\left(\begin{array}{cc}
%\nu_{i} & 0\\
%0 & 1-\nu_{i}
%\end{array}\right)
%\end{equation}
%%
%Thus the if we denote each of the $2^{N}$ eigenvalues $\pi_{\vec{x}}$ of $\rho$ with a binary string $\vec{x}\in\left\{ 0,1\right\} ^{N}$ we have that: $\pi_{\vec{x}}=\prod_{i=1}^{N}\left(\vec{x}_{i}\nu_{i}+(1-\vec{x}_{i})(1-\nu_{i})\right)$.\\
%%
%\begin{proposition}{\code{Eigenvalues\_of\_rho($\Gamma$)}$\rightarrow\vec{\nu}$}{}
%This function return $N$ eigenvalues of the correlation matrix $\rho$ associated to the fermionic gaussian state with Dirac correlation matrix $\Gamma$. The first eigenvalue is always the biggest,  then he tries return the others $N-1$ smallest eigenvalues, but it is not guaranteed.
%\end{proposition}
%
%%%%%Information measures
%\section{Information measures}
%%%%%Von Neumann Entropies
%\subsection{Von Neumann Entropies}
%The Von Neumann entropy of a quantum state described by the density matrix $\rho$ is
%\begin{equation}
%\label{eq:General_VonNeumann_Entropy}
%S(\rho) = -\Tr{\rho\ln(\rho)}.
%\end{equation}
%In terms of the eigenvalues $\lambda$ of $\rho$, the Von Neumann entropy read as
%\begin{equation}
%S(\rho) = -\sum_{\lambda} \lambda \ln(\lambda)
%\end{equation}
%If $\rho$ is a Fermionic Gaussian state of a system with $N$ sites , substituting in \eqref{eq:General_VonNeumann_Entropy} the product form \eqref{eq:Rho_Gaussian_State}, the Von Neumann entropy becomes a function of the eigenvalues $\nu_i$ of the correlation matrix $\Gamma$ and it is the sum of just $2N$ terms
%\begin{equation}
%S(\Gamma) \equiv S(\rho) = -\sum_{i=1}^{N} \left(\nu_i \ln(\nu_i)+(1-\nu_i) \ln(1-\nu_i) \right).
%\end{equation}
%
%In \code{F-utilities.jl} this is implemented with the function \code{VN\_Entropy($\Gamma$)}.
%
%\begin{proposition}{\code{VN\_Entropy($\Gamma$)}$\rightarrow S$}{}
%This function return $S$, the \code{Float64} value of the Von Neumann Entropy of the state described by the Dirac correlation matrix $\Gamma$.
%\end{proposition}
%
%%%%%Purity
%\subsection{Purity}
%The purity of a state $\rho$ is defined as
%\begin{equation}
%\mbox{Purity}\equiv Tr\left[\rho^{2}\right].
%\end{equation}
%We have that:
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}\frac{1}{\sech(\epsilon_{i})+1},
%\end{equation}
%
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}(2\left(\nu_{i}-1\right)\nu_{i}+1),
%\end{equation}
%
%\begin{equation}
%\mbox{Purity}=\prod_{i=1}^{N-1}\left(2\eta_{i}^{2}+\frac{1}{2}\right).
%\end{equation}
%
%For more details see appendix \ref{appendix:Purity}.
%
%In \code{F-utilities.jl} this is implemented with the function \code{Purity($\Gamma$)}.
%
%\begin{proposition}{\code{Purity($\Gamma$)$\rightarrow  p$}}{}
%This function return $p$ the purity of the fermionic gaussian state with Dirac correlation matrix $\Gamma$.
%\end{proposition}
%
%%%%%Entanglement Contour
%\subsection{Entanglement Contour}
%In 2014 Chen andVidal \cite{chen2014} introduced entanglement contour "a tool to identify which real-space degrees of freedom contribute, and how much, to the entanglement of a region A with the rest of the system B".\\
%We restrict to pure states.\\
%Consider an Hilbert space $\mathcal{H}$ arbitrarily divided in two partitions $\mathcal{H}= \mathcal{H}_A\otimes \mathcal{H}_B$. The Schmidt decomposition of a pure state $|\psi^{A,B}\rangle$ in $\mathcal{H}$ is
%\begin{equation}
%\label{eq:Schmidt-Decomposition}
%|\psi^{A,B}\rangle = \sum_{i} \sqrt{p_i}|\psi^{A}_i\rangle \otimes |\psi^B_i\rangle,
%\end{equation}
%with $p_i\geq0$, $\sum_{i} p_i = 1$ and
%\begin{equation}
%\rho^{A}\equiv Tr_{B}\left[ |\psi^{A,B}\rangle \langle \psi^{A,B}|\right] = \sum_{i} p_i |\psi^{A}_i \rangle \langle \psi^{A}_i|.
%\end{equation}
%Factorising Hilbert space $\mathcal{H}_A$ in its tensor product structure $\mathcal{H}_A=\bigotimes_{j\in A}\mathcal{H}_j$, we can individuate in each local Hilbert space $\mathcal{H}_j$ a site of partition $A$.
%Genarelly $\rho^A$ cannot be expressed as a product state over this factorisation of $\mathcal{H}_A$.\\
%Chen and Vidal entanglement contour $c_A$ is a function of the sites $j$ of partition $A$ ($c_A:A\rightarrow \mathbb{R}$) that attempts to express the contribution of each site to the total von Neumann entropy $S(\rho^A)$ of partition $A$.\\
%The definition of entanglement contour is based on five constraints (see \cite{chen2014} for the complete definition) that any possible entanglement contour function must satisfy. These constraints are not tight, thus there exist many possible functions that can be regarded as entanglement contour.\\
%We consider an entanglement contour specifically defined for Fermionic Gaussian states (for other entanglement contours see i.e. \cite{coser2017,tonni2018} ).\\
%
%
%
%
%
%\chapter{Hopping Hamiltonian}
%
%\chapter{Transverse Field Ising Hamiltonian}
%
